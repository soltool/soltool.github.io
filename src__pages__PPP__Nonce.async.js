"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[666],{62741:function(e,t,n){n.d(t,{l:function(){return S}});var r=n(15009),a=n.n(r),s=n(64599),c=n.n(s),o=n(99289),u=n.n(o),i=n(5574),l=n.n(i),d=n(64119),m=n(13451),p=n(5966),f=n(44718),h=n(54306),k=n(29363),b=n(88026),g=n(2453),x=n(67294),y=n(49717),P=n(71874),v=n(85893),A=x.forwardRef((function(e,t){var n=e.notificationApi,r=e.handleUpdateNonceAccount,s=g.ZP.useMessage(),o=l()(s,2),i=o[0],A=o[1],S=(0,f.R)().connection,C=(0,h.O)(),N=C.publicKey,I=C.signAllTransactions,M=C.wallet,w=(0,y.A)(),T=w.chain,j=w.modalFeeRef,R=(0,b.useIntl)(),B=R.formatMessage({id:"common.intlInputException"}),H=R.formatMessage({id:"common.intlPleaseConnectWallet"}),V=R.formatMessage({id:"common.intlCreateAccount"}),O=R.formatMessage({id:"common.intlQuantity"}),Z=(0,x.useRef)(),W=(0,x.useState)(!1),z=l()(W,2),E=z[0],F=z[1],U=(0,x.useCallback)((function(){F(!0)}),[]);(0,x.useImperativeHandle)(t,(function(){return{handleOpen:U}}));var K=(0,x.useCallback)(function(){var e=u()(a()().mark((function e(t){var s,o,u,l,m,p,f,h,b,g,x,y,v,A,C,w,R,B,V,O,Z,W,z,E,U,K,D,L;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N&&I&&M){e.next=3;break}return i.error(H),e.abrupt("return",!0);case 3:return s=N,e.prev=4,o=Number(t.count),e.next=8,S.getMinimumBalanceForRentExemption(k.NONCE_ACCOUNT_LENGTH);case 8:return u=e.sent,l="#####NonceCountAccount#####",e.next=12,k.PublicKey.createWithSeed(s,l,k.SystemProgram.programId);case 12:return m=e.sent,e.next=15,S.getAccountInfo(m);case 15:p=e.sent,f=[],h=[],g=(b=1)+o,p?(b=(0,P.sT)(p.lamports)+1,g=b+o):(g=(b=1)+o,0,890880,(x=[]).push(k.SystemProgram.createAccountWithSeed({fromPubkey:s,newAccountPubkey:m,basePubkey:s,seed:l,lamports:890880,space:0,programId:k.SystemProgram.programId})),h.push(x)),y=0,v=4,A=b;case 24:if(!(A<g)){e.next=36;break}return C="#####NonceAccount".concat(A,"#####"),e.next=28,k.PublicKey.createWithSeed(s,C,k.SystemProgram.programId);case 28:w=e.sent,f.push(k.SystemProgram.createAccountWithSeed({fromPubkey:s,newAccountPubkey:w,basePubkey:s,seed:C,lamports:u,space:k.NONCE_ACCOUNT_LENGTH,programId:k.SystemProgram.programId})),f.push(k.SystemProgram.nonceInitialize({noncePubkey:w,authorizedPubkey:s})),(y+=1)%v!=0&&y+b!==g||(B=0===(R=y%v)?v:R,f.push(k.SystemProgram.transfer({fromPubkey:s,toPubkey:m,lamports:B})),h.push(f),f=[]);case 33:++A,e.next=24;break;case 36:if(!h.length){e.next=72;break}return e.next=39,S.getLatestBlockhash();case 39:return V=e.sent,O=V.blockhash,Z=V.lastValidBlockHeight,e.next=44,(0,P.Gw)(S,M,O,h,I,j);case 44:W=e.sent,z=W.transactions,E=W.feeMode,U=c()(z),e.prev=48,U.s();case 50:if((K=U.n()).done){e.next=62;break}return D=K.value,e.next=54,(0,P.pR)(S,M,D,E);case 54:return L=e.sent,e.next=57,(0,P.fS)(T,S,{signature:L,blockhash:O,lastValidBlockHeight:Z},"confirmed",n,i);case 57:if(e.sent){e.next=60;break}return e.abrupt("break",62);case 60:e.next=50;break;case 62:e.next=67;break;case 64:e.prev=64,e.t0=e.catch(48),U.e(e.t0);case 67:return e.prev=67,U.f(),e.finish(67);case 70:r(s,S),F(!1);case 72:return e.abrupt("return",!0);case 75:return e.prev=75,e.t1=e.catch(4),r(s,S),(0,d.Tv)(e.t1,i,"handleFinish"),e.abrupt("return",!0);case 80:case"end":return e.stop()}}),e,null,[[4,75],[48,64,67,70]])})));return function(t){return e.apply(this,arguments)}}(),[N,S,T,n,M,j]);return(0,v.jsxs)(m.Y,{formRef:Z,title:V,open:E,onFinish:K,onOpenChange:function(e){F(e)},layout:"vertical",width:"400px",initialValues:{count:1},submitter:{render:function(e,t){return[t[0],t[1]]}},children:[(0,v.jsx)(p.Z,{name:"count",label:O,placeholder:"",fieldProps:{size:"large",autoFocus:!1},rules:[{required:!0,whitespace:!0,message:"".concat(B),pattern:/^[1-9]\d*$/}]}),A]})})),S=(0,x.memo)(A)},12038:function(e,t,n){n.r(t);var r=n(64599),a=n.n(r),s=n(15009),c=n.n(s),o=n(99289),u=n.n(o),i=n(5574),l=n.n(i),d=(n(8849),n(39380)),m=n(64435),p=n(88026),f=n(67294),h=n(94036),k=n(2453),b=n(16568),g=n(78957),x=n(83622),y=n(54306),P=n(44718),v=n(29363),A=n(39678),S=n(62741),C=n(64119),N=n(9437),I=n(71874),M=n(85893);t.default=function(){var e=(0,p.useDispatch)(),t=(0,f.useState)(!1),n=l()(t,2),r=n[0],s=n[1],o=k.ZP.useMessage(),i=l()(o,2),w=i[0],T=i[1],j=b.ZP.useNotification(),R=l()(j,2),B=R[0],H=R[1],V=(0,p.useSelector)((function(e){return e.nonce.dataSource})),O=(0,p.useSelector)((function(e){return e.nonce.totalCountCreate})),Z=(0,p.useSelector)((function(e){return e.nonce.totalCountRecord})),W=(0,p.useSelector)((function(e){return e.nonce.nonceCountAccount})),z=(0,N.Ab)(),E=z.chain,F=z.modalFeeRef,U=(0,f.useState)([]),K=l()(U,2),D=K[0],L=K[1],G=(0,y.O)(),_=G.publicKey,J=G.signTransaction,q=G.signAllTransactions,Q=G.wallet,Y=(0,P.R)().connection,$=(0,f.useRef)(),X=(0,p.useIntl)(),ee=X.formatMessage({id:"common.intlPleaseConnectWallet"}),te=X.formatMessage({id:"common.intlAuthorityAddress"}),ne=X.formatMessage({id:"common.intlNonceAddress"}),re=X.formatMessage({id:"common.intlBlockHash"}),ae=X.formatMessage({id:"common.intlDelFromBackToFront"}),se=X.formatMessage({id:"common.intlCreateAccount"}),ce=X.formatMessage({id:"common.intlBatchDelete"}),oe=X.formatMessage({id:"common.intlUpdateNonce"}),ue=X.formatMessage({id:"common.intlStatus"}),ie=X.formatMessage({id:"common.intlVerifyNonce"}),le=X.formatMessage({id:"common.intlVerifyComplete"}),de=X.formatMessage({id:"common.intlPleaseVerify"}),me=(0,f.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",render:function(e,t,n){return(0,M.jsx)("span",{children:n+1})}},{title:"".concat(ne),dataIndex:"nonceAccount",key:"nonceAccount",render:function(e,t){return(0,M.jsx)(A.k,{ellipsis:!0,copyable:!0,addressPrefix:"",address:t.nonceAccount.toString()})}},{title:"".concat(te),dataIndex:"authority",key:"authority",render:function(e,t){return(0,M.jsx)(A.k,{ellipsis:!0,copyable:!0,addressPrefix:"",address:t.authority.toString()})}},{title:"".concat(ue),dataIndex:"status",key:"status",render:function(e,t){return(0,M.jsx)("span",{children:t.status})}},{title:"".concat(re),dataIndex:"blockhash",key:"blockhash",render:function(e,t){return(0,M.jsx)(A.k,{copyable:!0,addressPrefix:"",address:t.blockhash})}}]}),[]),pe=(0,f.useCallback)(function(){var t=u()(c()().mark((function t(n,r){var a,o,u,i,l;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s(!0),"#####NonceCountAccount#####",t.next=5,v.PublicKey.createWithSeed(n,"#####NonceCountAccount#####",v.SystemProgram.programId);case 5:return a=t.sent,t.next=8,r.getAccountInfo(a);case 8:if(o=t.sent,u=[],i=0,l=0,!o){t.next=19;break}return i=(0,I.sT)(o.lamports),t.next=16,(0,I.JH)(n,r);case 16:u=t.sent,(l=u.length)!==i&&w.error(de);case 19:s(!1),e(h.N.setDataSource(u)),e(h.N.setTotalCountRecord(i)),e(h.N.setTotalCountCreate(l)),e(h.N.setNonceCountAccount(a)),t.next=30;break;case 26:t.prev=26,t.t0=t.catch(0),s(!1),(0,C.Tv)(t.t0,w,"handleUpdateNonceAccount");case 30:case"end":return t.stop()}}),t,null,[[0,26]])})));return function(e,n){return t.apply(this,arguments)}}(),[]),fe=(0,f.useCallback)(u()(c()().mark((function e(){var t,n,r,o,u,i,l,d,m,p,f,h,k,b,g,x,y,P,A,S,N,M,T,j,R,H,O,Z,z,U;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_&&q&&Q){e.next=3;break}return w.error(ee),e.abrupt("return",!1);case 3:if(D.length){e.next=5;break}return e.abrupt("return");case 5:return t=_,e.prev=6,n=D.toSorted((function(e,t){return Number(t)-Number(e)})),r=V.toReversed(),o=[],u="#####NonceCountAccount#####",e.next=13,Y.getAccountInfo(W);case 13:if(!(i=e.sent)){e.next=20;break}if(l=(0,I.sT)(i.lamports),V.length===l){e.next=20;break}return w.error(de),e.abrupt("return");case 20:d=0;case 21:if(!(d<n.length)){e.next=28;break}if(n[d]===r[d].key){e.next=24;break}return e.abrupt("return",w.error("".concat(ae)));case 24:o.push(r[d].nonceAccount);case 25:++d,e.next=21;break;case 28:m=100,p=0,f=[],h=[];case 32:return k=o.splice(0,m),e.next=35,Y.getMultipleParsedAccounts(k);case 35:for(b=e.sent,g=0;g<b.value.length;++g)x=b.value[g].lamports,y=p*m+g,f.push(v.SystemProgram.nonceWithdraw({noncePubkey:r[y].nonceAccount,authorizedPubkey:r[y].authority,toPubkey:r[y].authority,lamports:x}));p+=1;case 38:if(o.length){e.next=32;break}case 39:for(r.length===n.length?(P=i.lamports,f.push(v.SystemProgram.transfer({fromPubkey:W,basePubkey:t,toPubkey:t,lamports:P,seed:u,programId:v.SystemProgram.programId}))):f.push(v.SystemProgram.transfer({fromPubkey:W,basePubkey:t,toPubkey:t,lamports:n.length,seed:u,programId:v.SystemProgram.programId})),14,A=Math.ceil(f.length/14),S=0;S<A;++S)h.push(f.splice(0,14));if(!h.length){e.next=79;break}return e.next=46,Y.getLatestBlockhash();case 46:return N=e.sent,M=N.blockhash,T=N.lastValidBlockHeight,e.next=51,(0,I.Gw)(Y,Q,M,h,q,F);case 51:j=e.sent,R=j.transactions,H=j.feeMode,O=a()(R),e.prev=55,O.s();case 57:if((Z=O.n()).done){e.next=69;break}return z=Z.value,e.next=61,(0,I.pR)(Y,Q,z,H);case 61:return U=e.sent,e.next=64,(0,I.fS)(E,Y,{signature:U,blockhash:M,lastValidBlockHeight:T},"confirmed",B,w);case 64:if(e.sent){e.next=67;break}return e.abrupt("break",69);case 67:e.next=57;break;case 69:e.next=74;break;case 71:e.prev=71,e.t0=e.catch(55),O.e(e.t0);case 74:return e.prev=74,O.f(),e.finish(74);case 77:return e.next=79,pe(t,Y);case 79:e.next=87;break;case 81:return e.prev=81,e.t1=e.catch(6),s(!1),e.next=86,pe(t,Y);case 86:(0,C.Tv)(e.t1,w,"handleBatchDelete");case 87:case"end":return e.stop()}}),e,null,[[6,81],[55,71,74,77]])}))),[D,_,q,V,W,Y,E,Q,F]),he=(0,f.useCallback)(u()(c()().mark((function e(){var t,n,r,a,s,o,u,i,l,d,m;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_&&q&&Q){e.next=3;break}return w.error(ee),e.abrupt("return",!1);case 3:if(D.length){e.next=5;break}return e.abrupt("return");case 5:for(t=_,e.prev=6,20,n=[],r=[],D.forEach((function(e){var t=V[e].nonceAccount,r=V[e].authority;n.push(v.SystemProgram.nonceAdvance({noncePubkey:t,authorizedPubkey:r}))})),a=Math.ceil(n.length/20),s=0;s<a;++s)r.push(n.splice(0,20));if(!r.length){e.next=26;break}return e.next=16,Y.getLatestBlockhash();case 16:return o=e.sent,u=o.blockhash,i=o.lastValidBlockHeight,e.next=21,(0,I.Gw)(Y,Q,u,r,q,F);case 21:return l=e.sent,d=l.transactions,m=l.feeMode,e.next=26,(0,I.fv)({chain:E,connection:Y,wallet:Q,transactions:d,blockhash:u,lastValidBlockHeight:i,notificationApi:B,feeMode:m});case 26:return e.next=28,pe(t,Y);case 28:e.next=35;break;case 30:return e.prev=30,e.t0=e.catch(6),e.next=34,pe(t,Y);case 34:(0,C.Tv)(e.t0,w,"handleUpdateNonce");case 35:case"end":return e.stop()}}),e,null,[[6,30]])}))),[D,_,q,V,Y,E,Q]),ke=(0,f.useCallback)(u()(c()().mark((function e(){var t,n,r,a,o,u,i,l,d,m,p,f,h,k,b,g,x;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_&&J&&Q){e.next=3;break}return w.error(ee),e.abrupt("return",!1);case 3:return t=_,e.prev=4,s(!0),n="#####NonceCountAccount#####",e.next=9,v.PublicKey.createWithSeed(t,n,v.SystemProgram.programId);case 9:return r=e.sent,e.next=12,Y.getAccountInfo(r);case 12:if(a=e.sent,o=[],!a){e.next=41;break}return e.next=17,(0,I.JH)(t,Y);case 17:if(u=e.sent,i=(0,I.sT)(a.lamports),l=u.length,i!==l){e.next=24;break}w.success(le),e.next=41;break;case 24:return i>l?(d=i-l,o.push(v.SystemProgram.transfer({fromPubkey:r,basePubkey:t,toPubkey:t,lamports:d,seed:n,programId:v.SystemProgram.programId}))):(m=l-i,o.push(v.SystemProgram.transfer({fromPubkey:t,toPubkey:r,lamports:m}))),e.next=27,Y.getLatestBlockhash();case 27:return p=e.sent,f=p.blockhash,h=p.lastValidBlockHeight,e.next=32,(0,I.fC)(Y,Q,f,o,J,F);case 32:return k=e.sent,b=k.transaction,g=k.feeMode,e.next=37,(0,I.pR)(Y,Q,b,g);case 37:return x=e.sent,e.next=40,(0,I.fS)(E,Y,{signature:x,blockhash:f,lastValidBlockHeight:h},"confirmed",B,w);case 40:pe(t,Y);case 41:s(!1),e.next=49;break;case 44:e.prev=44,e.t0=e.catch(4),s(!1),pe(t,Y),(0,C.Tv)(e.t0,w,"handleUpdateNonceAccount");case 49:case"end":return e.stop()}}),e,null,[[4,44]])}))),[_,J,V,Y,E,Q]);return(0,f.useEffect)((function(){_&&Y&&pe(_,Y)}),[_,Y]),(0,M.jsxs)(d._z,{className:"pages-tools-nonce",ghost:!0,children:[(0,M.jsx)(m.Z,{scroll:{x:!0},size:"small",columns:me,dataSource:V,defaultData:[],loading:{spinning:r,size:"large"},search:!1,options:!1,pagination:!1,tableAlertRender:!1,tableAlertOptionRender:!1,headerTitle:(0,M.jsxs)("div",{children:[(0,M.jsxs)(g.Z,{wrap:!0,className:"mb-[16px]",children:[(0,M.jsx)(x.ZP,{type:"primary",onClick:function(){return $.current.handleOpen()},children:se}),(0,M.jsx)(x.ZP,{type:"primary",onClick:function(){return fe()},children:ce}),(0,M.jsx)(x.ZP,{type:"primary",onClick:function(){return he()},children:oe}),(0,M.jsx)(x.ZP,{type:"primary",onClick:function(){return ke()},children:ie}),(0,M.jsx)("div",{children:O})]}),(0,M.jsxs)("div",{children:[(0,M.jsx)(A.k,{copyable:!0,addressPrefix:"",address:W.toString()}),"：",Z]})]}),rowSelection:{type:"checkbox",selectedRowKeys:D,onChange:function(e){L(e)}}}),(0,M.jsx)(S.l,{ref:$,notificationApi:B,handleUpdateNonceAccount:pe}),T,H]})}},8849:function(){}}]);