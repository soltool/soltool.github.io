"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9],{94149:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(87462),a=n(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},s=n(84089),o=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:c}))};var l=a.forwardRef(o)},3355:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(87462),a=n(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v68c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-68c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zm-40 376H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"unlock",theme:"outlined"},s=n(84089),o=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:c}))};var l=a.forwardRef(o)},89060:function(e,t,n){n.r(t);var r=n(97857),a=n.n(r),c=n(64599),s=n.n(c),o=n(15009),l=n.n(o),i=n(99289),u=n.n(i),d=n(5574),p=n.n(d),f=n(29599),m=n(64119),h=n(39380),x=n(38345),k=n(64435),b=n(2453),g=n(16568),v=n(25593),y=n(83622),w=n(2058),C=n(34041),M=n(67294),j=n(38592),A=n(51941),P=n(88026),S=(n(8849),n(54306)),N=n(44718),Z=n(70794),T=n(87713),O=n(70609),R=n(39578),K=n(27484),W=n.n(K),B=n(3355),V=n(94149),D=n(85893);t.default=function(){var e=(0,P.useDispatch)(),t=b.ZP.useMessage(),n=p()(t,2),r=n[0],c=n[1],o=g.ZP.useNotification(),i=p()(o,2),d=i[0],K=i[1],L=(0,P.useSelector)((function(e){return e.wallet.dataSource})),U=(0,P.useSelector)((function(e){return e.wallet.wallet})),H=(0,P.useSelector)((function(e){return e.wallet.walletOptions})),I=(0,f.Ab)().chain,z=(0,P.useSelector)((function(e){return e.wallet.locks})),E=(0,P.useSelector)((function(e){return e.wallet.site})),F=(0,S.O)(),_=F.publicKey,Y=F.signTransaction,q=(0,N.R)().connection,J=(0,M.useState)(!1),$=p()(J,2),G=$[0],Q=$[1],X=(0,M.useState)([]),ee=p()(X,2),te=ee[0],ne=ee[1],re=(0,M.useRef)(),ae=(0,M.useRef)(),ce=(0,M.useRef)(),se=(0,M.useRef)(),oe=(0,M.useRef)(),le=(0,M.useRef)(),ie=(0,M.useRef)(),ue=(0,M.useRef)(),de=(0,P.useIntl)(),pe=de.formatMessage({id:"common.intlWalletAttention"}),fe=de.formatMessage({id:"common.intlPleaseConnectWallet"}),me=de.formatMessage({id:"common.intlTxSuccess"}),he=de.formatMessage({id:"common.intlDelFromBackToFront"}),xe=de.formatMessage({id:"common.intlBackupSuccess"}),ke=de.formatMessage({id:"common.intlRestoreSuccess"}),be=de.formatMessage({id:"common.intlRestoreFail"}),ge=de.formatMessage({id:"common.intlSelectWallet"}),ve=de.formatMessage({id:"common.intlDeleteAccountThenAddress"}),ye=de.formatMessage({id:"common.intlSelectAddress"}),we=de.formatMessage({id:"common.intlDeleteNonceFirst"}),Ce=de.formatMessage({id:"common.intlNoDeleteAccount"}),Me=de.formatMessage({id:"common.intlNoCreateAccount"}),je=de.formatMessage({id:"common.intlAddress"}),Ae=de.formatMessage({id:"common.intlBalance"}),Pe=de.formatMessage({id:"common.intlStatus"}),Se=de.formatMessage({id:"common.intlCreated"}),Ne=de.formatMessage({id:"common.intlNotCreated"}),Ze=de.formatMessage({id:"common.intlAccount"}),Te=de.formatMessage({id:"common.intlNotes"}),Oe=de.formatMessage({id:"common.intlCreateWallet"}),Re=de.formatMessage({id:"common.intlImportWallet"}),Ke=de.formatMessage({id:"common.intlCreateAddress"}),We=de.formatMessage({id:"common.intlDeleteAddress"}),Be=de.formatMessage({id:"common.intlCreateAccount"}),Ve=de.formatMessage({id:"common.intlDeleteAccount"}),De=de.formatMessage({id:"common.intlWalletRename"}),Le=de.formatMessage({id:"common.intlBackupWallet"}),Ue=de.formatMessage({id:"common.intlRestoreWallet"}),He=de.formatMessage({id:"common.intlTransferSOL"}),Ie=de.formatMessage({id:"common.intlWallet"}),ze=de.formatMessage({id:"common.intlDeleteAddressFirst"}),Ee=de.formatMessage({id:"common.intlDeleteWallet"}),Fe=de.formatMessage({id:"common.intlShowMnemonic"}),_e=de.formatMessage({id:"common.intlShowPrivateKey"}),Ye=de.formatMessage({id:"common.intlOperation"}),qe=(0,M.useCallback)((function(){U?z[U]?se.current.handleOpen():le.current.handleOpen(U):r.error(ge)}),[U,z]),Je=(0,M.useCallback)((function(){U?z[U]?ie.current.handleOpen():le.current.handleOpen(U):r.error(ge)}),[U,z]),$e=(0,M.useCallback)((function(e){z[U]?ue.current.handleOpen(e):le.current.handleOpen(U)}),[U,z]),Ge=(0,M.useCallback)((function(){U?oe.current.handleOpen():r.error(ge)}),[U]),Qe=(0,M.useCallback)(function(){var t=u()(l()().mark((function t(n){var a,c,s,o,i,u,d,p,f;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=[],c=[],!n){t.next=17;break}return Q(!0),t.next=7,A.db.accounts.where("wallet").equals(n).sortBy("index");case 7:return c=t.sent,s=c.map((function(e){return new T.PublicKey(e.publicKey)})),o=c.map((function(e){return new T.PublicKey(e.nonce)})),t.next=12,q.getMultipleAccountsInfo(s);case 12:return i=t.sent,t.next=15,q.getMultipleAccountsInfo(o);case 15:for(u=t.sent,d=0;d<c.length;++d)p=i[d],f=u[d],a.push({key:d,wallet:n,hash:c[d].hash,publicKey:c[d].publicKey,secretKey:c[d].secretKey,notes:c[d].notes,nonce:c[d].nonce,created:!!p,nonceCreated:!!f,lamports:(0,Z.Z)(p?p.lamports:0)});case 17:e(j.Nw.setAccounts(c)),e(j.Nw.setDataSource(a)),Q(!1),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(0),Q(!1),(0,m.Tv)(t.t0,r,"handleUpdateAccounts");case 26:case"end":return t.stop()}}),t,null,[[0,22]])})));return function(e){return t.apply(this,arguments)}}(),[]),Xe=(0,M.useCallback)(u()(l()().mark((function e(){var t,n,a,c,s;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U){e.next=3;break}return r.error(ge),e.abrupt("return");case 3:if(te.length){e.next=5;break}return e.abrupt("return",r.error(ye));case 5:e.prev=5,t=te.toSorted().toReversed(),n=L.toReversed(),a=[],c=n.length-t.length,s=0;case 11:if(!(s<t.length)){e.next=20;break}if(t[s]===n[s].key){e.next=14;break}return e.abrupt("return",r.error("".concat(he)));case 14:if(!n[s].created){e.next=16;break}return e.abrupt("return",r.error(ve));case 16:a.push(n[s].hash);case 17:++s,e.next=11;break;case 20:return e.next=22,A.db.accounts.bulkDelete(a);case 22:return e.next=24,A.db.wallets.update(U,{count:c});case 24:Qe(U),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(5),(0,m.Tv)(e.t0,r,"handleDeleteAddress");case 30:case"end":return e.stop()}}),e,null,[[5,27]])}))),[U,te,L]),et=(0,M.useCallback)(u()(l()().mark((function e(){var t,n,a,c,o,i,u,p,f,h,x,k,b,g,v,y,w,C,M,j,A,P;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_&&Y){e.next=2;break}return e.abrupt("return",r.error(fe));case 2:if(te.length){e.next=4;break}return e.abrupt("return",r.error(ye));case 4:if(z[U]){e.next=7;break}return le.current.handleOpen(U),e.abrupt("return");case 7:e.prev=7,t=_,n=[],a=[],c=(0,m.ow)(z[U],E),o=s()(te),e.prev=13,o.s();case 15:if((i=o.n()).done){e.next=31;break}if(u=i.value,p=L[u].publicKey,f=L[u].created,h=L[u].nonceCreated,x=BigInt(L[u].lamports.toString()),k=(0,m.ow)(L[u].secretKey,c),b=R.Z.decode(k),g=T.Keypair.fromSecretKey(b),!f){e.next=29;break}if(!h){e.next=27;break}return e.abrupt("return",r.error(we));case 27:n.push(T.SystemProgram.transfer({fromPubkey:new T.PublicKey(p),toPubkey:t,lamports:x})),a.push(g);case 29:e.next=15;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(13),o.e(e.t0);case 36:return e.prev=36,o.f(),e.finish(36);case 39:if(n.length){e.next=41;break}return e.abrupt("return",r.info(Ce));case 41:return e.next=43,q.getLatestBlockhash();case 43:return v=e.sent,y=v.blockhash,w=v.lastValidBlockHeight,C=new T.TransactionMessage({payerKey:t,recentBlockhash:y,instructions:n}).compileToLegacyMessage(),M=new T.VersionedTransaction(C),e.next=50,Y(M);case 50:return(j=e.sent).sign(a),e.next=54,q.sendTransaction(j);case 54:return A=e.sent,e.next=57,q.confirmTransaction({signature:A,blockhash:y,lastValidBlockHeight:w},"confirmed");case 57:(P=e.sent).value.err?(console.log(P.value.err),r.error("".concat(P.value.err))):(d.success({message:me,description:(0,D.jsx)(O.VU,{type:"tx",content:A,chain:I}),placement:"top",showProgress:!0}),Qe(U)),e.next=64;break;case 61:e.prev=61,e.t1=e.catch(7),(0,m.Tv)(e.t1,r,"handleCreateAccount");case 64:case"end":return e.stop()}}),e,null,[[7,61],[13,33,36,39]])}))),[te,_,Y,L,q,I,U,z,E]),tt=(0,M.useCallback)(u()(l()().mark((function e(){var t,n,a,c,s,o,i,u,p,f;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_&&Y){e.next=2;break}return e.abrupt("return",r.error(fe));case 2:if(te.length){e.next=4;break}return e.abrupt("return",r.error(ye));case 4:if(e.prev=4,t=_,n=[],te.forEach((function(e){var r=L[e].publicKey;L[e].created||n.push(T.SystemProgram.transfer({fromPubkey:t,toPubkey:new T.PublicKey(r),lamports:890880}))})),n.length){e.next=10;break}return e.abrupt("return",r.info(Me));case 10:return e.next=12,q.getLatestBlockhash();case 12:return a=e.sent,c=a.blockhash,s=a.lastValidBlockHeight,o=new T.TransactionMessage({payerKey:t,recentBlockhash:c,instructions:n}).compileToLegacyMessage(),i=new T.VersionedTransaction(o),e.next=19,Y(i);case 19:return u=e.sent,e.next=22,q.sendTransaction(u);case 22:return p=e.sent,e.next=25,q.confirmTransaction({signature:p,blockhash:c,lastValidBlockHeight:s},"confirmed");case 25:(f=e.sent).value.err?(console.log(f.value.err),r.error("".concat(f.value.err))):(d.success({message:me,description:(0,D.jsx)(O.VU,{type:"tx",content:p,chain:I}),placement:"top",showProgress:!0}),Qe(U)),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(4),(0,m.Tv)(e.t0,r,"handleCreateAccount");case 32:case"end":return e.stop()}}),e,null,[[4,29]])}))),[te,_,Y,L,q,I,U]),nt=(0,M.useCallback)(function(){var t=u()(l()().mark((function t(n){var a,c,o,i,u;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=[],t.next=4,A.db.wallets.where("chain").equals(n.network).toArray();case 4:c=t.sent,o=s()(c);try{for(o.s();!(i=o.n()).done;)u=i.value,a.push({label:u.name,value:u.hash})}catch(e){o.e(e)}finally{o.f()}a.sort((function(e,t){return e.label.localeCompare(t.label)})),e(j.Nw.setWallets(c)),e(j.Nw.setWalletOptions(a)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),(0,m.Tv)(t.t0,r,"handleUpdateWallets");case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}(),[]),rt=(0,M.useCallback)(u()(l()().mark((function t(){var n,c;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(U){t.next=2;break}return t.abrupt("return",r.error(ge));case 2:return t.prev=2,t.next=5,A.db.wallets.get(U);case 5:if(!(n=t.sent)||!n.count){t.next=8;break}return t.abrupt("return",r.error(ze));case 8:return t.next=10,A.db.wallets.delete(U);case 10:delete(c=a()({},z))[U],e(j.Nw.setLocks(c)),e(j.Nw.setWallet("")),nt(I),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),(0,m.Tv)(t.t0,r,"handleDeleteWallet");case 20:case"end":return t.stop()}}),t,null,[[2,17]])}))),[U,I,z]),at=(0,M.useCallback)((function(t){ne([]),e(j.Nw.setWallet(t))}),[]),ct=(0,M.useCallback)(function(){var e=u()(l()().mark((function e(t,n){var a,c;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n.hash,c=n.wallet,e.next=4,A.db.accounts.update(a,{notes:t});case 4:Qe(c),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,m.Tv)(e.t0,r,"handleNotes");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),[]),st=(0,M.useCallback)(u()(l()().mark((function e(){var t,n,a,c,s;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.db.wallets.toArray();case 3:return t=e.sent,e.next=6,A.db.accounts.toArray();case 6:n=e.sent,a={wallets:t,accounts:n},c="data:,".concat(JSON.stringify(a,null,2)),(s=document.createElement("a")).href=c,s.download="wallets_".concat(W()().format("YYYY-MM-DD_HH-mm"),".json"),s.click(),r.success(xe),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),(0,m.Tv)(e.t0,r,"handleBackup");case 19:case"end":return e.stop()}}),e,null,[[0,16]])}))),[]),ot=(0,M.useCallback)(function(){var t=u()(l()().mark((function t(n){var a;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=new FileReader).readAsText(n.fileList[0].originFileObj),a.onload=u()(l()().mark((function t(){var n,c,s,o;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=a.result,!(c=JSON.parse(n))){t.next=23;break}if(!c.wallets.length){t.next=11;break}return t.next=7,A.db.wallets.toArray();case 7:return s=t.sent,c.wallets.forEach((function(e){var t=s.find((function(t){return t.hash===e.hash}));t?t.count<e.count&&(t.count=e.count):s.push(e)})),t.next=11,A.db.wallets.bulkPut(s);case 11:if(!c.accounts.length){t.next=18;break}return t.next=14,A.db.accounts.toArray();case 14:return o=t.sent,c.accounts.forEach((function(e){o.find((function(t){return t.hash===e.hash}))||o.push(e)})),t.next=18,A.db.accounts.bulkPut(o);case 18:nt(I),e(j.Nw.setWallet("")),r.success(ke),t.next=24;break;case 23:r.error(be);case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(0),(0,m.Tv)(t.t0,r,"handleRestore");case 29:case"end":return t.stop()}}),t,null,[[0,26]])})));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[U]),lt=(0,M.useCallback)((function(){if(U)return te.length?void(z[U]?re.current.handleOpen(te):le.current.handleOpen(U)):r.error(ye);r.error(ge)}),[U,te,z]),it=(0,M.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",render:function(e,t,n){return(0,D.jsx)("span",{children:n+1})}},{title:"".concat(je),dataIndex:"publicKey",key:"publicKey",render:function(e,t){return(0,D.jsx)(O.VU,{content:t.publicKey,ellipsis:!0,chain:I,copyable:{tooltips:!1,text:t.publicKey}})}},{title:"".concat(Ae),dataIndex:"lamports",key:"lamports",render:function(e,t){return(0,D.jsx)("span",{children:t.lamports.dividedBy(T.LAMPORTS_PER_SOL).toString()+" SOL"})}},{title:"".concat(Pe),dataIndex:"created",key:"created",render:function(e,t){return(0,D.jsx)("span",{children:t.created?Se:Ne})}},{title:"Nonce".concat(Ze),dataIndex:"nonceCreated",key:"nonceCreated",render:function(e,t){return(0,D.jsx)("span",{children:t.nonceCreated?(0,D.jsx)(O.VU,{content:t.nonce,ellipsis:!0,chain:I,copyable:{tooltips:!1,text:t.nonce}}):Ne})}},{title:"".concat(Te),dataIndex:"notes",key:"notes",render:function(e,t){return(0,D.jsx)(v.Z.Paragraph,{editable:{onChange:function(e){return ct(e,t)}},children:t.notes})}},{title:"".concat(Ye),dataIndex:"key",key:"key",render:function(e,t){return(0,D.jsx)(y.ZP,{size:"small",onClick:function(){return $e(t)},children:_e})}}]}),[I,$e]),ut=(0,M.useCallback)((function(t,n){var r=a()({},t);delete r[n],e(j.Nw.setLocks(r))}),[]),dt=(0,M.useCallback)((function(){return U?z[U]?(0,D.jsx)(B.Z,{className:" text-xl text-green-500 cursor-pointer",onClick:function(){return ut(z,U)}}):(0,D.jsx)(V.Z,{className:" text-xl text-yellow-500 cursor-pointer",onClick:function(){return le.current.handleOpen(U)}}):null}),[U,z]);return(0,M.useEffect)((function(){nt(I)}),[I]),(0,M.useEffect)((function(){Qe(U)}),[U]),(0,D.jsxs)(h._z,{className:"wallet",ghost:!0,children:[(0,D.jsx)(x.Z,{className:"",title:(0,D.jsx)("div",{className:"text-red-600",children:pe}),children:(0,D.jsxs)("div",{className:"grid gap-2",children:[(0,D.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,D.jsx)(y.ZP,{type:"primary",onClick:function(){return ae.current.handleOpen()},children:Oe}),(0,D.jsx)(y.ZP,{type:"primary",onClick:qe,children:Ke}),(0,D.jsx)(y.ZP,{type:"primary",onClick:tt,children:Be}),(0,D.jsx)(y.ZP,{type:"primary",onClick:st,children:Le}),(0,D.jsx)(y.ZP,{type:"primary",onClick:function(){return ce.current.handleOpen()},children:Re}),(0,D.jsx)(y.ZP,{type:"primary",onClick:Ge,children:De}),(0,D.jsx)(y.ZP,{type:"primary",onClick:Je,children:Fe})]}),(0,D.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,D.jsx)(y.ZP,{type:"primary",onClick:rt,children:Ee}),(0,D.jsx)(y.ZP,{type:"primary",onClick:Xe,children:We}),(0,D.jsx)(y.ZP,{type:"primary",onClick:et,children:Ve}),(0,D.jsx)(w.Z,{accept:".json",maxCount:1,showUploadList:!1,onChange:ot,beforeUpload:function(){return!1},children:(0,D.jsx)(y.ZP,{type:"primary",children:Ue})},"restore")]}),(0,D.jsx)("div",{className:"flex gap-2 flex-wrap",children:(0,D.jsx)(y.ZP,{type:"primary",onClick:lt,children:He})}),(0,D.jsxs)("div",{className:"my-2",children:[U?"".concat(Ie,"-").concat(U.slice(0,3),"："):"".concat(Ie,"："),(0,D.jsx)(C.Z,{style:{width:"200px",height:"32px",marginRight:"8px"},showSearch:!0,placeholder:ge,optionFilterProp:"label",onChange:at,value:U,options:H}),dt()]})]})}),(0,D.jsx)(k.Z,{scroll:{x:!0},size:"small",columns:it,dataSource:L,defaultData:[],loading:{spinning:G,size:"large"},search:!1,options:!1,pagination:!1,tableAlertRender:!1,tableAlertOptionRender:!1,rowSelection:{type:"checkbox",selectedRowKeys:te,onChange:function(e){ne(e)}}}),(0,D.jsx)(f.LV,{ref:ae,messageApi:r,handleUpdateWallets:nt}),(0,D.jsx)(f.Tc,{ref:re,messageApi:r,handleUpdateAccounts:Qe,notificationApi:d}),(0,D.jsx)(f.rf,{ref:ce,messageApi:r,handleUpdateWallets:nt}),(0,D.jsx)(f.vA,{ref:se,messageApi:r,handleUpdateAccounts:Qe}),(0,D.jsx)(f.fd,{ref:oe,messageApi:r,handleUpdateWallets:nt}),(0,D.jsx)(f.S8,{ref:le,messageApi:r}),(0,D.jsx)(f.Ny,{ref:ie,messageApi:r}),(0,D.jsx)(f.g$,{ref:ue,messageApi:r}),c,K]})}},8849:function(){}}]);