"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7739],{87739:function(e,t,r){r.d(t,{VZ:function(){return Ce},aC:function(){return Te},oc:function(){return pe},ZJ:function(){return ze},am:function(){return Ke},Wo:function(){return d},UM:function(){return le},PO:function(){return q},Af:function(){return J},Hp:function(){return ne},Hm:function(){return ie},a1:function(){return Ge},nK:function(){return Xe},ZH:function(){return X},Dm:function(){return te}});var n=r(67294),a=r(5574),s=r.n(a),c=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function i(e,t){var r=t.format,n=void 0===r?"":r,a=new Date(e).getTime(),i=Date.now();return function(e,t){var r=e,n=/\[[^\]]*]/g,a=(t.match(n)||[]).map((function(e){return e.slice(1,-1)})),i=t.replace(n,"[]"),u=c.reduce((function(e,t){var n=s()(t,2),a=n[0],c=n[1];if(e.includes(a)){var i=Math.floor(r/c);return r-=i*c,e.replace(new RegExp("".concat(a,"+"),"g"),(function(e){var t=e.length;return i.toString().padStart(t,"0")}))}return e}),i),l=0;return u.replace(n,(function(){var e=a[l];return l+=1,e}))}(Math.max(a-i,0),n)}var u=r(40165),l=r(85893);var o=function(e){var t,r=e.value,a=e.format,c=void 0===a?"HH:mm:ss":a,o=e.onChange,d=e.onFinish,f=e.className,p=(t=(0,n.useReducer)((function(e){return e+1}),0),s()(t,2)[1]),h=n.useRef(null),v=function(){var e=function(e){return new Date(e).getTime()}(r);e>=Date.now()&&(h.current=(0,u.Zi)((function(){p(),null==o||o(e-Date.now()),e<Date.now()&&(null==d||d(),h.current&&((0,u.cv)(h.current),h.current=null))}),33.333333333333336))};return n.useEffect((function(){return v(),function(){h.current&&((0,u.cv)(h.current),h.current=null)}}),[r]),(0,l.jsx)("div",{className:f,children:i(r,{format:c})})},d=n.memo(o),f=r(15009),p=r.n(f),h=r(99289),v=r.n(h),m=r(64599),x=r.n(m),b=r(40956),k=r(49591),j=r(32427),y=r(88026),S=r(2453),g=r(16568),P=r(83622),w=r(85137),C=r(27484),F=r.n(C),L=r(70178),N=r.n(L),M=r(70609),R=r(64119),O=r(29363),T=r(49717),I=r(54306),V=r(43651),_=r(44718),A=r(28704),Z=r(30527),E=r(52434),D=r(71874);F().extend(N());var z=function(e){var t=e.handleCurrentProjectNfts,r=(0,y.useDispatch)(),a=S.ZP.useMessage(),c=s()(a,2),i=c[0],u=c[1],o=g.ZP.useNotification(),f=s()(o,2),h=f[0],m=f[1],C=(0,I.O)(),F=C.publicKey,L=C.signTransaction,N=C.wallet,z=C.signMessage,q=(0,V.z)(),Y=(0,_.R)().connection,H=(0,T.A)(),$=H.chain,B=H.modalFeeRef,U=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsDataSourceV1})),K=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsDataSourceResetV1})),W=(0,y.useSelector)((function(e){return e.ppp.currentProjectDataSourceV1})),G=(0,n.useMemo)((function(){var e=new Set;U.forEach((function(t){e.add(t.ownerPubkey)}));var t,r=[],n=x()(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;r.push({text:a,value:a})}}catch(e){n.e(e)}finally{n.f()}return r}),[U]),J=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsLoading})),Q=(0,n.useMemo)((function(){var e=new Set;return U.forEach((function(t){e.add(t.ownerPubkey)})),e.size}),[U]),X=(0,n.useMemo)((function(){var e=0;return U.forEach((function(t){e+=t.invest})),e/O.LAMPORTS_PER_SOL}),[U]),ee=(0,n.useMemo)((function(){var e=0;return U.forEach((function(t){e+=t.price})),e/O.LAMPORTS_PER_SOL}),[U]),te=(0,n.useState)([]),re=s()(te,2),ne=re[0],ae=re[1],se=(0,y.useIntl)().formatMessage({id:"common.intlPleaseConnectWallet"}),ce=(0,n.useCallback)((function(e){var t=e.ownerPubkey,n=U.filter((function(e){return e.ownerPubkey===t}));r(b.N.setCurrentProjectNftsDataSourceV1(n))}),[U]),ie=(0,n.useCallback)((function(){r(b.N.setCurrentProjectNftsDataSourceV1(K))}),[K]),ue=(0,n.useCallback)(v()(p()().mark((function e(){var r,n,a,c,u,l,o,d,f,v,m,b,k,j,y,S,g,P,w,C,M,O,T,I,V,_;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&L&&N&&z&&q){e.next=3;break}return e.abrupt("return",i.error(se));case 3:return e.next=5,(0,A.vo)(F.toString(),z);case 5:r=e.sent,n=r.user,a=n.referral,c=new Z.$r(E,new Z.Y7(Y,q,Z.Y7.defaultOptions())),u=U.filter((function(e){return ne.includes(e.key)})),l=[],o=5,d=x()(u.entries()),e.prev=13,d.s();case 15:if((f=d.n()).done){e.next=47;break}return v=s()(f.value,2),m=v[0],b=v[1],k=b.nftPubkey,j=b.ownerPubkey,y=F,S=a,2,e.next=24,(0,A.zt)({program:c,nftPubkey:k,currentOwnerPubkey:j,payerPubkey:y,currentProjectDataSource:W,userReferral:S,payMode:2});case 24:if(g=e.sent,l.push(g),(P=m+1)%o!=0&&P!==u.length){e.next=45;break}return e.next=30,Y.getLatestBlockhash();case 30:return w=e.sent,C=w.blockhash,M=w.lastValidBlockHeight,e.next=35,(0,D.fC)(Y,N,C,l,L,B);case 35:return O=e.sent,T=O.transaction,I=O.feeMode,e.next=40,(0,D.pR)(Y,N,T,I);case 40:return V=e.sent,_={signature:V,blockhash:C,lastValidBlockHeight:M},e.next=44,(0,D.fS)($,Y,_,"confirmed",h,i);case 44:l=[];case 45:e.next=15;break;case 47:e.next=52;break;case 49:e.prev=49,e.t0=e.catch(13),d.e(e.t0);case 52:return e.prev=52,d.f(),e.finish(52);case 55:t(W.mintPubkey),e.next=61;break;case 58:e.prev=58,e.t1=e.catch(0),(0,R.Tv)(e.t1,i,"handleBuy");case 61:case"end":return e.stop()}}),e,null,[[0,58],[13,49,52,55]])}))),[ne,U,W,F,L,N,z,Y,$]),le=(0,n.useCallback)(v()(p()().mark((function e(){var r,n,a,c,u,l,o,d,f,v,m,b,k,j,y,S,g,P,w,C,M;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&L&&N&&z&&q){e.next=3;break}return e.abrupt("return",i.error(se));case 3:r=new Z.$r(E,new Z.Y7(Y,q,Z.Y7.defaultOptions())),n=U.filter((function(e){return ne.includes(e.key)})),a=[],c=20,u=x()(n.entries()),e.prev=8,u.s();case 10:if((l=u.n()).done){e.next=39;break}return o=s()(l.value,2),d=o[0],f=o[1],v=F,m=f,e.next=16,(0,A.Km)({program:r,payerPubkey:v,currentProjectDataSource:W,currentProjectNftDataSource:m,index:d});case 16:if(b=e.sent,a.push(b),(k=d+1)%c!=0&&k!==n.length){e.next=37;break}return e.next=22,Y.getLatestBlockhash();case 22:return j=e.sent,y=j.blockhash,S=j.lastValidBlockHeight,e.next=27,(0,D.fC)(Y,N,y,a,L,B);case 27:return g=e.sent,P=g.transaction,w=g.feeMode,e.next=32,(0,D.pR)(Y,N,P,w);case 32:return C=e.sent,M={signature:C,blockhash:y,lastValidBlockHeight:S},e.next=36,(0,D.fS)($,Y,M,"confirmed",h,i);case 36:a=[];case 37:e.next=10;break;case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(8),u.e(e.t0);case 44:return e.prev=44,u.f(),e.finish(44);case 47:ae([]),t(W.mintPubkey),e.next=54;break;case 51:e.prev=51,e.t1=e.catch(0),(0,R.Tv)(e.t1,i,"handleSplit");case 54:case"end":return e.stop()}}),e,null,[[0,51],[8,41,44,47]])}))),[ne,U,W,F,L,N,z,Y,$]),oe=(0,n.useCallback)(v()(p()().mark((function e(){var r,n,a,c,u,l,o,d,f,v,m,b,k,j,y,S,g,P,w,C,M;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&L&&N&&z&&q){e.next=3;break}return e.abrupt("return",i.error(se));case 3:r=new Z.$r(E,new Z.Y7(Y,q,Z.Y7.defaultOptions())),n=U.filter((function(e){return ne.includes(e.key)})),a=[],c=15,u=x()(n.entries()),e.prev=8,u.s();case 10:if((l=u.n()).done){e.next=39;break}return o=s()(l.value,2),d=o[0],f=o[1],v=F,m=f,e.next=16,(0,A.Q8)({program:r,payerPubkey:v,currentProjectDataSource:W,currentProjectNftDataSource:m});case 16:if(b=e.sent,a.push(b),(k=d+1)%c!=0&&k!==n.length){e.next=37;break}return e.next=22,Y.getLatestBlockhash();case 22:return j=e.sent,y=j.blockhash,S=j.lastValidBlockHeight,e.next=27,(0,D.fC)(Y,N,y,a,L,B);case 27:return g=e.sent,P=g.transaction,w=g.feeMode,e.next=32,(0,D.pR)(Y,N,P,w);case 32:return C=e.sent,M={signature:C,blockhash:y,lastValidBlockHeight:S},e.next=36,(0,D.fS)($,Y,M,"confirmed",h,i);case 36:a=[];case 37:e.next=10;break;case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(8),u.e(e.t0);case 44:return e.prev=44,u.f(),e.finish(44);case 47:ae([]),t(W.mintPubkey),e.next=54;break;case 51:e.prev=51,e.t1=e.catch(0),(0,R.Tv)(e.t1,i,"handleBurn");case 54:case"end":return e.stop()}}),e,null,[[0,51],[8,41,44,47]])}))),[ne,U,W,F,L,N,z,Y,$]),de=(0,n.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",search:!1,render:function(e,t,r){return(0,l.jsx)("span",{children:r+1})}},{title:"ID",dataIndex:"nftId",key:"nftId",search:!1,render:function(e,t){return(0,l.jsxs)("div",{children:["#",t.nftId]})}},{title:"状态",dataIndex:"status",key:"status",filters:[{text:"可买",value:"buy"},{text:"已售",value:"sell"},{text:"可拆分",value:"split"},{text:"可销毁",value:"burn"}],onFilter:function(e,t){return"buy"===e?t.status.includes("可买"):"sell"===e?"已售"===t.status:"split"===e?"可拆分"===t.status:"burn"!==e||t.status.includes("可销毁")},sorter:function(e,t){return e.status.localeCompare(t.status)},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.status})}},{title:"持有者(".concat(Q,")"),dataIndex:"ownerPubkey",key:"ownerPubkey",filters:G,onFilter:function(e,t){return e===t.ownerPubkey},sorter:function(e,t){return e.ownerPubkey.localeCompare(t.ownerPubkey)},render:function(e,t){return(0,l.jsx)(M.VU,{ellipsis:!0,content:t.ownerPubkey,copyable:{tooltips:!1,text:t.ownerPubkey},chain:$})}},{title:"投入成本(".concat(X.toFixed(0),")"),dataIndex:"invest",key:"invest",sorter:function(e,t){return e.invest-t.invest},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.invest/O.LAMPORTS_PER_SOL,6)})}},{title:"当前价格(".concat(ee.toFixed(0),")"),dataIndex:"price",key:"price",sorter:function(e,t){return e.price-t.price},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.price/O.LAMPORTS_PER_SOL,6)})}},{title:"卖出利润(".concat(W.profitRate.toFixed(2),"%)"),dataIndex:"profit",key:"profit",sorter:function(e,t){return e.profit-t.profit},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profit/O.LAMPORTS_PER_SOL,6)})}},{title:"购买时间",dataIndex:"lastTrade",key:"lastTrade",sorter:function(e,t){return t.lastTradeLocalValue-e.lastTradeLocalValue},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.lastTradeLocalFormat})}},{title:"销毁时间",dataIndex:"lastTrade",key:"lastTrade",sorter:function(e,t){return t.burnTimeLocalValue-e.burnTimeLocalValue},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.burnTimeLocalFormat})}},{title:"销毁倒计时",dataIndex:"lastTrade",key:"lastTrade",search:!1,render:function(e,t){return(0,l.jsx)(d,{value:t.burnTimeLocalValue})}}]}),[X,G,Q,ee,W]);return(0,l.jsxs)("div",{className:"ppp-tab-nft",children:[(0,l.jsx)(j.Z,{loading:{spinning:J,size:"large"},scroll:{x:!0},size:"small",columns:de,dataSource:U,defaultData:[],search:{defaultCollapsed:!1,layout:"horizontal",labelWidth:"auto",collapseRender:!1,className:"p-[0px]",optionRender:function(e,r,n){return[n[1],(0,l.jsx)(P.ZP,{type:"primary",onClick:function(){t(W.mintPubkey),ae([])},children:"更新"},"update"),n[0]]}},rowSelection:{type:"checkbox",selectedRowKeys:ne,onChange:function(e){ae(e)}},onSubmit:ce,onReset:ie,options:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1}),!!ne.length&&(0,l.jsxs)(w.Z.Group,{trigger:"click",type:"primary",style:{insetInlineEnd:50},icon:(0,l.jsx)(k.Z,{}),shape:"square",children:[(0,l.jsx)(w.Z,{type:"primary",description:"购买",onClick:ue,shape:"square"},"1"),(0,l.jsx)(w.Z,{type:"primary",description:"拆分",onClick:le,shape:"square"},"2"),(0,l.jsx)(w.Z,{type:"primary",description:"销毁",onClick:oe,shape:"square"},"3")]}),u,m]})},q=(0,n.memo)(z),Y=r(9783),H=r.n(Y),$=r(97857),B=r.n($),U=r(26024),K=r(85418),W=r(58868);F().extend(N());var G=function(e){var t=e.handleCurrentProjectNfts,r=(0,y.useDispatch)(),a=S.ZP.useMessage(),c=s()(a,2),i=c[0],u=c[1],o=g.ZP.useNotification(),f=s()(o,2),h=f[0],m=f[1],C=(0,I.O)(),F=C.publicKey,L=C.wallet,N=C.signMessage,E=C.signAllTransactions,z=(0,V.z)(),q=(0,_.R)().connection,Y=(0,T.A)(),$=Y.chain,G=Y.modalFeeRef,J=(0,n.useState)(!1),Q=s()(J,2),X=Q[0],ee=Q[1],te=(0,n.useState)({}),re=s()(te,2),ne=re[0],ae=re[1],se=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsDataSourceV2})),ce=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsDataSourceResetV2})),ie=(0,y.useSelector)((function(e){return e.ppp.currentProjectDataSourceV2})),ue=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsBuyDataV2})),le=(0,n.useMemo)((function(){var e=new Set;se.forEach((function(t){e.add(t.ownerPubkey)}));var t,r=[],n=x()(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;r.push({text:a,value:a})}}catch(e){n.e(e)}finally{n.f()}return r}),[se]),oe=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsLoading})),de=(0,n.useMemo)((function(){if(!se.length)return"";var e=new Set;return se.forEach((function(t){e.add(t.ownerPubkey)})),"(".concat(e.size,")")}),[se]),fe=(0,n.useMemo)((function(){if(!se.length)return"";var e=0;return se.forEach((function(t){e+=t.invest})),"(".concat((e/O.LAMPORTS_PER_SOL).toFixed(0),")")}),[se]),pe=(0,n.useMemo)((function(){if(!se.length)return"";var e=0;return se.forEach((function(t){e+=t.price})),"(".concat((e/O.LAMPORTS_PER_SOL).toFixed(0),")")}),[se]),he=(0,n.useMemo)((function(){var e=ue.durable;if(0===e)return"";if(e<60)return"(".concat(e.toFixed(0),"秒)");if(e>=60&&e<3600){var t=Math.floor(e/60),r=e%60;return"(".concat(t,"分").concat(r,"秒)")}var n=Math.floor(e/3600),a=((e-3600*n)/60).toFixed(0);return"(".concat(n,"时").concat(a,"分)")}),[ue]),ve=(0,n.useMemo)((function(){return ie.profitRate?"(".concat(ie.profitRate.toFixed(2),"%)"):""}),[ie]),me=(0,n.useState)([]),xe=s()(me,2),be=xe[0],ke=xe[1],je=(0,y.useIntl)().formatMessage({id:"common.intlPleaseConnectWallet"}),ye=(0,n.useCallback)((function(e){var t=e.ownerPubkey,n=se.filter((function(e){return e.ownerPubkey===t}));r(b.N.setCurrentProjectNftsDataSourceV2(n))}),[se]),Se=(0,n.useCallback)((function(){r(b.N.setCurrentProjectNftsDataSourceV2(ce))}),[ce]),ge=(0,n.useCallback)(v()(p()().mark((function e(){var r,n,a,c,u,l,o,d,f,v,m,b,k,j,y,S,g,P,w,C,M,O,T,I,V,_,Y;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&E&&L&&N&&z){e.next=3;break}return e.abrupt("return",i.error(je));case 3:return e.next=5,(0,A.qj)(F.toString(),N);case 5:r=e.sent,n=r.user,a=n.referral,c=new Z.$r(W,new Z.Y7(q,z,Z.Y7.defaultOptions())),u=se.filter((function(e){return be.includes(e.key)})),l=5,o=[],d=[],f=x()(u.entries()),e.prev=14,f.s();case 16:if((v=f.n()).done){e.next=31;break}return m=s()(v.value,2),b=m[0],k=m[1],j=k.nftPubkey,y=k.ownerPubkey,S=F,g=a,2,e.next=25,(0,A.G4)({program:c,nftPubkey:j,currentOwnerPubkey:y,payerPubkey:S,currentProjectDataSource:ie,userReferral:g,payMode:2});case 25:P=e.sent,o.push(P),(w=b+1)%l!=0&&w!==u.length||(d.push(o),o=[]);case 29:e.next=16;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(14),f.e(e.t0);case 36:return e.prev=36,f.f(),e.finish(36);case 39:return e.next=41,q.getLatestBlockhash();case 41:return C=e.sent,M=C.blockhash,O=C.lastValidBlockHeight,T=new Array(d.length).fill(M),e.next=47,(0,D.Gw)(q,L,T,d,E,G);case 47:return I=e.sent,V=I.transactions,_=I.feeMode,Y=T.map((function(e){return{signature:"",blockhash:e,lastValidBlockHeight:O}})),e.next=53,(0,D.fv)({chain:$,connection:q,wallet:L,transactions:V,strategys:Y,notificationApi:h,feeMode:_});case 53:t(ie.mintPubkey),e.next=59;break;case 56:e.prev=56,e.t1=e.catch(0),(0,R.Tv)(e.t1,i,"handleBuy");case 59:case"end":return e.stop()}}),e,null,[[0,56],[14,33,36,39]])}))),[be,se,ie,F,E,L,N,q,$]),Pe=(0,n.useCallback)(v()(p()().mark((function e(){var r,n,a,c,u,l,o,d,f,v,m,b,k,j,y,S,g,P,w,C,M,O,T,I,V,_;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&E&&L&&N&&z){e.next=3;break}return e.abrupt("return",i.error(je));case 3:r=new Z.$r(W,new Z.Y7(q,z,Z.Y7.defaultOptions())),n=se.filter((function(e){return be.includes(e.key)})),a=18,c=[],u=[],l=x()(n.entries()),e.prev=9,l.s();case 11:if((o=l.n()).done){e.next=23;break}return d=s()(o.value,2),f=d[0],v=d[1],m=F,b=v,e.next=17,(0,A.Q9)({program:r,payerPubkey:m,currentProjectDataSource:ie,currentProjectNftDataSource:b,index:f});case 17:k=e.sent,c.push(k),(j=f+1)%a!=0&&j!==n.length||(u.push(c),c=[]);case 21:e.next=11;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(9),l.e(e.t0);case 28:return e.prev=28,l.f(),e.finish(28);case 31:return e.next=33,q.getLatestBlockhash();case 33:return y=e.sent,S=y.blockhash,g=y.lastValidBlockHeight,P=new Array(u.length).fill(S),e.next=39,(0,D.Gw)(q,L,P,u,E,G);case 39:w=e.sent,C=w.transactions,M=w.feeMode,O=x()(C),e.prev=43,O.s();case 45:if((T=O.n()).done){e.next=55;break}return I=T.value,e.next=49,(0,D.pR)(q,L,I,M);case 49:return V=e.sent,_={signature:V,blockhash:S,lastValidBlockHeight:g},e.next=53,(0,D.fS)($,q,_,"confirmed",h,i);case 53:e.next=45;break;case 55:e.next=60;break;case 57:e.prev=57,e.t1=e.catch(43),O.e(e.t1);case 60:return e.prev=60,O.f(),e.finish(60);case 63:ke([]),t(ie.mintPubkey),e.next=70;break;case 67:e.prev=67,e.t2=e.catch(0),(0,R.Tv)(e.t2,i,"handleSplit");case 70:case"end":return e.stop()}}),e,null,[[0,67],[9,25,28,31],[43,57,60,63]])}))),[be,se,ie,F,E,L,N,q,$]),we=(0,n.useCallback)(v()(p()().mark((function e(){var r,n,a,c,u,l,o,d,f,v,m,b,k,j,y,S,g,P,w,C,M,O;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&E&&L&&N&&z){e.next=3;break}return e.abrupt("return",i.error(je));case 3:r=new Z.$r(W,new Z.Y7(q,z,Z.Y7.defaultOptions())),n=se.filter((function(e){return be.includes(e.key)})),a=5,c=[],u=[],l=x()(n.entries()),e.prev=9,l.s();case 11:if((o=l.n()).done){e.next=23;break}return d=s()(o.value,2),f=d[0],v=d[1],m=F,b=v,e.next=17,(0,A.mn)({program:r,payerPubkey:m,currentProjectDataSource:ie,currentProjectNftDataSource:b});case 17:k=e.sent,c.push(k),(j=f+1)%a!=0&&j!==n.length||(u.push(c),c=[]);case 21:e.next=11;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(9),l.e(e.t0);case 28:return e.prev=28,l.f(),e.finish(28);case 31:return e.next=33,q.getLatestBlockhash();case 33:return y=e.sent,S=y.blockhash,g=y.lastValidBlockHeight,P=new Array(u.length).fill(S),e.next=39,(0,D.Gw)(q,L,P,u,E,G);case 39:return w=e.sent,C=w.transactions,M=w.feeMode,O=P.map((function(e){return{signature:"",blockhash:e,lastValidBlockHeight:g}})),e.next=45,(0,D.fv)({chain:$,connection:q,wallet:L,transactions:C,strategys:O,notificationApi:h,feeMode:M});case 45:ke([]),t(ie.mintPubkey),e.next=52;break;case 49:e.prev=49,e.t1=e.catch(0),(0,R.Tv)(e.t1,i,"handleBurn");case 52:case"end":return e.stop()}}),e,null,[[0,49],[9,25,28,31]])}))),[be,se,ie,F,E,L,N,q,$]),Ce=(0,n.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",search:!1,hidden:ne.key,render:function(e,t,r){return(0,l.jsx)("span",{children:r+1})}},{title:"ID",dataIndex:"nftId",key:"nftId",search:!1,hidden:ne.nftId,render:function(e,t){return(0,l.jsxs)("div",{children:["#",t.nftId]})}},{title:"状态",dataIndex:"status",key:"status",hidden:ne.status,filters:[{text:"可买",value:"buy"},{text:"已售",value:"sell"},{text:"可拆分",value:"split"},{text:"可销毁",value:"burn"}],onFilter:function(e,t){return"buy"===e?t.status.includes("可买"):"sell"===e?"已售"===t.status:"split"===e?"可拆分"===t.status:"burn"!==e||t.status.includes("可销毁")},sorter:function(e,t){return e.status.localeCompare(t.status)},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.status})}},{title:"持有者".concat(de),dataIndex:"ownerPubkey",key:"ownerPubkey",hidden:ne.ownerPubkey,filters:le,onFilter:function(e,t){return e===t.ownerPubkey},sorter:function(e,t){return e.ownerPubkey.localeCompare(t.ownerPubkey)},render:function(e,t){return(0,l.jsx)(M.VU,{ellipsis:!0,content:t.ownerPubkey,copyable:{tooltips:!1,text:t.ownerPubkey},chain:$})}},{title:"投入成本".concat(fe),dataIndex:"invest",key:"invest",hidden:ne.invest,sorter:function(e,t){return e.invest-t.invest},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.invest/O.LAMPORTS_PER_SOL,6)})}},{title:"当前价格".concat(pe),dataIndex:"price",key:"price",hidden:ne.price,sorter:function(e,t){return e.price-t.price},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.price/O.LAMPORTS_PER_SOL,6)})}},{title:"卖出利润".concat(ve),dataIndex:"profit",key:"profit",hidden:ne.profit,sorter:function(e,t){return e.profit-t.profit},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profit/O.LAMPORTS_PER_SOL,6)})}},{title:"购买时间".concat(he),dataIndex:"lastTrade",key:"buyTime",hidden:ne.buyTime,sorter:function(e,t){return e.lastTradeLocalValue-t.lastTradeLocalValue},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.lastTradeLocalFormat})}},{title:"销毁时间",dataIndex:"lastTrade",key:"burnTime",hidden:ne.burnTime,sorter:function(e,t){return e.burnTimeLocalValue-t.burnTimeLocalValue},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.burnTimeLocalFormat})}},{title:"销毁倒计时",dataIndex:"lastTrade",key:"burnCountdown",hidden:ne.burnCountdown,search:!1,render:function(e,t){return(0,l.jsx)(d,{value:t.burnTimeLocalValue})}}]}),[fe,le,de,pe,ie,he,ne]),Fe=(0,n.useMemo)((function(){return[{label:"key",key:"key"},{label:"nftId",key:"nftId"},{label:"状态",key:"status"},{label:"持有者",key:"ownerPubkey"},{label:"投入成本",key:"invest"},{label:"当前价格",key:"price"},{label:"卖出利润",key:"profit"},{label:"购买时间",key:"buyTime"},{label:"销毁时间",key:"burnTime"},{label:"销毁倒计时",key:"burnCountdown"}]}),[]),Le=(0,n.useCallback)((function(e,t){("trigger"===t.source||e)&&ee(e)}),[]),Ne=(0,n.useCallback)((function(e){ne[e.key]?ae(B()(B()({},ne),{},H()({},e.key,!1))):ae(B()(B()({},ne),{},H()({},e.key,!0)))}),[ne]),Me=(0,n.useCallback)((function(t,r,n){return[(0,l.jsx)(K.Z,{menu:{items:Fe,selectable:!0,multiple:!0,onClick:Ne},trigger:["click"],placement:"bottomRight",arrow:!0,onOpenChange:Le,open:X,children:(0,l.jsx)(P.ZP,{type:"primary",children:(0,l.jsx)(U.Z,{})})},"filter"),n[1],(0,l.jsx)(P.ZP,{type:"primary",onClick:function(){e.handleCurrentProjectNfts(ie.mintPubkey)},children:"更新"},"update"),n[0]]}),[e,ie,Fe,X,Ne]);return(0,l.jsxs)("div",{className:"ppp-tab-nft",children:[(0,l.jsx)(j.Z,{loading:{spinning:oe,size:"large"},scroll:{x:!0},size:"small",columns:Ce,dataSource:se,defaultData:[],search:{defaultCollapsed:!1,layout:"horizontal",labelWidth:"auto",collapseRender:!1,className:"p-[0px]",optionRender:Me},rowSelection:{type:"checkbox",selectedRowKeys:be,onChange:function(e){ke(e)}},onSubmit:ye,onReset:Se,options:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1}),!!be.length&&(0,l.jsxs)(w.Z.Group,{trigger:"click",type:"primary",style:{insetInlineEnd:50},icon:(0,l.jsx)(k.Z,{}),shape:"square",children:[(0,l.jsx)(w.Z,{type:"primary",description:"购买",onClick:ge,shape:"square"},"1"),(0,l.jsx)(w.Z,{type:"primary",description:"拆分",onClick:Pe,shape:"square"},"2"),(0,l.jsx)(w.Z,{type:"primary",description:"销毁",onClick:we,shape:"square"},"3")]}),u,m]})},J=(0,n.memo)(G);F().extend(N());var Q=function(e){var t=e.handleCurrentProjectUserNfts,r=e.currentProjectUserNftsDataSource,a=e.currentProjectDataSource,c=e.kind,i=S.ZP.useMessage(),u=s()(i,2),o=u[0],f=u[1],h=g.ZP.useNotification(),m=s()(h,2),b=m[0],P=m[1],C=(0,I.O)(),F=C.publicKey,L=C.signTransaction,N=C.wallet,z=C.signMessage,q=(0,V.z)(),Y=(0,_.R)().connection,H=(0,T.A)(),$=H.chain,B=H.modalFeeRef,U=(0,n.useMemo)((function(){var e=new Set;r.forEach((function(t){e.add(t.ownerPubkey)}));var t,n=[],a=x()(e);try{for(a.s();!(t=a.n()).done;){var s=t.value;n.push({text:s,value:s})}}catch(e){a.e(e)}finally{a.f()}return n}),[r]),K=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsLoading})),W=(0,n.useMemo)((function(){var e=new Set;return r.forEach((function(t){e.add(t.ownerPubkey)})),e.size}),[r]),G=(0,n.useMemo)((function(){var e=0;return r.forEach((function(t){e+=t.invest})),e/O.LAMPORTS_PER_SOL}),[r]),J=(0,n.useMemo)((function(){var e=0;return r.forEach((function(t){e+=t.price})),e/O.LAMPORTS_PER_SOL}),[r]),Q=(0,n.useState)([]),X=s()(Q,2),ee=X[0],te=X[1],re=(0,y.useIntl)().formatMessage({id:"common.intlPleaseConnectWallet"}),ne=(0,n.useCallback)(v()(p()().mark((function e(){var n,c,i,u,l,d,f,h,v,m,k,j,y,S,g,P,w,C,M,O,T;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&L&&N&&z&&q){e.next=3;break}return e.abrupt("return",o.error(re));case 3:n=new Z.$r(E,new Z.Y7(Y,q,Z.Y7.defaultOptions())),c=r.filter((function(e){return ee.includes(e.key)})),i=[],u=20,l=x()(c.entries()),e.prev=8,l.s();case 10:if((d=l.n()).done){e.next=39;break}return f=s()(d.value,2),h=f[0],v=f[1],m=F,k=v,e.next=16,(0,A.Km)({program:n,payerPubkey:m,currentProjectDataSource:a,currentProjectNftDataSource:k,index:h});case 16:if(j=e.sent,i.push(j),(y=h+1)%u!=0&&y!==c.length){e.next=37;break}return e.next=22,Y.getLatestBlockhash();case 22:return S=e.sent,g=S.blockhash,P=S.lastValidBlockHeight,e.next=27,(0,D.fC)(Y,N,g,i,L,B);case 27:return w=e.sent,C=w.transaction,M=w.feeMode,e.next=32,(0,D.pR)(Y,N,C,M);case 32:return O=e.sent,T={signature:O,blockhash:g,lastValidBlockHeight:P},e.next=36,(0,D.fS)($,Y,T,"confirmed",b,o);case 36:i=[];case 37:e.next=10;break;case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(8),l.e(e.t0);case 44:return e.prev=44,l.f(),e.finish(44);case 47:te([]),t(a.mintPubkey,F.toString()),e.next=54;break;case 51:e.prev=51,e.t1=e.catch(0),(0,R.Tv)(e.t1,o,"handleSplit");case 54:case"end":return e.stop()}}),e,null,[[0,51],[8,41,44,47]])}))),[ee,r,a,F,L,N,z,Y,$]),ae=(0,n.useCallback)(v()(p()().mark((function e(){var n,c,i,u,l,d,f,h,v,m,k,j,y,S,g,P,w,C,M,O,T;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&L&&N&&z&&q){e.next=3;break}return e.abrupt("return",o.error(re));case 3:n=new Z.$r(E,new Z.Y7(Y,q,Z.Y7.defaultOptions())),c=r.filter((function(e){return ee.includes(e.key)})),i=[],u=15,l=x()(c.entries()),e.prev=8,l.s();case 10:if((d=l.n()).done){e.next=39;break}return f=s()(d.value,2),h=f[0],v=f[1],m=F,k=v,e.next=16,(0,A.Q8)({program:n,payerPubkey:m,currentProjectDataSource:a,currentProjectNftDataSource:k});case 16:if(j=e.sent,i.push(j),(y=h+1)%u!=0&&y!==c.length){e.next=37;break}return e.next=22,Y.getLatestBlockhash();case 22:return S=e.sent,g=S.blockhash,P=S.lastValidBlockHeight,e.next=27,(0,D.fC)(Y,N,g,i,L,B);case 27:return w=e.sent,C=w.transaction,M=w.feeMode,e.next=32,(0,D.pR)(Y,N,C,M);case 32:return O=e.sent,T={signature:O,blockhash:g,lastValidBlockHeight:P},e.next=36,(0,D.fS)($,Y,T,"confirmed",b,o);case 36:i=[];case 37:e.next=10;break;case 39:e.next=44;break;case 41:e.prev=41,e.t0=e.catch(8),l.e(e.t0);case 44:return e.prev=44,l.f(),e.finish(44);case 47:te([]),t(a.mintPubkey,F.toString()),e.next=54;break;case 51:e.prev=51,e.t1=e.catch(0),(0,R.Tv)(e.t1,o,"handleBurn");case 54:case"end":return e.stop()}}),e,null,[[0,51],[8,41,44,47]])}))),[ee,r,a,F,L,N,z,Y,$]),se=(0,n.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",search:!1,render:function(e,t,r){return(0,l.jsx)("span",{children:r+1})}},{title:"ID",dataIndex:"nftId",key:"nftId",search:!1,render:function(e,t){return(0,l.jsxs)("div",{children:["#",t.nftId]})}},{title:"状态",dataIndex:"status",key:"status",filters:[{text:"可买",value:"buy"},{text:"已售",value:"sell"},{text:"可拆分",value:"split"},{text:"可销毁",value:"burn"}],onFilter:function(e,t){return"buy"===e?t.status.includes("可买"):"sell"===e?"已售"===t.status:"split"===e?"可拆分"===t.status:"burn"!==e||t.status.includes("可销毁")},sorter:function(e,t){return e.status.localeCompare(t.status)},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.status})}},{title:"持有者(".concat(W,")"),dataIndex:"ownerPubkey",key:"ownerPubkey",filters:U,onFilter:function(e,t){return e===t.ownerPubkey},sorter:function(e,t){return e.ownerPubkey.localeCompare(t.ownerPubkey)},render:function(e,t){return(0,l.jsx)(M.VU,{ellipsis:!0,content:t.ownerPubkey,copyable:{tooltips:!1,text:t.ownerPubkey},chain:$})}},{title:"投入成本(".concat(G.toFixed(0),")"),dataIndex:"invest",key:"invest",sorter:function(e,t){return e.invest-t.invest},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.invest/O.LAMPORTS_PER_SOL,6)})}},{title:"当前价格(".concat(J.toFixed(0),")"),dataIndex:"price",key:"price",sorter:function(e,t){return e.price-t.price},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.price/O.LAMPORTS_PER_SOL,6)})}},{title:"卖出利润(".concat(a.profitRate.toFixed(2),"%)"),dataIndex:"profit",key:"profit",sorter:function(e,t){return e.profit-t.profit},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profit/O.LAMPORTS_PER_SOL,6)})}},{title:"购买时间",dataIndex:"lastTrade",key:"lastTrade",sorter:function(e,t){return t.lastTradeLocalValue-e.lastTradeLocalValue},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.lastTradeLocalFormat})}},{title:"销毁时间",dataIndex:"lastTrade",key:"lastTrade",sorter:function(e,t){return t.burnTimeLocalValue-e.burnTimeLocalValue},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.burnTimeLocalFormat})}},{title:"销毁倒计时",dataIndex:"lastTrade",key:"lastTrade",search:!1,render:function(e,t){return(0,l.jsx)(d,{value:t.burnTimeLocalValue})}}]}),[G,U,W,J,a]);return(0,l.jsxs)("div",{className:"ppp-tab-nft",children:[(0,l.jsx)(j.Z,{loading:{spinning:K,size:"large"},scroll:{x:!0},size:"small",columns:se,dataSource:r,defaultData:[],rowSelection:{type:"checkbox",selectedRowKeys:ee,onChange:function(e){te(e)}},search:!1,options:!1,pagination:!1}),!!ee.length&&(0,l.jsxs)(w.Z.Group,{trigger:"click",type:"primary",style:{insetInlineEnd:50},icon:(0,l.jsx)(k.Z,{}),shape:"square",children:["split"===c?(0,l.jsx)(w.Z,{type:"primary",description:"拆分",onClick:ne,shape:"square"},"2"):null,"burn"===c?(0,l.jsx)(w.Z,{type:"primary",description:"销毁",onClick:ae,shape:"square"},"3"):null]}),f,P]})},X=(0,n.memo)(Q);F().extend(N());var ee=function(e){var t=e.handleCurrentProjectUserNfts,r=e.currentProjectUserNftsDataSource,a=e.currentProjectDataSource,c=e.kind,i=S.ZP.useMessage(),u=s()(i,2),o=u[0],f=u[1],h=g.ZP.useNotification(),m=s()(h,2),b=m[0],P=m[1],C=(0,I.O)(),F=C.publicKey,L=C.signAllTransactions,N=C.wallet,E=C.signMessage,z=(0,V.z)(),q=(0,_.R)().connection,Y=(0,T.A)(),H=Y.chain,$=Y.modalFeeRef,B=(0,n.useMemo)((function(){var e=new Set;r.forEach((function(t){e.add(t.ownerPubkey)}));var t,n=[],a=x()(e);try{for(a.s();!(t=a.n()).done;){var s=t.value;n.push({text:s,value:s})}}catch(e){a.e(e)}finally{a.f()}return n}),[r]),U=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsLoading})),K=(0,n.useMemo)((function(){var e=new Set;return r.forEach((function(t){e.add(t.ownerPubkey)})),e.size}),[r]),G=(0,n.useMemo)((function(){var e=0;return r.forEach((function(t){e+=t.invest})),e/O.LAMPORTS_PER_SOL}),[r]),J=(0,n.useMemo)((function(){var e=0;return r.forEach((function(t){e+=t.price})),e/O.LAMPORTS_PER_SOL}),[r]),Q=(0,n.useState)([]),X=s()(Q,2),ee=X[0],te=X[1],re=(0,y.useIntl)().formatMessage({id:"common.intlPleaseConnectWallet"}),ne=(0,n.useCallback)(v()(p()().mark((function e(){var n,c,i,u,l,d,f,h,v,m,k,j,y,S,g,P,w,C,M,O,T,I,V,_,Y,B;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&L&&N&&E&&z){e.next=3;break}return e.abrupt("return",o.error(re));case 3:n=new Z.$r(W,new Z.Y7(q,z,Z.Y7.defaultOptions())),c=r.filter((function(e){return ee.includes(e.key)})),i=18,u=[],l=[],d=x()(c.entries()),e.prev=9,d.s();case 11:if((f=d.n()).done){e.next=23;break}return h=s()(f.value,2),v=h[0],m=h[1],k=F,j=m,e.next=17,(0,A.Q9)({program:n,payerPubkey:k,currentProjectDataSource:a,currentProjectNftDataSource:j,index:v});case 17:y=e.sent,u.push(y),(S=v+1)%i!=0&&S!==c.length||(l.push(u),u=[]);case 21:e.next=11;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(9),d.e(e.t0);case 28:return e.prev=28,d.f(),e.finish(28);case 31:return e.next=33,q.getLatestBlockhash();case 33:return g=e.sent,P=g.blockhash,w=g.lastValidBlockHeight,C=new Array(l.length).fill(P),e.next=39,(0,D.Gw)(q,N,C,l,L,$);case 39:M=e.sent,O=M.transactions,T=M.feeMode,I=x()(O),e.prev=43,I.s();case 45:if((V=I.n()).done){e.next=55;break}return _=V.value,e.next=49,(0,D.pR)(q,N,_,T);case 49:return Y=e.sent,B={signature:Y,blockhash:P,lastValidBlockHeight:w},e.next=53,(0,D.fS)(H,q,B,"confirmed",b,o);case 53:e.next=45;break;case 55:e.next=60;break;case 57:e.prev=57,e.t1=e.catch(43),I.e(e.t1);case 60:return e.prev=60,I.f(),e.finish(60);case 63:te([]),t(a.mintPubkey,F.toString()),e.next=70;break;case 67:e.prev=67,e.t2=e.catch(0),(0,R.Tv)(e.t2,o,"handleSplit");case 70:case"end":return e.stop()}}),e,null,[[0,67],[9,25,28,31],[43,57,60,63]])}))),[ee,r,a,F,L,N,E,q,H]),ae=(0,n.useCallback)(v()(p()().mark((function e(){var n,c,i,u,l,d,f,h,v,m,k,j,y,S,g,P,w,C,M,O,T,I;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F&&L&&N&&E&&z){e.next=3;break}return e.abrupt("return",o.error(re));case 3:n=new Z.$r(W,new Z.Y7(q,z,Z.Y7.defaultOptions())),c=r.filter((function(e){return ee.includes(e.key)})),i=5,u=[],l=[],d=x()(c.entries()),e.prev=9,d.s();case 11:if((f=d.n()).done){e.next=23;break}return h=s()(f.value,2),v=h[0],m=h[1],k=F,j=m,e.next=17,(0,A.mn)({program:n,payerPubkey:k,currentProjectDataSource:a,currentProjectNftDataSource:j});case 17:y=e.sent,u.push(y),(S=v+1)%i!=0&&S!==c.length||(l.push(u),u=[]);case 21:e.next=11;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(9),d.e(e.t0);case 28:return e.prev=28,d.f(),e.finish(28);case 31:return e.next=33,q.getLatestBlockhash();case 33:return g=e.sent,P=g.blockhash,w=g.lastValidBlockHeight,C=new Array(l.length).fill(P),e.next=39,(0,D.Gw)(q,N,C,l,L,$);case 39:return M=e.sent,O=M.transactions,T=M.feeMode,I=C.map((function(e){return{signature:"",blockhash:e,lastValidBlockHeight:w}})),e.next=45,(0,D.fv)({chain:H,connection:q,wallet:N,transactions:O,strategys:I,notificationApi:b,feeMode:T});case 45:te([]),t(a.mintPubkey,F.toString()),e.next=52;break;case 49:e.prev=49,e.t1=e.catch(0),(0,R.Tv)(e.t1,o,"handleBurn");case 52:case"end":return e.stop()}}),e,null,[[0,49],[9,25,28,31]])}))),[ee,r,a,F,L,N,E,q,H]),se=(0,n.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",search:!1,render:function(e,t,r){return(0,l.jsx)("span",{children:r+1})}},{title:"ID",dataIndex:"nftId",key:"nftId",search:!1,render:function(e,t){return(0,l.jsxs)("div",{children:["#",t.nftId]})}},{title:"状态",dataIndex:"status",key:"status",filters:[{text:"可买",value:"buy"},{text:"已售",value:"sell"},{text:"可拆分",value:"split"},{text:"可销毁",value:"burn"}],onFilter:function(e,t){return"buy"===e?t.status.includes("可买"):"sell"===e?"已售"===t.status:"split"===e?"可拆分"===t.status:"burn"!==e||t.status.includes("可销毁")},sorter:function(e,t){return e.status.localeCompare(t.status)},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.status})}},{title:"持有者(".concat(K,")"),dataIndex:"ownerPubkey",key:"ownerPubkey",filters:B,onFilter:function(e,t){return e===t.ownerPubkey},sorter:function(e,t){return e.ownerPubkey.localeCompare(t.ownerPubkey)},render:function(e,t){return(0,l.jsx)(M.VU,{ellipsis:!0,content:t.ownerPubkey,copyable:{tooltips:!1,text:t.ownerPubkey},chain:H})}},{title:"投入成本(".concat(G.toFixed(0),")"),dataIndex:"invest",key:"invest",sorter:function(e,t){return e.invest-t.invest},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.invest/O.LAMPORTS_PER_SOL,6)})}},{title:"当前价格(".concat(J.toFixed(0),")"),dataIndex:"price",key:"price",sorter:function(e,t){return e.price-t.price},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.price/O.LAMPORTS_PER_SOL,6)})}},{title:"卖出利润(".concat(a.profitRate.toFixed(2),"%)"),dataIndex:"profit",key:"profit",sorter:function(e,t){return e.profit-t.profit},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profit/O.LAMPORTS_PER_SOL,6)})}},{title:"购买时间",dataIndex:"lastTrade",key:"lastTrade",sorter:function(e,t){return t.lastTradeLocalValue-e.lastTradeLocalValue},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.lastTradeLocalFormat})}},{title:"销毁时间",dataIndex:"lastTrade",key:"lastTrade",sorter:function(e,t){return t.burnTimeLocalValue-e.burnTimeLocalValue},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.burnTimeLocalFormat})}},{title:"销毁倒计时",dataIndex:"lastTrade",key:"lastTrade",search:!1,render:function(e,t){return(0,l.jsx)(d,{value:t.burnTimeLocalValue})}}]}),[G,B,K,J,a]);return(0,l.jsxs)("div",{className:"ppp-tab-nft",children:[(0,l.jsx)(j.Z,{loading:{spinning:U,size:"large"},scroll:{x:!0},size:"small",columns:se,dataSource:r,defaultData:[],rowSelection:{type:"checkbox",selectedRowKeys:ee,onChange:function(e){te(e)}},search:!1,options:!1,pagination:!1}),!!ee.length&&(0,l.jsxs)(w.Z.Group,{trigger:"click",type:"primary",style:{insetInlineEnd:50},icon:(0,l.jsx)(k.Z,{}),shape:"square",children:["split"===c?(0,l.jsx)(w.Z,{type:"primary",description:"拆分",onClick:ne,shape:"square"},"2"):null,"burn"===c?(0,l.jsx)(w.Z,{type:"primary",description:"销毁",onClick:ae,shape:"square"},"3"):null]}),f,P]})},te=(0,n.memo)(ee);F().extend(N());var re=function(e){var t=(0,y.useDispatch)(),r=(0,T.A)().chain,a=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsRankDataSourceResetV1})),s=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsRankDataSourceV1})),c=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsStatusV1})),i=(0,y.useSelector)((function(e){return e.ppp.currentProjectDataSourceV1})),u=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV1})),o=(0,n.useMemo)((function(){var e=new Set;s.forEach((function(t){e.add(t.owner)}));var t,r=[],n=x()(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;r.push({text:a,value:a})}}catch(e){n.e(e)}finally{n.f()}return r}),[s]),d=(0,n.useMemo)((function(){var e=new Set;return s.forEach((function(t){e.add(t.owner)})),e.size}),[s]),f=(0,n.useMemo)((function(){var e=0;return s.forEach((function(t){e+=t.invest})),e/O.LAMPORTS_PER_SOL}),[s]),p=(0,n.useMemo)((function(){var e=0;return s.forEach((function(t){e+=t.profit})),e/O.LAMPORTS_PER_SOL}),[s]),h=(0,n.useMemo)((function(){var e=0;return s.forEach((function(t){e+=t.balance})),e/O.LAMPORTS_PER_SOL}),[s]),v=(0,n.useCallback)((function(e){var r=e.owner,n=s.filter((function(e){return e.owner===r}));t(b.N.setCurrentProjectNftsRankDataSourceV1(n))}),[s]),m=(0,n.useCallback)((function(){t(b.N.setCurrentProjectNftsRankDataSourceV1(a))}),[a]),k=(0,n.useCallback)((function(t,r,n){return[n[1],(0,l.jsx)(P.ZP,{type:"primary",onClick:function(){e.handleCurrentProjectNfts(i.mintPubkey)},children:"更新"},"update"),n[0]]}),[e,i]),S=(0,n.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",search:!1,render:function(e,t,r){return(0,l.jsx)("span",{children:r+1})}},{title:"持有者(".concat(d,")"),dataIndex:"owner",key:"owner",filters:o,onFilter:function(e,t){return e===t.owner},sorter:function(e,t){return e.owner.localeCompare(t.owner)},render:function(e,t){return(0,l.jsx)(M.VU,{ellipsis:!0,content:t.owner,copyable:{tooltips:!1,text:t.owner},chain:r})}},{title:"持有数量(".concat(c.nftNumber,")"),dataIndex:"number",key:"number",sorter:function(e,t){return e.number-t.number},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.number})}},{title:"持有占比",dataIndex:"percent",key:"percent",search:!1,render:function(e,t){return(0,l.jsxs)("div",{children:[t.percent.toFixed(2),"%"]})}},{title:"账号余额(".concat(h.toFixed(4),")"),dataIndex:"balance",key:"balance",search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.balance/O.LAMPORTS_PER_SOL,6)})}},{title:"投入成本(".concat(f.toFixed(4),")"),dataIndex:"invest",key:"invest",sorter:function(e,t){return e.invest-t.invest},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.invest/O.LAMPORTS_PER_SOL,6)})}},{title:"卖出利润(".concat(p.toFixed(4),")"),dataIndex:"profit",key:"profit",sorter:function(e,t){return e.profit-t.profit},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profit/O.LAMPORTS_PER_SOL,6)})}}]}),[o,d,p,d,c,h,r]);return(0,l.jsxs)("div",{className:"ppp-tab-rank mt-3",children:[(0,l.jsx)("div",{className:"font-semibold text-base hardline ml-2",children:"持有者排名"}),(0,l.jsx)(j.Z,{loading:{spinning:u,size:"large"},scroll:{x:!0},size:"small",columns:S,dataSource:s,defaultData:[],search:{defaultCollapsed:!1,layout:"horizontal",labelWidth:"auto",collapseRender:!1,className:"p-[0px]",optionRender:k},onSubmit:v,onReset:m,options:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1})]})},ne=(0,n.memo)(re),ae=r(83062),se=r(25035);F().extend(N());var ce=function(e){var t=(0,y.useDispatch)(),r=(0,n.useState)(!1),a=s()(r,2),c=a[0],i=a[1],u=(0,n.useState)({}),o=s()(u,2),d=o[0],f=o[1],p=(0,T.A)().chain,h=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsRankDataSourceResetV2})),v=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsRankDataSourceV2})),m=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsStatusV2})),k=(0,y.useSelector)((function(e){return e.ppp.currentProjectDataSourceV2})),S=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV2})),g=(0,n.useMemo)((function(){var e=new Set;v.forEach((function(t){e.add(t.owner)}));var t,r=[],n=x()(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;r.push({text:a,value:a})}}catch(e){n.e(e)}finally{n.f()}return r}),[v]),w=(0,n.useMemo)((function(){var e=new Set;return v.forEach((function(t){e.add(t.owner)})),e.size}),[v]),C=(0,n.useMemo)((function(){var e=0;return v.forEach((function(t){e+=t.invest})),e/O.LAMPORTS_PER_SOL}),[v]),F=(0,n.useMemo)((function(){var e=0;return v.forEach((function(t){e+=t.profit})),e/O.LAMPORTS_PER_SOL}),[v]),L=(0,n.useMemo)((function(){var e=0;return v.forEach((function(t){e+=t.balance})),e/O.LAMPORTS_PER_SOL}),[v]),N=(0,n.useCallback)((function(){return(0,l.jsxs)("div",{children:["抢图时长(秒)",(0,l.jsx)(ae.Z,{title:"抢图时长只统计成功的交易，失败的交易没有统计进去。抢图数量大并且时间短的并不一定是速度快，很有可能是存在很多失败的交易，实际情况以链上的记录为准，这里只是做简单的参考。",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]})}),[]),I=(0,n.useCallback)((function(){return(0,l.jsxs)("div",{children:["网络费SOL",(0,l.jsx)(ae.Z,{title:"只统计成功交易的GAS费用，失败交易损耗的GAS费用不统计",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]})}),[]),V=(0,n.useCallback)((function(e){var r=e.owner,n=v.filter((function(e){return e.owner===r}));t(b.N.setCurrentProjectNftsRankDataSourceV2(n))}),[v]),_=(0,n.useCallback)((function(){t(b.N.setCurrentProjectNftsRankDataSourceV2(h))}),[h]),A=(0,n.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",search:!1,hidden:d.key,render:function(e,t,r){return(0,l.jsx)("span",{children:r+1})}},{title:"持有者(".concat(w,")"),dataIndex:"owner",key:"owner",hidden:d.owner,filters:g,onFilter:function(e,t){return e===t.owner},sorter:function(e,t){return e.owner.localeCompare(t.owner)},render:function(e,t){return(0,l.jsx)(M.VU,{ellipsis:!0,content:t.owner,copyable:{tooltips:!1,text:t.owner},chain:p})}},{title:"持有数量(".concat(m.nftNumber,")"),dataIndex:"number",key:"number",hidden:d.number,sorter:function(e,t){return e.number-t.number},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.number})}},{title:"持有占比",dataIndex:"percent",key:"percent",hidden:d.percent,search:!1,render:function(e,t){return(0,l.jsxs)("div",{children:[t.percent.toFixed(2),"%"]})}},{title:"账号余额(".concat(L.toFixed(4),")"),dataIndex:"balance",key:"balance",hidden:d.balance,sorter:function(e,t){return e.balance-t.balance},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.balance/O.LAMPORTS_PER_SOL,6)})}},{title:"投入成本(".concat(C.toFixed(4),")"),dataIndex:"invest",key:"invest",hidden:d.invest,sorter:function(e,t){return e.invest-t.invest},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.invest/O.LAMPORTS_PER_SOL,6)})}},{title:"卖出利润(".concat(F.toFixed(4),")"),dataIndex:"profit",key:"profit",hidden:d.profit,sorter:function(e,t){return e.profit-t.profit},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profit/O.LAMPORTS_PER_SOL,6)})}},{title:I(),dataIndex:"fee",key:"fee",hidden:d.fee,sorter:function(e,t){return e.fee+e.tip-t.fee-t.tip},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)((t.fee+t.tip)/O.LAMPORTS_PER_SOL,6)})}},{title:"空投DFS(".concat((C/10).toFixed(2),")"),dataIndex:"invest",key:"airdrop",hidden:d.airdrop,sorter:function(e,t){return e.invest-t.invest},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:(t.invest/O.LAMPORTS_PER_SOL/10).toFixed(2)})}},{title:N(),dataIndex:"durable",key:"durable",hidden:d.durable,sorter:function(e,t){return e.durable-t.durable},search:!1,render:function(e,t){return(0,l.jsx)("div",{children:t.durable})}}]}),[g,w,F,w,m,L,d,p]),Z=(0,n.useMemo)((function(){return[{label:"key",key:"key"},{label:"持有者",key:"owner"},{label:"持有数量",key:"number"},{label:"持有占比",key:"percent"},{label:"账号余额",key:"balance"},{label:"投入成本",key:"invest"},{label:"卖出利润",key:"profit"},{label:"网络费SOL",key:"fee"},{label:"空投DFS",key:"airdrop"},{label:"抢图时长",key:"durable"}]}),[]),E=(0,n.useCallback)((function(e,t){("trigger"===t.source||e)&&i(e)}),[]),D=(0,n.useCallback)((function(e){d[e.key]?f(B()(B()({},d),{},H()({},e.key,!1))):f(B()(B()({},d),{},H()({},e.key,!0)))}),[d]),z=(0,n.useCallback)((function(t,r,n){return[(0,l.jsx)(K.Z,{menu:{items:Z,selectable:!0,multiple:!0,onClick:D},trigger:["click"],placement:"bottomRight",arrow:!0,onOpenChange:E,open:c,children:(0,l.jsx)(P.ZP,{type:"primary",children:(0,l.jsx)(U.Z,{})})},"filter"),n[1],(0,l.jsx)(P.ZP,{type:"primary",onClick:function(){e.handleCurrentProjectNfts(k.mintPubkey)},children:"更新"},"update"),n[0]]}),[e,k,Z,c,D]);return(0,l.jsxs)("div",{className:"ppp-tab-rank mt-3",children:[(0,l.jsx)("div",{className:"font-semibold text-base hardline ml-2",children:"持有者排名"}),(0,l.jsx)(j.Z,{loading:{spinning:S,size:"large"},scroll:{x:!0},size:"small",columns:A,dataSource:v,defaultData:[],search:{defaultCollapsed:!1,layout:"horizontal",labelWidth:"auto",collapseRender:!1,className:"p-[0px]",optionRender:z},onSubmit:V,onReset:_,options:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1})]})},ie=(0,n.memo)(ce);F().extend(N());var ue=function(){var e=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsGrowV2})),t=(0,y.useSelector)((function(e){return e.ppp.currentProjectDataSourceV2})),r=(0,y.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV2})),a=(0,n.useMemo)((function(){return t.secPerRound/3600+"小时"}),[t]),s=(0,n.useMemo)((function(){return t.profitRate.toFixed(2)+"%"}),[t]),c=(0,n.useMemo)((function(){return t.profitRateCreator.toFixed(1)+"%"}),[t]),i=(0,n.useMemo)((function(){return t.profitRateInviter.toFixed(1)+"%"}),[t]),u=(0,n.useMemo)((function(){return t.profitRatePlatform.toFixed(1)+"%"}),[t]),o=(0,n.useMemo)((function(){return(t.tradeFeeRate-t.profitRateCreator-t.profitRateInviter).toFixed(1)+"%"}),[t]),d=(0,n.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",render:function(e,t,r){return(0,l.jsx)("span",{children:r+1})}},{title:"轮次时间(".concat(a,")"),dataIndex:"roundLocalFormat",key:"roundLocalFormat",render:function(e,t){return(0,l.jsx)("div",{children:t.roundLocalFormat})}},{title:"NFT数量",dataIndex:"nftCount",key:"nftCount",render:function(e,t){return(0,l.jsx)("div",{children:t.nftCount})}},{title:"投入成本",dataIndex:"invest",key:"invest",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.invest/O.LAMPORTS_PER_SOL,2)})}},{title:"抢图利润(".concat(s,")"),dataIndex:"profitUser",key:"profitUser",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profitUser/O.LAMPORTS_PER_SOL)})}},{title:"创建者利润(".concat(c,")"),dataIndex:"profitCreator",key:"profitCreator",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profitCreator/O.LAMPORTS_PER_SOL)})}},{title:"邀请人利润(".concat(i,")"),dataIndex:"profitInviter",key:"profitInviter",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profitInviter/O.LAMPORTS_PER_SOL)})}},{title:"平台利润(".concat(u,")"),dataIndex:"profitPlatform",key:"profitPlatform",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profitPlatform/O.LAMPORTS_PER_SOL)})}},{title:"资金池(".concat(o,")"),dataIndex:"vaultSol",key:"vaultSol",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.vaultSol/O.LAMPORTS_PER_SOL)})}}]}),[a,s,c,i,u,o]);return(0,l.jsx)("div",{className:"ppp-tab-grow",children:(0,l.jsx)(j.Z,{loading:{spinning:r,size:"large"},scroll:{x:!0},size:"small",columns:d,dataSource:e,defaultData:[],options:!1,search:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1})})},le=(0,n.memo)(ue),oe=r(87603),de=r(38345),fe=function(){return(0,l.jsxs)(de.Z,{title:(0,l.jsx)("div",{className:" font-semibold text-lg hardline",children:"使用说明"}),style:{maxWidth:"400px"},children:[(0,l.jsx)("div",{className:"font-semibold mb-2",children:"1. 操作步骤："}),(0,l.jsxs)("div",{className:"ml-3 mb-2",children:["1） 连接钱包 ",(0,l.jsx)(oe.Z,{})," 打开“PPP-Nonce账号”页面 ",(0,l.jsx)(oe.Z,{})," 创建Nonce账号：根据你想要抢到图片的数量3-5倍来创建；"]}),(0,l.jsxs)("div",{className:"ml-3 mb-2",children:["2）打开“PPP-自动抢图”页面 ",(0,l.jsx)(oe.Z,{})," 在“创建交易”表单输入：项目，购买方式，购买数量，每张图GAS费用（表单其项按需输入） ",(0,l.jsx)(oe.Z,{})," 点击“运行”按钮 ",(0,l.jsx)(oe.Z,{})," 签名（无时间限制）；"]}),(0,l.jsxs)("div",{className:"ml-3 mb-2",children:["3）在“发送交易”表单，抢图会自动进行倒计时 ",(0,l.jsx)(oe.Z,{})," 等待倒计时结束即可，表单输入项按需调整，发送设备要保持前台活跃状态；"]}),(0,l.jsx)("div",{className:"ml-3 mb-2",children:"4）倒计时结束后会自动进行发送，发送完成后可点击“校对”按钮，检查抢到的图片数量。"}),(0,l.jsx)("div",{className:"font-semibold mb-2",children:"2. 注意事项："}),(0,l.jsx)("div",{className:"ml-3 mb-2",children:"1）只需在抢图前进行签名即可，无时间限制；"}),(0,l.jsx)("div",{className:"ml-3 mb-2",children:"2）不支持OK钱包，因为预检交易通不过，钱包不让提前签名；"}),(0,l.jsx)("div",{className:"ml-3 mb-2",children:"3）以账号余额来控制你想要抢到图片的数量上限，而不是以购买数量和Nonce账号数量，同时购买数量和Nonce账号数量需要远远大于你想要抢到的图片数量上限，这有利于提高成功率；"}),(0,l.jsx)("div",{className:"ml-3 mb-2",children:"3）Nonce账号的数量需要根据你一次性抢多少张图来决定，假如你想一次性抢10张，建议创建30-50个Nonce账号，数量不要超过当前NFT流通量即可，超过了也不影响；Nonce账号只需要创建一次，会重复使用，也可以随时进行删除回收；Nonce账号数量决定了当前账号抢图数量的上限，Nonce账号数量多一些，有利于提高抢图成功率；"}),(0,l.jsx)("div",{className:"ml-3 mb-2",children:"4）关于每张图GAS费用，费用越高，出块节点打包你交易的优先权也越高，抢图成功率就越大。交易失败，不会扣除任何费用。"}),(0,l.jsx)("div",{className:"font-semibold mb-2",children:"3. 费用说明："}),(0,l.jsx)("div",{className:"ml-3 mb-2",children:"有两种方式可选择"}),(0,l.jsx)("div",{className:"ml-3 mb-2",children:"1）免费：填写本工具的邀请码，工具会自动填入，无需手动操作；"}),(0,l.jsx)("div",{className:"ml-3 mb-2",children:"2）付费：按账号实际绑定的邀请码进行填写，无需手动操作。用户使用工具抢到的NFT，每个收取0.1%费用。例如工具抢到一个价值为0.1 SOL的NFT，则工具会收取0.0001 SOL作为费用，抢购成功了，才会收取。"})]})},pe=(0,n.memo)(fe),he=r(19632),ve=r.n(he),me=r(98165),xe=r(97269),be=r(64317),ke=r(31199),je=r(25054),ye=r(5966),Se=r(39678),ge=r(7134),Pe=r(48764).Buffer,we=function(){var e,t,r,a,c,i,u,o,d,f,h,m=(0,y.useIntl)(),k=m.formatMessage({id:"common.intlInputException"}),j=m.formatMessage({id:"common.intlPleaseConnectWallet"}),g=(0,y.useDispatch)(),P=S.ZP.useMessage(),w=s()(P,2),C=w[0],L=w[1],N=(0,n.useRef)(),M=(0,I.O)(),T=M.publicKey,z=M.signTransaction,q=M.signMessage,Y=M.wallet,H=(0,_.R)().connection,$=(0,V.z)(),B=(0,n.useState)(0),U=s()(B,2),K=U[0],W=U[1],G=(0,n.useState)(0),J=s()(G,2),Q=J[0],X=J[1],ee=(0,n.useState)(0),te=s()(ee,2),re=te[0],ne=te[1],ce=(0,n.useState)(!1),ie=s()(ce,2),ue=ie[0],le=ie[1],oe=(0,n.useState)(!1),fe=s()(oe,2),pe=fe[0],he=fe[1],we=(0,n.useState)(),Ce=s()(we,2),Fe=Ce[0],Le=Ce[1],Ne=(0,n.useState)([]),Me=s()(Ne,2),Re=Me[0],Oe=Me[1],Te=(0,n.useState)([]),Ie=s()(Te,2),Ve=Ie[0],_e=Ie[1],Ae=(0,n.useState)(0),Ze=s()(Ae,2),Ee=Ze[0],De=Ze[1],ze=(0,n.useState)(!1),qe=s()(ze,2),Ye=qe[0],He=qe[1],$e=(0,n.useState)(!1),Be=s()($e,2),Ue=Be[0],Ke=Be[1],We=(0,n.useState)(1),Ge=s()(We,2),Je=Ge[0],Qe=Ge[1],Xe=(0,n.useState)([]),et=s()(Xe,2),tt=et[0],rt=et[1],nt=(0,y.useSelector)((function(e){return e.ppp.projectsDataSourceV1})),at=(0,y.useSelector)((function(e){return e.wallet.tipAccounts})),st=(0,y.useSelector)((function(e){return e.ppp.vipAccounts})),ct=(0,n.useState)([]),it=s()(ct,2),ut=it[0],lt=it[1],ot=(0,n.useState)({}),dt=s()(ot,2),ft=dt[0],pt=dt[1],ht=(0,n.useState)([]),vt=s()(ht,2),mt=vt[0],xt=vt[1],bt=(0,n.useState)([]),kt=s()(bt,2),jt=kt[0],yt=kt[1],St=(0,n.useState)(0),gt=s()(St,2),Pt=gt[0],wt=gt[1],Ct=(0,n.useCallback)((function(){wt(0),yt([]),xt([]),De(0),Ke(!1),He(!1),Le(void 0),Oe([]),_e([])}),[]),Ft=(0,n.useCallback)((function(){var e,t,r=null===(e=N.current)||void 0===e?void 0:e.getFieldsValue(),n=Object.keys(r).filter((function(e){return"projectId"!==e}));null===(t=N.current)||void 0===t||t.resetFields(n),Ct()}),[]),Lt=(0,n.useCallback)((function(){var e;null===(e=N.current)||void 0===e||e.resetFields(),Ct()}),[]),Nt=(0,n.useMemo)((function(){var e=(0,R.uf)(K/O.LAMPORTS_PER_SOL,8,"SOL"),t=(0,R.uf)(K/O.LAMPORTS_PER_SOL*Q,6);return Q?"每张图GAS费用：".concat(e,"，$").concat(t," "):"每张图GAS费用：".concat(e)}),[K,Q]),Mt=(0,n.useMemo)((function(){var e=(0,R.uf)(re/O.LAMPORTS_PER_SOL,8,"SOL"),t=(0,R.uf)(re/O.LAMPORTS_PER_SOL*Q,6);return Q?"最小图片利润：".concat(e,"，$").concat(t):"最小图片利润：".concat(e)}),[K,Q]),Rt=(0,n.useCallback)((function(e,t){var r=[];if(1===e)r=t.toSorted((function(){return Math.random()-.5}));else if(2===e)r=t.toSorted((function(e,t){return e.price-t.price}));else if(3===e)r=t.toSorted((function(e,t){var r=e.price;return t.price-r}));else if(4===e)r=t.toSorted((function(e,t){return e.lastTradeLocalValue-t.lastTradeLocalValue}));else if(5===e)r=t.filter((function(e){return e.split}));else if(6===e){var n,a=null===(n=N.current)||void 0===n?void 0:n.getFieldValue("accounts");a=a||[],r=t.filter((function(e){return a.includes(e.ownerPubkey)}))}else if(7===e){var s,c=null===(s=N.current)||void 0===s?void 0:s.getFieldValue("accounts");c=c||[],(r=t.filter((function(e){return c.includes(e.ownerPubkey)}))).sort((function(){return Math.random()-.5}))}else if(8===e){var i,u=null===(i=N.current)||void 0===i?void 0:i.getFieldValue("nftIds");u=u||[],r=t.filter((function(e){return u.includes(e.nftId)}))}return _e(r),r}),[]),Ot=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r,n,a){var s,c,i,u,l,o,d,f,h,v,m,b,k,j,y,S;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n.buyCount,c=n.startNumber,i=n.endNumber,u=n.buyMode,l=Rt(u,a),!(c>l.length)){e.next=4;break}throw Error("开始序号超过当前项目最大值".concat(l.length));case 4:if(!i){e.next=11;break}if(!(c>i)){e.next=7;break}throw Error("开始序号超过结束序号");case 7:o=l.length>i?i:l.length,l=l.slice(c-1,o),e.next=12;break;case 11:l=l.slice(c-1);case 12:return d=function(e){var t,n=0,a=x()(e);try{for(a.s();!(t=a.n()).done;){if(t.value.ownerPubkey!==r.toString()){if(n>=s)return n;if(n>=1e3)return n;n+=1}}}catch(e){a.e(e)}finally{a.f()}return n},f=d(l),"#####NonceCountAccount#####",e.next=17,O.PublicKey.createWithSeed(r,"#####NonceCountAccount#####",O.SystemProgram.programId);case 17:return h=e.sent,e.next=20,t.getAccountInfo(h);case 20:if(v=e.sent,m=[],b=[],k=0,v){e.next=26;break}throw Error("请先创建Nonce账号");case 26:if(k=(0,D.sT)(v.lamports),!(f>k)){e.next=29;break}throw Error("Nonce账号数量不足，需要大于等于图片购买数量");case 29:j=0;case 30:if(!(j<k)){e.next=40;break}return y="#####NonceAccount".concat(j+1,"#####"),e.next=35,O.PublicKey.createWithSeed(r,y,O.SystemProgram.programId);case 35:S=e.sent,m.push(S);case 37:++j,e.next=30;break;case 40:if(!m.length){e.next=45;break}return e.next=43,t.getMultipleParsedAccounts(m);case 43:e.sent.value.forEach((function(e,t){b.push({key:t,nonceAccount:m[t],authority:new O.PublicKey(e.data.parsed.info.authority),blockhash:e.data.parsed.info.blockhash,status:e.data.parsed.type})}));case 45:return e.abrupt("return",{nonceAccounts:m,nonceAccountsData:b,nftsDataSource:l});case 46:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),[]),Tt=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t){var r,n,a,s,c,i,u,l,o,d,f,h,v,m,b,k,j,y,S,g,P,w,C,F,L,N,M,R,T,I,V,_,z,q,Y;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.connection,n=t.payer,a=t.anchorWallet,s=t.signMessage,c=t.signTransaction,i=t.nftsDataSource,u=t.formData,l=t.nonceAccounts,o=t.nonceAccountsData,d=t.currentProjectDataSource,f=t.tipAccounts,h=t.tipFee,v=0,m=0,b=0,k=[],j=u.buyCount,y=u.payMode,e.next=8,(0,A.vo)(n.toString(),s);case 8:S=e.sent,g=S.user,P=g.referral,w=new Z.$r(E,new Z.Y7(r,a,Z.Y7.defaultOptions())),C=x()(i),e.prev=13,C.s();case 15:if((F=C.n()).done){e.next=48;break}if(L=F.value,L.ownerPubkey!==n.toString()){e.next=20;break}return e.abrupt("continue",46);case 20:if(!(v>=j)){e.next=22;break}return e.abrupt("break",48);case 22:return v+=1,(N=[]).push(O.SystemProgram.nonceAdvance({noncePubkey:o[b].nonceAccount,authorizedPubkey:o[b].authority})),N.push(O.ComputeBudgetProgram.setComputeUnitLimit({units:132284})),M=L.nftPubkey,R=L.ownerPubkey,T=n,I=P,e.next=32,(0,A.zt)({program:w,nftPubkey:M,currentOwnerPubkey:R,payerPubkey:T,currentProjectDataSource:d,userReferral:I,payMode:y});case 32:return V=e.sent,N.push(V),2===y&&P&&(_=Number((.001*L.price).toFixed(0)),N.push(O.SystemProgram.transfer({fromPubkey:n,toPubkey:new O.PublicKey("56d6qq9KAWcuUAHqPCK5yQAZ9PT5vqdCedJLiA5WaGgQ"),lamports:_}))),N.push(O.SystemProgram.transfer({fromPubkey:n,toPubkey:new O.PublicKey(f[m]),lamports:h<1e3?1e3:Number(h.toFixed(0))})),z=new O.TransactionMessage({payerKey:n,recentBlockhash:o[b].blockhash,instructions:N}).compileToLegacyMessage(),q=new O.VersionedTransaction(z),(0,D.hU)(q),e.next=41,c(q);case 41:Y=e.sent,k.push({instructions:N,transaction:Y,transactionBase64:Pe.from(Y.serialize()).toString("base64"),nft:L,tipFee:h,referral:P}),b=(b+1)%l.length,m=(m+1)%f.length,De(v);case 46:e.next=15;break;case 48:e.next=53;break;case 50:e.prev=50,e.t0=e.catch(13),C.e(e.t0);case 53:return e.prev=53,C.f(),e.finish(53);case 56:return e.abrupt("return",k);case 57:case"end":return e.stop()}}),e,null,[[13,50,53,56]])})));return function(t){return e.apply(this,arguments)}}(),[]),It=(0,n.useCallback)((function(e,t,r,n,a){var s,c,i=0,u=t.projectId,l=t.splitCount,o=n.tokenSymbol,d=n.nextRoundLocalFormat,f=r.length,p=e.toString(),h=(0,R.uf)(r[0].tipFee/O.LAMPORTS_PER_SOL,8,"SOL"),v=r[0].referral;r.forEach((function(e){i+=e.nft.price}));for(var m=a.includes(p)?(0,R.uf)(i/O.LAMPORTS_PER_SOL,8,"SOL"):(0,R.uf)(1.001*i/O.LAMPORTS_PER_SOL,8,"SOL"),x=F()().format("YYYY-MM-DDTHH:mm:ss"),b=Math.ceil(r.length/l),k=1,j=function(){var e=0,s=[],c=r.splice(0,b),i=c.length;c.forEach((function(t){s.push(t.nft.nftId),e+=t.nft.price}));var f=a.includes(p)?(0,R.uf)(e/O.LAMPORTS_PER_SOL,8,"SOL"):(0,R.uf)(1.001*e/O.LAMPORTS_PER_SOL,8,"SOL");s.sort((function(e,t){return e-t}));var m={projectId:u,instruction:"buy",totalTxCount:i,totalAmount:f,tipFee:h,referral:v,tokenSymbol:o,from:p,startNftId:s[0],endNftId:s[s.length-1],nftIds:s,nextRoundLocalFormat:d,formData:t,currentProjectDataSource:n,transactions:c},j=JSON.stringify(m,null,2),y="data:,".concat(j),S=document.createElement("a");S.href=y,S.download=1===l||1===b?"".concat(o,"_").concat(u.slice(0,4),"_").concat(u.slice(-4),"_").concat(i,"_").concat(x,"_buy.json"):"".concat(o,"_").concat(u.slice(0,4),"_").concat(u.slice(-4),"_").concat(i,"_part").concat(k++,"_").concat(x,"_buy.json"),S.click()};r.length;)j();null===(s=N.current)||void 0===s||s.setFieldValue("totalAmountCreate",m),null===(c=N.current)||void 0===c||c.setFieldValue("totalTxCount",f),C.success("创建完成")}),[]),Vt=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t){var r,n,a,s,c;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Y&&T&&z&&$&&q&&Fe){e.next=4;break}return C.error(j),e.abrupt("return",!0);case 4:if("Simple Wallet"===Y.adapter.name){e.next=7;break}return C.error("只支持Simple Wallet"),e.abrupt("return",!0);case 7:return e.next=9,Ot(H,T,t,Re);case 9:return r=e.sent,n=r.nonceAccounts,a=r.nonceAccountsData,s=r.nftsDataSource,e.next=15,Tt({connection:H,payer:T,anchorWallet:$,signMessage:q,signTransaction:z,nftsDataSource:s,formData:t,nonceAccounts:n,nonceAccountsData:a,currentProjectDataSource:Fe,tipAccounts:at,tipFee:K});case 15:if((c=e.sent).length){e.next=19;break}return C.info("没有需要创建的内容"),e.abrupt("return",!0);case 19:It(T,t,c,Fe,st),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(0),De(0),(0,R.Tv)(e.t0,C,"handleFinish");case 26:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(t){return e.apply(this,arguments)}}(),[K,T,Y,z,$,q,Fe,Re,H,at,st]),_t=(0,n.useCallback)((function(e,t,r,n){var a=Math.min.apply(Math,ve()(e.map((function(e){return e.profit})))),s=0;1===r?s=a*t/100:2===r?s=n[t]*O.LAMPORTS_PER_SOL:3===r&&(s=(s=Number(t)*O.LAMPORTS_PER_SOL)<1e3?1e3:s),W(s),ne(a)}),[]),At=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r){var n,a,s,c,i,u,o,d,f,h,v,m,x,b,k,j,y,S,g;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,he(!0),a={},e.next=5,(0,A.HF)();case 5:return s=e.sent,c=function(e){return(0,R.uf)(Math.max(e,1e-6),8,"SOL")},i=function(e){return"$"+(0,R.uf)(Math.max(e,1e-6)*r,6)},a["25th"]=s.landed_tips_25th_percentile,a["50th"]=s.landed_tips_50th_percentile,a["50th_ema"]=s.ema_landed_tips_50th_percentile,a["75th"]=s.landed_tips_75th_percentile,a["95th"]=s.landed_tips_95th_percentile,a["99th"]=s.landed_tips_99th_percentile,u={"25th":{sol:"",usd:""},"50th":{sol:"",usd:""},"50th_ema":{sol:"",usd:""},"75th":{sol:"",usd:""},"95th":{sol:"",usd:""},"99th":{sol:"",usd:""}},o=c(a["25th"]),d=c(a["50th"]),f=c(a["50th_ema"]),h=c(a["75th"]),v=c(a["95th"]),m=c(a["99th"]),x=i(a["25th"]),b=i(a["50th"]),k=i(a["50th_ema"]),j=i(a["75th"]),y=i(a["95th"]),S=i(a["99th"]),u["25th"]={sol:o,usd:x},u["50th"]={sol:d,usd:b},u["50th_ema"]={sol:f,usd:k},u["75th"]={sol:h,usd:j},u["95th"]={sol:v,usd:y},u["99th"]={sol:m,usd:S},(g=[]).push({value:"25th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"25%"}),(0,l.jsx)("div",{children:c(a["25th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["25th"])})})]})}),g.push({value:"50th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"50%"}),(0,l.jsx)("div",{children:c(a["50th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["50th"])})})]})}),g.push({value:"50th_ema",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"50% EMA"}),(0,l.jsx)("div",{children:c(a["50th_ema"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["50th_ema"])})})]})}),g.push({value:"75th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"75%"}),(0,l.jsx)("div",{children:c(a["75th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["75th"])})})]})}),g.push({value:"95th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"95%"}),(0,l.jsx)("div",{children:c(a["95th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["95th"])})})]})}),g.push({value:"99th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"99%"}),(0,l.jsx)("div",{children:c(a["99th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["99th"])})})]})}),pt(a),lt(g),he(!1),null===(n=N.current)||void 0===n||n.setFieldValue("tipFeeCreate","50th_ema"),_t(t,"50th_ema",2,a),e.abrupt("return",{levels:a,tipFeeCreate:"50th_ema"});case 48:e.prev=48,e.t0=e.catch(0),he(!1),(0,R.Tv)(e.t0,C,"handleUpdateTipFee");case 52:case"end":return e.stop()}}),e,null,[[0,48]])})));return function(t,r){return e.apply(this,arguments)}}(),[]),Zt=(0,n.useCallback)((function(e,t){var r,n=null===(r=N.current)||void 0===r?void 0:r.getFieldsValue(),a=n.buyMode,s=n.tipFeeCreate,c=n.tipMode,i=Rt(a,e);return _t(i,s,c,t),wt(i.length),i.length}),[]),Et=(0,n.useCallback)((function(e){var t=new Set;e.forEach((function(e){t.add(e.ownerPubkey)}));var r=Array.from(t),n=[];r.forEach((function(e){n.push({value:e,label:(0,l.jsx)(Se.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:e})})})),xt(n)}),[]),Dt=(0,n.useCallback)((function(e){var t=[];e.forEach((function(e){t.push({value:e.nftId,label:(0,l.jsxs)("div",{className:"grid grid-cols-2",children:[(0,l.jsxs)("div",{children:["#",e.nftId]}),(0,l.jsx)(Se.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:e.ownerPubkey})]})})})),t.sort((function(e,t){return e.value-t.value})),yt(t)}),[]),zt=(0,n.useCallback)((function(e,t){var r,n,a,s,c=(null===(r=N.current)||void 0===r?void 0:r.getFieldsValue()).buyMode;6===c||7===c?(He(!0),Et(e)):(He(!1),xt([]),null===(a=N.current)||void 0===a||a.setFieldValue("accounts",void 0));8===c?(Ke(!0),Dt(e)):(Ke(!1),yt([]),null===(s=N.current)||void 0===s||s.setFieldValue("nftIds",void 0));Zt(e,t),null===(n=N.current)||void 0===n||n.resetFields(["buyCount","startNumber","endNumber"])}),[]),qt=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r){var n,a,s,c,i,u;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,le(!0),a=null===(n=N.current)||void 0===n?void 0:n.getFieldsValue(),s=a.projectId,Ft(),c=t.find((function(e){return e.mintPubkey===s})),e.next=7,(0,A.LE)(s,c);case 7:i=e.sent,u=i.currentProjectNftsDataSource,Zt(u,r),Oe(u),Le(c),le(!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),le(!1),(0,R.Tv)(e.t0,C,"handleCurrentProjectNfts");case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,r){return e.apply(this,arguments)}}(),[]),Yt=(0,n.useCallback)((function(e,t){var r,n,a=Zt(e,t);a?null===(r=N.current)||void 0===r||r.setFieldValue("buyCount",a):null===(n=N.current)||void 0===n||n.setFieldValue("buyCount",void 0)}),[]),Ht=(0,n.useCallback)((function(e,t){var r,n,a=Zt(e,t);a?null===(r=N.current)||void 0===r||r.setFieldValue("buyCount",a):null===(n=N.current)||void 0===n||n.setFieldValue("buyCount",void 0)}),[]),$t=(0,n.useCallback)((function(e,t){var r,n=null===(r=N.current)||void 0===r?void 0:r.getFieldsValue(),a=n.tipFeeCreate,s=n.tipMode;_t(e,a,s,t)}),[]),Bt=(0,n.useCallback)((function(e,t,r){var n,a=(null===(n=N.current)||void 0===n?void 0:n.getFieldsValue()).tipMode;if(1===a){var s;null===(s=N.current)||void 0===s||s.setFieldValue("tipFeeCreate",.1),_t(e,.1,a,t)}else if(2===a)At(e,r);else if(3===a){var c,i="0.000001";null===(c=N.current)||void 0===c||c.setFieldValue("tipFeeCreate",i),_t(e,i,a,t)}Qe(a)}),[]),Ut=(0,n.useCallback)((function(e){e.projectId&&qt(nt,ft),e.buyMode&&zt(Re,ft),e.nftIds&&Yt(Re,ft),e.accounts&&Ht(Re,ft),e.tipMode&&Bt(Re,ft,Q),e.tipFeeCreate&&$t(Ve,ft)}),[nt,Re,Pt,Ve,ft,Q]),Kt=(0,n.useCallback)((function(e){var t=[];e.forEach((function(e){var r=e.nftIssueCount,n=e.nftBurnCount;if(0!==e.round&&r!==n){var a=e.nftImageUrl,s=e.tokenSymbol,c=e.projectName,i=e.mintPubkey;t.push({value:i,label:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(ge.C,{className:"mr-2",size:"default",src:a}),(0,l.jsx)("div",{children:"".concat(s," - ").concat(c)})]}),(0,l.jsx)(Se.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:i})]}),nftImageUrl:a,projectName:c,tokenSymbol:s,mintPubkey:i})}})),rt(t)}),[]),Wt=(0,n.useCallback)(v()(p()().mark((function e(){var t,r,n,a;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,le(!0),e.next=4,(0,A.p5)();case 4:return t=e.sent,r=t.projects,n=t.projectsDataSource,e.next=9,(0,R.o8)();case 9:a=e.sent,Kt(n),X(a),g(b.N.setProjectsV1(r)),g(b.N.setProjectsDataSourceV1(n)),le(!1),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),le(!1),(0,R.Tv)(e.t0,C,"handleProjects");case 21:case"end":return e.stop()}}),e,null,[[0,17]])}))),[]);return(0,n.useEffect)((function(){Wt()}),[]),(0,l.jsxs)(de.Z,{title:(0,l.jsx)("div",{className:"font-semibold text-lg hardline",children:"创建交易"}),style:{width:"400px"},children:[(0,l.jsxs)(xe.A,{formRef:N,onFinish:Vt,onValuesChange:Ut,onReset:Lt,layout:"vertical",initialValues:{buyMode:1,startNumber:1,tipFeeCreate:.1,payMode:1,tipMode:1,splitCount:1},submitter:{searchConfig:{submitText:"创建"},render:function(e,t){return[t[1],t[0],(0,l.jsx)("div",{children:Ee||""},"sign")]}},children:[(0,l.jsx)(be.Z,{name:"projectId",label:(0,l.jsxs)("div",{children:["项目",(0,l.jsx)(me.Z,{spin:ue,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:Wt})]}),options:tt,placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(k),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,filterOption:function(e,t){return(t.projectName+t.tokenSymbol).toLowerCase().includes(e.toLowerCase())},optionItemRender:function(e){var t=e.projectName,r=e.tokenSymbol,n=e.nftImageUrl,a=e.mintPubkey;return(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(ge.C,{className:"mr-2",size:"default",src:n}),(0,R.Mn)()?(0,l.jsx)("div",{children:"".concat(r)}):(0,l.jsx)("div",{children:"".concat(r," - ").concat((0,R.LH)(t))})]}),(0,l.jsx)(Se.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]})}}}),(0,l.jsx)(be.Z,{name:"buyMode",label:"购买方式",options:[{value:1,label:"1 随机"},{value:2,label:"2 价格低到高"},{value:3,label:"3 价格高到低"},{value:4,label:"4 时间优先"},{value:5,label:"5 只抢拆分"},{value:6,label:"6 指定账号(顺序)"},{value:7,label:"7 指定账号(随机)"},{value:8,label:"8 指定序号"}],rules:[{required:!0,whitespace:!0,message:"".concat(k),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,disabled:!(null!==(e=N.current)&&void 0!==e&&e.getFieldValue("projectId"))}}),!!Ye&&(0,l.jsx)(be.Z,{name:"accounts",label:"选择账号",options:mt,fieldProps:{mode:"multiple",disabled:!(null!==(t=N.current)&&void 0!==t&&t.getFieldValue("projectId"))},placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(k),pattern:/^.+$/}]}),!!Ue&&(0,l.jsx)(be.Z,{name:"nftIds",label:"选择序号",options:jt,fieldProps:{mode:"multiple",disabled:!(null!==(r=N.current)&&void 0!==r&&r.getFieldValue("projectId"))},placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(k),pattern:/^.+$/}]}),(0,l.jsx)(ke.Z,{name:"buyCount",label:(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{children:"购买数量 "}),(0,l.jsx)("span",{className:"hover:cursor-pointer",style:{color:"#1677ff"},onClick:function(){var e,t;null===(e=N.current)||void 0===e||e.setFieldValue("buyCount",Pt),null===(t=N.current)||void 0===t||t.validateFields(["buyCount"])},children:Pt?"(".concat(Pt,")"):""})]}),placeholder:"",min:1,max:Pt,rules:[{required:!0,message:"".concat(k),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",disabled:!(null!==(a=N.current)&&void 0!==a&&a.getFieldValue("projectId"))}}),(0,l.jsx)(ke.Z,{name:"startNumber",label:(0,l.jsxs)("div",{children:["开始序号#",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"从具体某个序号开始进行购买",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"",min:1,rules:[{required:!0,message:"".concat(k),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",disabled:!(null!==(c=N.current)&&void 0!==c&&c.getFieldValue("projectId"))}}),(0,l.jsx)(ke.Z,{name:"endNumber",label:(0,l.jsxs)("div",{children:["结束序号#",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"只购买当前序号之前的NFT",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"可选，默认是当前序号的最大值",min:1,rules:[{required:!1,message:"".concat(k),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",disabled:!(null!==(i=N.current)&&void 0!==i&&i.getFieldValue("projectId"))}}),(0,l.jsx)(be.Z,{name:"tipMode",label:"GAS费用输入方式",options:[{value:1,label:"利润百分比"},{value:2,label:"实时Tip费用"},{value:3,label:"手动输入"}],rules:[{required:!0,whitespace:!0,message:"".concat(k),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,disabled:!(null!==(u=N.current)&&void 0!==u&&u.getFieldValue("projectId"))}}),1===Je?(0,l.jsx)(je.Z,{name:"tipFeeCreate",label:Nt,min:.1,max:20,step:.1,fieldProps:{tooltip:{formatter:function(e){return"".concat(e,"%")}},disabled:!(null!==(o=N.current)&&void 0!==o&&o.getFieldValue("projectId"))},rules:[{required:!0,whitespace:!0,message:"".concat(k),pattern:/^.*$/}],help:(0,l.jsx)("div",{className:"text-red-600 mb-5",children:Mt})}):null,2===Je?(0,l.jsx)(be.Z,{name:"tipFeeCreate",label:(0,l.jsxs)("div",{children:["每张图GAS费用",(0,l.jsx)(me.Z,{spin:pe,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:function(){return At(Re,Q)}})]}),options:ut,placeholder:"",rules:[{required:!0,whitespace:!0,message:"输入异常",pattern:/^.*$/}],fieldProps:{size:"large",autoFocus:!1},help:(0,l.jsx)("div",{className:"text-red-600 mb-5",children:Mt})}):null,3===Je?(0,l.jsx)(ye.Z,{name:"tipFeeCreate",label:Nt,placeholder:"至少为0.000001 SOL",rules:[{required:!0,message:"".concat(k),whitespace:!0,pattern:/^\d+(\.\d{1,8})?$/}],fieldProps:{size:"large",autoFocus:!1},help:(0,l.jsx)("div",{className:"text-red-600 mb-5",children:Mt})}):null,(0,l.jsx)(be.Z,{name:"payMode",label:"工具费用",options:[{value:1,label:"免费"},{value:2,label:"0.3%"}],rules:[{required:!0,whitespace:!0,message:"".concat(k),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,disabled:!(null!==(d=N.current)&&void 0!==d&&d.getFieldValue("projectId"))}}),(0,l.jsx)(ke.Z,{name:"splitCount",label:(0,l.jsxs)("div",{children:["交易文件数量",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"将所有交易分配在多个文件进行保存，可方便在多个设备上进行发送",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"",min:1,rules:[{required:!0,message:"".concat(k),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1}}),(0,l.jsx)(ye.Z,{name:"totalAmountCreate",label:(0,l.jsxs)("div",{children:["交易总金额",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"此次全部交易所需要的总金额，包含手续费。",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0,disabled:!(null!==(f=N.current)&&void 0!==f&&f.getFieldValue("projectId"))}}),(0,l.jsx)(ye.Z,{name:"totalTxCount",label:"交易总笔数",placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0,disabled:!(null!==(h=N.current)&&void 0!==h&&h.getFieldValue("projectId"))}})]}),L]})},Ce=(0,n.memo)(we),Fe=r(84567),Le=r(20640),Ne=r.n(Le),Me=r(48764).Buffer,Re=47258,Oe=function(e){var t,r,a,c,i,u,o,d,f,h,m=e.autoSweepSendRef,k=(0,y.useIntl)(),j=k.formatMessage({id:"common.intlInputException"}),g=k.formatMessage({id:"common.intlPleaseConnectWallet"}),w=(0,y.useDispatch)(),C=S.ZP.useMessage(),L=s()(C,2),N=L[0],M=L[1],T=(0,n.useRef)(),E=(0,I.O)(),z=E.publicKey,q=E.signAllTransactions,Y=E.signMessage,H=E.wallet,$=(0,_.R)().connection,B=(0,V.z)(),U=(0,n.useState)(0),K=s()(U,2),G=K[0],J=K[1],Q=(0,n.useState)(0),X=s()(Q,2),ee=X[0],te=X[1],re=(0,n.useState)(0),ne=s()(re,2),ce=ne[0],ie=ne[1],ue=(0,n.useState)(0),le=s()(ue,2),oe=le[0],fe=le[1],pe=(0,n.useState)(!1),he=s()(pe,2),Pe=he[0],we=he[1],Ce=(0,n.useState)(!1),Le=s()(Ce,2),Oe=Le[0],Te=Le[1],Ie=(0,n.useState)(),Ve=s()(Ie,2),_e=Ve[0],Ae=Ve[1],Ze=(0,n.useState)([]),Ee=s()(Ze,2),De=Ee[0],ze=Ee[1],qe=(0,n.useState)([]),Ye=s()(qe,2),He=Ye[0],$e=Ye[1],Be=(0,n.useState)(0),Ue=s()(Be,2),Ke=Ue[0],We=Ue[1],Ge=(0,n.useState)(!1),Je=s()(Ge,2),Qe=Je[0],Xe=Je[1],et=(0,n.useState)(!1),tt=s()(et,2),rt=tt[0],nt=tt[1],at=(0,n.useState)(2),st=s()(at,2),ct=st[0],it=st[1],ut=(0,n.useState)(!0),lt=s()(ut,2),ot=lt[0],dt=lt[1],ft=(0,n.useState)(),pt=s()(ft,2),ht=pt[0],vt=pt[1],mt=(0,n.useState)([]),xt=s()(mt,2),bt=xt[0],kt=xt[1],jt=(0,y.useSelector)((function(e){return e.ppp.projectsDataSourceV2})),yt=(0,y.useSelector)((function(e){return e.wallet.tipAccounts})),St=(0,y.useSelector)((function(e){return e.ppp.vipAccounts})),gt=(0,n.useState)([]),Pt=s()(gt,2),wt=Pt[0],Ct=Pt[1],Ft=(0,n.useState)({}),Lt=s()(Ft,2),Nt=Lt[0],Mt=Lt[1],Rt=(0,n.useState)([]),Ot=s()(Rt,2),Tt=Ot[0],It=Ot[1],Vt=(0,n.useState)({}),_t=s()(Vt,2),At=_t[0],Zt=_t[1],Et=(0,n.useState)([{key:0,nonceAccount:new O.PublicKey("Cym5m3Qp1r5SjCN5SfAkzLRYUJMVFz8YQWT3ZhQVwoyV"),authority:new O.PublicKey("Cym5m3Qp1r5SjCN5SfAkzLRYUJMVFz8YQWT3ZhQVwoyV"),blockhash:"EE2TvkTVGGKiGxvatGvWaxzF7qqeEERsrsrLjd8r7geM",status:""}]),Dt=s()(Et,2),zt=Dt[0],qt=Dt[1],Yt=(0,n.useState)([]),Ht=s()(Yt,2),$t=Ht[0],Bt=Ht[1],Ut=(0,n.useState)([]),Kt=s()(Ut,2),Wt=Kt[0],Gt=Kt[1],Jt=(0,n.useState)(0),Qt=s()(Jt,2),Xt=Qt[0],er=Qt[1],tr=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r){var n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,D.JH)(t,r);case 2:n=e.sent,n.length&&qt(n);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[]),rr=(0,n.useMemo)((function(){if($){if(B)return new Z.$r(W,new Z.Y7($,B,Z.Y7.defaultOptions()));var e={publicKey:new O.PublicKey("Cym5m3Qp1r5SjCN5SfAkzLRYUJMVFz8YQWT3ZhQVwoyV")};return new Z.$r(W,new Z.Y7($,e,Z.Y7.defaultOptions()))}return null}),[$,B]),nr=(0,n.useCallback)((function(){er(0),Gt([]),Bt([]),We(0),nt(!1),Xe(!1),Ae(void 0),ze([]),$e([]),vt(void 0),it(2),dt(!0),J(0),te(0)}),[]),ar=(0,n.useCallback)((function(){var e,t,r=null===(e=T.current)||void 0===e?void 0:e.getFieldsValue(),n=Object.keys(r).filter((function(e){return"projectId"!==e}));null===(t=T.current)||void 0===t||t.resetFields(n),nr()}),[]),sr=(0,n.useCallback)((function(){var e;null===(e=T.current)||void 0===e||e.resetFields(),nr()}),[]),cr=(0,n.useMemo)((function(){var e=(0,R.uf)(G/O.LAMPORTS_PER_SOL,8,"SOL"),t=(0,R.uf)(G/O.LAMPORTS_PER_SOL*ce,6);return ce?"每张图GAS费用：".concat(e,"，$").concat(t," "):"每张图GAS费用：".concat(e)}),[G,ce]),ir=(0,n.useMemo)((function(){var e=(0,R.uf)(ee/O.LAMPORTS_PER_SOL,8,"SOL"),t=(0,R.uf)(ee/O.LAMPORTS_PER_SOL*ce,6);return ce?"每张图GAS费用：".concat(e,"，$").concat(t," "):"每张图GAS费用：".concat(e)}),[ee,ce]),ur=(0,n.useMemo)((function(){var e=(0,R.uf)(oe/O.LAMPORTS_PER_SOL,8,"SOL"),t=(0,R.uf)(oe/O.LAMPORTS_PER_SOL*ce,6);return ce?"最小图片利润：".concat(e,"，$").concat(t):"最小图片利润：".concat(e)}),[oe,ce]),lr=(0,n.useCallback)((function(e,t){var r=[];if(1===e)r=t.toSorted((function(){return Math.random()-.5}));else if(2===e)r=t.toSorted((function(e,t){return e.price-t.price}));else if(3===e)r=t.toSorted((function(e,t){var r=e.price;return t.price-r}));else if(4===e)r=t.toSorted((function(e,t){return e.lastTradeLocalValue-t.lastTradeLocalValue}));else if(5===e)r=t.filter((function(e){return e.split}));else if(6===e)r=t.filter((function(e){return!e.split})).sort((function(){return Math.random()-.5}));else if(7===e){var n,a=null===(n=T.current)||void 0===n?void 0:n.getFieldValue("accounts");a=a||[],r=t.filter((function(e){return a.includes(e.ownerPubkey)}))}else if(8===e){var s,c=null===(s=T.current)||void 0===s?void 0:s.getFieldValue("accounts");c=c||[],(r=t.filter((function(e){return c.includes(e.ownerPubkey)}))).sort((function(){return Math.random()-.5}))}else if(9===e){var i,u=null===(i=T.current)||void 0===i?void 0:i.getFieldValue("nftIds");u=u||[],r=t.filter((function(e){return u.includes(e.nftId)}))}return $e(r),r}),[]),or=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r,n,a){var s,c,i,u,l,o,d;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n.startNumber,c=n.endNumber,i=n.buyMode,u=lr(i,a),!(s>u.length)){e.next=4;break}throw Error("开始序号超过当前项目最大值".concat(u.length));case 4:if(!c){e.next=11;break}if(!(s>c)){e.next=7;break}throw Error("开始序号超过结束序号");case 7:l=u.length>c?c:u.length,u=u.slice(s-1,l),e.next=12;break;case 11:u=u.slice(s-1);case 12:return o=[],e.next=15,(0,D.JH)(t,r);case 15:if((d=e.sent).forEach((function(e){o.push(e.nonceAccount)})),d.length){e.next=20;break}throw Error("请先创建Nonce账号");case 20:return e.abrupt("return",{nonceAccounts:o,nonceAccountsData:d,nftsDataSource:u});case 21:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),[]),dr=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t){var r,n,a,s,c,i,u,l,o,d,f,h,v,m,b,k,j,y,S,g,P,w,C,F,L,N,M,R,T,I,V,_,E,z,q,Y,H,$,B;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.connection,n=t.wallet,a=t.payer,s=t.anchorWallet,c=t.signMessage,i=t.signAllTransactions,u=t.nftsDataSource,l=t.formData,o=t.nonceAccounts,d=t.nonceAccountsData,f=t.currentProjectDataSource,h=t.tipAccounts,v=t.tipFee,m=t.priorityFee,b=0,k=0,j=0,y=[],S=l.buyCount,g=l.payMode,P=l.feeMode,e.next=8,(0,A.qj)(a.toString(),c);case 8:w=e.sent,C=w.user,F=C.referral,L=new Z.$r(W,new Z.Y7(r,s,Z.Y7.defaultOptions())),N=x()(u),e.prev=13,N.s();case 15:if((M=N.n()).done){e.next=43;break}if(R=M.value,!(b>=S)){e.next=19;break}return e.abrupt("break",43);case 19:return b+=1,(T=[]).push(O.SystemProgram.nonceAdvance({noncePubkey:d[j].nonceAccount,authorizedPubkey:d[j].authority})),T.push(O.ComputeBudgetProgram.setComputeUnitLimit({units:Re})),1===P||2===P||3===P?"Simple Wallet"!==n.adapter.name&&T.push(O.ComputeBudgetProgram.setComputeUnitPrice({microLamports:0})):4!==P&&5!==P&&6!==P||(I=Math.ceil(m/Re*1e6),T.push(O.ComputeBudgetProgram.setComputeUnitPrice({microLamports:I}))),V=R.nftPubkey,_=R.ownerPubkey,E=a,z=F,e.next=30,(0,A.G4)({program:L,nftPubkey:V,currentOwnerPubkey:_,payerPubkey:E,currentProjectDataSource:f,userReferral:z,payMode:g});case 30:q=e.sent,T.push(q),2===g&&F&&(Y=Number((.001*R.price).toFixed(0)),T.push(O.SystemProgram.transfer({fromPubkey:a,toPubkey:new O.PublicKey("56d6qq9KAWcuUAHqPCK5yQAZ9PT5vqdCedJLiA5WaGgQ"),lamports:Y}))),!v||1!==P&&2!==P&&3!==P||T.push(O.SystemProgram.transfer({fromPubkey:a,toPubkey:new O.PublicKey(h[k]),lamports:v<1e3?1e3:Number(v.toFixed(0))})),H=new O.TransactionMessage({payerKey:a,recentBlockhash:d[j].blockhash,instructions:T}).compileToLegacyMessage(),$=new O.VersionedTransaction(H),(0,D.hU)($),y.push({instructions:T,transaction:$,transactionBase64:"",nft:R,tipFee:v,priorityFee:m,referral:F}),j=(j+1)%o.length,k=(k+1)%h.length,We(b);case 41:e.next=15;break;case 43:e.next=48;break;case 45:e.prev=45,e.t0=e.catch(13),N.e(e.t0);case 48:return e.prev=48,N.f(),e.finish(48);case 51:return B=y.map((function(e){return e.transaction})),e.next=54,i(B);case 54:return e.sent.forEach((function(e,t){y[t].transaction=e,y[t].transactionBase64=Me.from(e.serialize()).toString("base64")})),e.abrupt("return",y);case 57:case"end":return e.stop()}}),e,null,[[13,45,48,51]])})));return function(t){return e.apply(this,arguments)}}(),[]),fr=(0,n.useCallback)((function(e,t,r,n,a,s){var c,i,u=0,l=t.projectId,o=t.splitCount,d=t.feeMode,f=n.tokenSymbol,p=n.nextRoundLocalFormat,h=r.length,v=a.length,m=e.toString(),x=r[0].referral,b="",k="";1===d||2===d||3===d?b=(0,R.uf)(r[0].tipFee/O.LAMPORTS_PER_SOL,8,"SOL"):k=(0,R.uf)(r[0].priorityFee/O.LAMPORTS_PER_SOL,8,"SOL"),r.forEach((function(e){u+=e.nft.price}));for(var j=s.includes(m)?(0,R.uf)(u/O.LAMPORTS_PER_SOL,8,"SOL"):(0,R.uf)(1.001*u/O.LAMPORTS_PER_SOL,8,"SOL"),y=F()().format("YYYY-MM-DDTHH:mm:ss"),S=Math.ceil(r.length/o),g=1,P=function(){var e=0,a=[],c=r.splice(0,S),i=c.length;c.forEach((function(t){a.push(t.nft.nftId),e+=t.nft.price}));var u=s.includes(m)?(0,R.uf)(e/O.LAMPORTS_PER_SOL,8,"SOL"):(0,R.uf)(1.001*e/O.LAMPORTS_PER_SOL,8,"SOL");a.sort((function(e,t){return e-t}));var h={projectId:l,instruction:"buy",totalTxCount:i,totalAmount:u,totalNonceCount:v,feeMode:d,tipFee:b,priorityFee:k,referral:x,tokenSymbol:f,from:m,startNftId:a[0],endNftId:a[a.length-1],nftIds:a,nextRoundLocalFormat:p,formData:t,currentProjectDataSource:n,transactions:c},j=JSON.stringify(h,null,2),P="data:,".concat(j),w=document.createElement("a");w.href=P,w.download=1===o||1===S?"".concat(f,"_").concat(l.slice(0,4),"_").concat(l.slice(-4),"_").concat(i,"_").concat(y,"_buy.json"):"".concat(f,"_").concat(l.slice(0,4),"_").concat(l.slice(-4),"_").concat(i,"_part").concat(g++,"_").concat(y,"_buy.json"),w.click()};r.length;)P();null===(c=T.current)||void 0===c||c.setFieldValue("totalAmountCreate",j),null===(i=T.current)||void 0===i||i.setFieldValue("totalTxCount",h),vt(void 0),N.success("创建完成")}),[]),pr=(0,n.useCallback)((function(e,t,r,n,a,s){var c,i,u=0,l=t.projectId,o=t.feeMode,d=n.tokenSymbol,f=n.nextRoundLocalFormat,p=r.length,h=a.length,v=e.toString(),x=r[0].referral,b=[],k="",j="";1===o||2===o||3===o?k=(0,R.uf)(r[0].tipFee/O.LAMPORTS_PER_SOL,8,"SOL"):j=(0,R.uf)(r[0].priorityFee/O.LAMPORTS_PER_SOL,8,"SOL"),r.forEach((function(e){b.push(e.nft.nftId),u+=e.nft.price}));var y=s.includes(v)?(0,R.uf)(u/O.LAMPORTS_PER_SOL,8,"SOL"):(0,R.uf)(1.001*u/O.LAMPORTS_PER_SOL,8,"SOL");b.sort((function(e,t){return e-t}));var S={projectId:l,instruction:"buy",totalTxCount:p,totalAmount:y,totalNonceCount:h,feeMode:o,tipFee:k,priorityFee:j,referral:x,tokenSymbol:d,from:v,startNftId:b[0],endNftId:b[b.length-1],nftIds:b,nextRoundLocalFormat:f,formData:t,currentProjectDataSource:n,transactions:r};null===(c=T.current)||void 0===c||c.setFieldValue("totalAmountCreate",y),null===(i=T.current)||void 0===i||i.setFieldValue("totalTxCount",p),m.current.handleReset(),m.current.handleTransactionFileContent(S),vt(S),N.success("开始成功")}),[]),hr=(0,n.useCallback)(v()(p()().mark((function e(){var t,r,n,a,s,c,i;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=null===(t=T.current)||void 0===t?void 0:t.getFieldsValue(),H&&z&&q&&B&&Y&&_e){e.next=5;break}return N.error(g),e.abrupt("return",!0);case 5:if("OKX Wallet"!==H.adapter.name){e.next=8;break}return N.error("不支持OKX Wallet"),e.abrupt("return",!0);case 8:return e.next=10,or($,z,r,De);case 10:return n=e.sent,a=n.nonceAccounts,s=n.nonceAccountsData,c=n.nftsDataSource,e.next=16,dr({connection:$,wallet:H,payer:z,anchorWallet:B,signMessage:Y,signAllTransactions:q,nftsDataSource:c,formData:r,nonceAccounts:a,nonceAccountsData:s,currentProjectDataSource:_e,tipAccounts:yt,tipFee:G,priorityFee:ee});case 16:if((i=e.sent).length){e.next=20;break}return N.info("没有需要创建的内容"),e.abrupt("return",!0);case 20:pr(z,r,i,_e,a,St),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(0),We(0),(0,R.Tv)(e.t0,N,"handleFinishRun");case 27:case"end":return e.stop()}}),e,null,[[0,23]])}))),[G,ee,z,H,q,B,Y,_e,De,$,yt,St]),vr=(0,n.useCallback)(v()(p()().mark((function e(){var t,r,n,a,s,c,i,u;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=T.current)||void 0===t?void 0:t.validateFields();case 2:if(e.prev=2,n=null===(r=T.current)||void 0===r?void 0:r.getFieldsValue(),H&&z&&q&&B&&Y&&_e){e.next=7;break}return N.error(g),e.abrupt("return",!0);case 7:if("OKX Wallet"!==H.adapter.name){e.next=10;break}return N.error("不支持OKX Wallet"),e.abrupt("return",!0);case 10:return e.next=12,or($,z,n,De);case 12:return a=e.sent,s=a.nonceAccounts,c=a.nonceAccountsData,i=a.nftsDataSource,e.next=18,dr({connection:$,wallet:H,payer:z,anchorWallet:B,signMessage:Y,signAllTransactions:q,nftsDataSource:i,formData:n,nonceAccounts:s,nonceAccountsData:c,currentProjectDataSource:_e,tipAccounts:yt,tipFee:G,priorityFee:ee});case 18:if((u=e.sent).length){e.next=22;break}return N.info("没有需要创建的内容"),e.abrupt("return",!0);case 22:fr(z,n,u,_e,s,St),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(2),We(0),(0,R.Tv)(e.t0,N,"handleFinishCreate");case 29:case"end":return e.stop()}}),e,null,[[2,25]])}))),[G,ee,z,H,q,B,Y,_e,De,$,yt,St]),mr=(0,n.useCallback)((function(e,t,r,n){var a=Math.min.apply(Math,ve()(e.map((function(e){return e.profit})))),s=0;1===t?s=a*r/100:2===t?s=n[r]*O.LAMPORTS_PER_SOL:3===t&&(s=(s=Number(r)*O.LAMPORTS_PER_SOL)<1e3?1e3:s),J(s),fe(a)}),[]),xr=(0,n.useCallback)((function(e,t,r,n){var a=Math.min.apply(Math,ve()(e.map((function(e){return e.profit})))),s=0;4===t?s=a*r/100:5===t?s=n[r]*Re/1e6:6===t&&(s=Number(r)*O.LAMPORTS_PER_SOL),te(s),fe(a)}),[]),br=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r){var n,a,s,c,i,u,o,d,f,h,v,m,x,b,k,j,y,S,g;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Te(!0),a={},e.next=5,(0,A.HF)();case 5:return s=e.sent,c=function(e){return(0,R.uf)(Math.max(e,1e-6),8,"SOL")},i=function(e){return"$"+(0,R.uf)(Math.max(e,1e-6)*r,6)},a["25th"]=s.landed_tips_25th_percentile,a["50th"]=s.landed_tips_50th_percentile,a["50th_ema"]=s.ema_landed_tips_50th_percentile,a["75th"]=s.landed_tips_75th_percentile,a["95th"]=s.landed_tips_95th_percentile,a["99th"]=s.landed_tips_99th_percentile,u={"25th":{sol:"",usd:""},"50th":{sol:"",usd:""},"50th_ema":{sol:"",usd:""},"75th":{sol:"",usd:""},"95th":{sol:"",usd:""},"99th":{sol:"",usd:""}},o=c(a["25th"]),d=c(a["50th"]),f=c(a["50th_ema"]),h=c(a["75th"]),v=c(a["95th"]),m=c(a["99th"]),x=i(a["25th"]),b=i(a["50th"]),k=i(a["50th_ema"]),j=i(a["75th"]),y=i(a["95th"]),S=i(a["99th"]),u["25th"]={sol:o,usd:x},u["50th"]={sol:d,usd:b},u["50th_ema"]={sol:f,usd:k},u["75th"]={sol:h,usd:j},u["95th"]={sol:v,usd:y},u["99th"]={sol:m,usd:S},(g=[]).push({value:"25th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"25%"}),(0,l.jsx)("div",{children:c(a["25th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["25th"])})})]})}),g.push({value:"50th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"50%"}),(0,l.jsx)("div",{children:c(a["50th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["50th"])})})]})}),g.push({value:"50th_ema",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"50% EMA"}),(0,l.jsx)("div",{children:c(a["50th_ema"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["50th_ema"])})})]})}),g.push({value:"75th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"75%"}),(0,l.jsx)("div",{children:c(a["75th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["75th"])})})]})}),g.push({value:"95th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"95%"}),(0,l.jsx)("div",{children:c(a["95th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["95th"])})})]})}),g.push({value:"99th",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"99%"}),(0,l.jsx)("div",{children:c(a["99th"])}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:i(a["99th"])})})]})}),Mt(a),Ct(g),null===(n=T.current)||void 0===n||n.setFieldValue("tipFeeCreate","50th_ema"),mr(t,2,"50th_ema",a),Te(!1),e.abrupt("return",{levels:a,tipFeeCreate:"50th_ema"});case 48:e.prev=48,e.t0=e.catch(0),Te(!1),(0,R.Tv)(e.t0,N,"handleUpdateTipFee");case 52:case"end":return e.stop()}}),e,null,[[0,48]])})));return function(t,r){return e.apply(this,arguments)}}(),[]),kr=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r,n,a,s){var c,i,u,l,o,d,f,h,v;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=[]).push(O.SystemProgram.nonceAdvance({noncePubkey:n[0].nonceAccount,authorizedPubkey:n[0].authority})),i=r[0],u=i.nftPubkey,l=i.ownerPubkey,o=s,d=2,"56d6qq9KAWcuUAHqPCK5yQAZ9PT5vqdCedJLiA5WaGgQ",f="56d6qq9KAWcuUAHqPCK5yQAZ9PT5vqdCedJLiA5WaGgQ",e.next=11,(0,A.G4)({program:a,nftPubkey:u,currentOwnerPubkey:l,payerPubkey:o,currentProjectDataSource:t,userReferral:"56d6qq9KAWcuUAHqPCK5yQAZ9PT5vqdCedJLiA5WaGgQ",payMode:d});case 11:return h=e.sent,c.push(h),2===d&&f&&(v=Number((.001*i.price).toFixed(0)),c.push(O.SystemProgram.transfer({fromPubkey:s,toPubkey:new O.PublicKey("56d6qq9KAWcuUAHqPCK5yQAZ9PT5vqdCedJLiA5WaGgQ"),lamports:v}))),e.abrupt("return",c);case 15:case"end":return e.stop()}}),e)})));return function(t,r,n,a,s){return e.apply(this,arguments)}}(),[]),jr=(0,n.useCallback)((function(e,t,r){return 5e3*new O.TransactionMessage({payerKey:e,recentBlockhash:t[0],instructions:r[0]}).compileToLegacyMessage().header.numRequiredSignatures}),[]),yr=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r,n,a,s,c){var i,u,o,d,f,h,v,m,x,b,k,j,y,S,g,P,w,C,F,L,M,I,V,_,A,Z,E,z;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Te(!0),u=Re,o=(0,D.O3)(),d=new O.Connection(o),f=n[0].blockhash,h=s||new O.PublicKey("Cym5m3Qp1r5SjCN5SfAkzLRYUJMVFz8YQWT3ZhQVwoyV"),e.next=9,kr(t,r,n,a,h);case 9:return v=e.sent,e.next=12,(0,D.aR)(d,h,f,v);case 12:return m=e.sent,x=m.priorityFeeLevels,b=jr(h,[f],[v]),k=function(e,t){return(0,R.uf)(e*t/1e6/O.LAMPORTS_PER_SOL,8,"SOL")},j=function(e,t){return"$"+(0,R.uf)(e*t/1e6/O.LAMPORTS_PER_SOL*c,6)},y=function(e,t,r){return(0,R.uf)((e*t/1e6+r)/O.LAMPORTS_PER_SOL,8,"SOL")},S=function(e,t,r){return"$"+(0,R.uf)((e*t/1e6+r)/O.LAMPORTS_PER_SOL*c,6)},g={min:{sol:"",usd:""},low:{sol:"",usd:""},medium:{sol:"",usd:""},high:{sol:"",usd:""},veryHigh:{sol:"",usd:""},unsafeMax:{sol:"",usd:""}},P=y(x.min,u,b),w=y(x.low,u,b),C=y(x.medium,u,b),F=y(x.high,u,b),L=y(x.veryHigh,u,b),M=y(x.unsafeMax,u,b),I=S(x.min,u,b),V=S(x.low,u,b),_=S(x.medium,u,b),A=S(x.high,u,b),Z=S(x.veryHigh,u,b),E=S(x.unsafeMax,u,b),g.min={sol:P,usd:I},g.low={sol:w,usd:V},g.medium={sol:C,usd:_},g.high={sol:F,usd:A},g.veryHigh={sol:L,usd:Z},g.unsafeMax={sol:M,usd:E},(z=[]).push({value:"min",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"Min"}),(0,l.jsx)("div",{children:k(x.min,u)}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:j(x.min,u)})})]})}),z.push({value:"low",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"Low"}),(0,l.jsx)("div",{children:k(x.low,u)}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:j(x.low,u)})})]})}),z.push({value:"medium",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"Medium"}),(0,l.jsx)("div",{children:k(x.medium,u)}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:j(x.medium,u)})})]})}),z.push({value:"high",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"High"}),(0,l.jsx)("div",{children:k(x.high,u)}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:j(x.high,u)})})]})}),z.push({value:"veryHigh",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"Very High"}),(0,l.jsx)("div",{children:k(x.veryHigh,u)}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:j(x.veryHigh,u)})})]})}),z.push({value:"unsafeMax",label:(0,l.jsxs)("div",{className:"grid grid-cols-3",children:[(0,l.jsx)("div",{children:"Unsafe Max"}),(0,l.jsx)("div",{children:k(x.unsafeMax,u)}),(0,l.jsx)("div",{className:"justify-items-end",children:(0,l.jsx)("div",{children:j(x.unsafeMax,u)})})]})}),Zt(x),It(z),null===(i=T.current)||void 0===i||i.setFieldValue("priorityFeeCreate","medium"),xr(r,5,"medium",x),Te(!1),e.abrupt("return",{levels:x,priorityFeeCreate:"medium"});case 53:e.prev=53,e.t0=e.catch(0),Te(!1),(0,R.Tv)(e.t0,N,"handleUpdatePriorityFee");case 57:case"end":return e.stop()}}),e,null,[[0,53]])})));return function(t,r,n,a,s,c){return e.apply(this,arguments)}}(),[]),Sr=(0,n.useCallback)((function(e,t,r){var n,a=null===(n=T.current)||void 0===n?void 0:n.getFieldsValue(),s=a.buyMode,c=a.feeMode,i=a.tipFeeCreate,u=a.priorityFeeCreate,l=lr(s,e);return 1!==c&&2!==c&&3!==c||mr(l,c,i,t),4!==c&&5!==c&&6!==c||xr(l,c,u,r),er(l.length),l.length}),[]),gr=(0,n.useCallback)((function(e){var t=new Set;e.forEach((function(e){t.add(e.ownerPubkey)}));var r=Array.from(t),n=[];r.forEach((function(e){n.push({value:e,label:(0,l.jsx)(Se.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:e})})})),Bt(n)}),[]),Pr=(0,n.useCallback)((function(e){var t=[];e.forEach((function(e){t.push({value:e.nftId,label:(0,l.jsxs)("div",{className:"grid grid-cols-2",children:[(0,l.jsxs)("div",{children:["#",e.nftId]}),(0,l.jsx)(Se.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:e.ownerPubkey})]})})})),t.sort((function(e,t){return e.value-t.value})),Gt(t)}),[]),wr=(0,n.useCallback)((function(e,t,r){var n,a,s,c,i=(null===(n=T.current)||void 0===n?void 0:n.getFieldsValue()).buyMode;7===i||8===i?(Xe(!0),gr(e)):(Xe(!1),Bt([]),null===(s=T.current)||void 0===s||s.setFieldValue("accounts",void 0));9===i?(nt(!0),Pr(e)):(nt(!1),Gt([]),null===(c=T.current)||void 0===c||c.setFieldValue("nftIds",void 0));Sr(e,t,r),null===(a=T.current)||void 0===a||a.resetFields(["buyCount","startNumber","endNumber"])}),[]),Cr=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r,n,a,s,c){var i,u,l,o,d,f,h,v,m;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,we(!0),u=null===(i=T.current)||void 0===i?void 0:i.getFieldsValue(),l=u.projectId,ar(),o=t.find((function(e){return e.mintPubkey===l})),e.next=7,(0,A.D3)(l,o);case 7:return d=e.sent,f=d.currentProjectNftsDataSource,h=[],h=s&&a?f.filter((function(e){return e.ownerPubkey!==a.toString()})):f,e.next=13,br(h,c);case 13:return v=e.sent,e.next=16,yr(o,f,r,n,a,c);case 16:m=e.sent,Sr(h,v.levels,m.levels),ze(h),Ae(o),we(!1),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(0),we(!1),(0,R.Tv)(e.t0,N,"handleCurrentProjectNfts");case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t,r,n,a,s,c){return e.apply(this,arguments)}}(),[]),Fr=(0,n.useCallback)((function(e,t,r){var n,a,s=Sr(e,t,r);s?null===(n=T.current)||void 0===n||n.setFieldValue("buyCount",s):null===(a=T.current)||void 0===a||a.setFieldValue("buyCount",void 0)}),[]),Lr=(0,n.useCallback)((function(e,t,r){var n,a,s=Sr(e,t,r);s?null===(n=T.current)||void 0===n||n.setFieldValue("buyCount",s):null===(a=T.current)||void 0===a||a.setFieldValue("buyCount",void 0)}),[]),Nr=(0,n.useCallback)((function(e,t){var r,n=null===(r=T.current)||void 0===r?void 0:r.getFieldsValue(),a=n.tipFeeCreate,s=n.feeMode;mr(e,s,a,t)}),[]),Mr=(0,n.useCallback)((function(e,t){var r,n=null===(r=T.current)||void 0===r?void 0:r.getFieldsValue(),a=n.priorityFeeCreate,s=n.feeMode;xr(e,s,a,t)}),[]),Rr=(0,n.useCallback)((function(e,t,r,n,a,s,c,i){var u,l=(null===(u=T.current)||void 0===u?void 0:u.getFieldsValue()).feeMode;if(1===l){var o;null===(o=T.current)||void 0===o||o.setFieldValue("tipFeeCreate",.1),mr(t,l,.1,s)}else if(2===l)br(t,i);else if(3===l){var d,f="0.000001";null===(d=T.current)||void 0===d||d.setFieldValue("tipFeeCreate",f),mr(t,l,f,s)}else if(4===l){var p;null===(p=T.current)||void 0===p||p.setFieldValue("priorityFeeCreate",.1),xr(t,l,.1,c)}else if(5===l)yr(e,t,r,n,a,i);else if(6===l){var h,v="0.000001";null===(h=T.current)||void 0===h||h.setFieldValue("priorityFeeCreate",v),xr(t,l,v,c)}it(l)}),[]),Or=(0,n.useCallback)((function(e){e.projectId&&Cr(jt,zt,rr,z,ot,ce),e.buyMode&&wr(De,Nt,At),e.nftIds&&Fr(De,Nt,At),e.accounts&&Lr(De,Nt,At),e.feeMode&&Rr(_e,De,zt,rr,z,Nt,At,ce),e.tipFeeCreate&&Nr(He,Nt),e.priorityFeeCreate&&Mr(He,At)}),[jt,_e,De,Xt,He,Nt,At,ce,ot,z,zt,rr]),Tr=(0,n.useCallback)((function(e){var t=[];e.forEach((function(e){var r=e.nftIssueCount,n=e.nftBurnCount;if(!(e.initNftSupply>r||n>0)){var a=e.nftImageUrl,s=e.tokenSymbol,c=e.projectName,i=e.mintPubkey;t.push({value:i,label:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(ge.C,{className:"mr-2",size:"default",src:a}),(0,l.jsx)("div",{children:"".concat(s," - ").concat(c)})]}),(0,l.jsx)(Se.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:i})]}),nftImageUrl:a,projectName:c,tokenSymbol:s,mintPubkey:i})}})),kt(t)}),[]),Ir=(0,n.useCallback)(v()(p()().mark((function e(){var t,r,n,a;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,we(!0),e.next=4,(0,A.yC)();case 4:return t=e.sent,r=t.projects,n=t.projectsDataSource,e.next=9,(0,R.o8)();case 9:a=e.sent,Tr(n),ie(a),w(b.N.setProjectsV2(r)),w(b.N.setProjectsDataSourceV2(n)),we(!1),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),we(!1),(0,R.Tv)(e.t0,N,"handleProjects");case 21:case"end":return e.stop()}}),e,null,[[0,17]])}))),[]),Vr=(0,n.useCallback)((function(e){var t=e.target.checked;dt(t),sr()}),[]),_r=(0,n.useCallback)((function(){ht?Ne()(JSON.stringify(ht,null,2))?N.success("复制成功"):N.error("复制失败"):N.info("先运行，再进行复制")}),[ht]),Ar=(0,n.useCallback)((function(){var e,t,r,n,a,s;return 1===ct?(0,l.jsx)(je.Z,{name:"tipFeeCreate",label:cr,min:.1,max:20,step:.1,fieldProps:{tooltip:{formatter:function(e){return"".concat(e,"%")}},disabled:!(null!==(e=T.current)&&void 0!==e&&e.getFieldValue("projectId"))},rules:[{required:!0,whitespace:!0,message:"".concat(j),pattern:/^.*$/}],help:(0,l.jsx)("div",{className:"text-red-600 mb-5",children:ur})}):2===ct?(0,l.jsx)(be.Z,{name:"tipFeeCreate",label:(0,l.jsxs)("div",{children:["每张图GAS费用",(0,l.jsx)(me.Z,{spin:Oe,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:function(){return br(De,ce)}})]}),options:wt,placeholder:"",rules:[{required:!0,whitespace:!0,message:"输入异常",pattern:/^.*$/}],fieldProps:{size:"large",autoFocus:!1,disabled:!(null!==(t=T.current)&&void 0!==t&&t.getFieldValue("projectId"))},help:(0,l.jsx)("div",{className:"text-red-600 mb-5",children:ur})}):3===ct?(0,l.jsx)(ye.Z,{name:"tipFeeCreate",label:cr,placeholder:"至少为0.000001 SOL",rules:[{required:!0,message:"".concat(j),whitespace:!0,pattern:/^\d+(\.\d{1,8})?$/}],fieldProps:{size:"large",autoFocus:!1,disabled:!(null!==(r=T.current)&&void 0!==r&&r.getFieldValue("projectId"))},help:(0,l.jsx)("div",{className:"text-red-600 mb-5",children:ur})}):4===ct?(0,l.jsx)(je.Z,{name:"priorityFeeCreate",label:ir,min:.1,max:20,step:.1,fieldProps:{tooltip:{formatter:function(e){return"".concat(e,"%")}},disabled:!(null!==(n=T.current)&&void 0!==n&&n.getFieldValue("projectId"))},rules:[{required:!0,whitespace:!0,message:"".concat(j),pattern:/^.*$/}],help:(0,l.jsx)("div",{className:"text-red-600 mb-5",children:ur})}):5===ct?(0,l.jsx)(be.Z,{name:"priorityFeeCreate",label:(0,l.jsxs)("div",{children:["每张图GAS费用",(0,l.jsx)(me.Z,{spin:Oe,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:function(){return yr(_e,De,zt,rr,z,ce)}})]}),options:Tt,placeholder:"",rules:[{required:!0,whitespace:!0,message:"输入异常",pattern:/^.*$/}],fieldProps:{size:"large",autoFocus:!1,disabled:!(null!==(a=T.current)&&void 0!==a&&a.getFieldValue("projectId"))},help:(0,l.jsx)("div",{className:"text-red-600 mb-5",children:ur})}):6===ct?(0,l.jsx)(ye.Z,{name:"priorityFeeCreate",label:ir,placeholder:"至少为0.000001 SOL",rules:[{required:!0,message:"".concat(j),whitespace:!0,pattern:/^\d+(\.\d{1,8})?$/}],fieldProps:{size:"large",autoFocus:!1,disabled:!(null!==(s=T.current)&&void 0!==s&&s.getFieldValue("projectId"))},help:(0,l.jsx)("div",{className:"text-red-600 mb-5",children:ur})}):void 0}),[ct,cr,ir,ur,_e,De,zt,rr,z,ce,Oe]);return(0,n.useEffect)((function(){Ir()}),[]),(0,n.useEffect)((function(){$&&z&&tr($,z)}),[z,$]),(0,l.jsxs)(de.Z,{title:(0,l.jsx)("div",{className:"font-semibold text-lg hardline",children:"创建交易"}),style:{width:"400px"},children:[(0,l.jsxs)(xe.A,{formRef:T,onFinish:hr,onValuesChange:Or,onReset:sr,layout:"vertical",initialValues:{buyMode:1,startNumber:1,tipFeeCreate:"50th_ema",priorityFeeCreate:"medium",payMode:1,feeMode:2,splitCount:1},submitter:{searchConfig:{submitText:"运行"},render:function(e,t){return[t[1],(0,l.jsx)(P.ZP,{onClick:vr,children:"创建"},"create"),(0,l.jsx)(P.ZP,{onClick:_r,children:"复制"},"copy"),t[0],(0,l.jsx)("div",{children:Ke||""},"sign")]}},children:[(0,l.jsx)(be.Z,{name:"projectId",label:(0,l.jsxs)("div",{children:["项目",(0,l.jsx)(me.Z,{spin:Pe,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:Ir})]}),options:bt,placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(j),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,filterOption:function(e,t){return(t.projectName+t.tokenSymbol).toLowerCase().includes(e.toLowerCase())},optionItemRender:function(e){var t=e.projectName,r=e.tokenSymbol,n=e.nftImageUrl,a=e.mintPubkey;return(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(ge.C,{className:"mr-2",size:"default",src:n}),(0,R.Mn)()?(0,l.jsx)("div",{children:"".concat(r)}):(0,l.jsx)("div",{children:"".concat(r," - ").concat((0,R.LH)(t))})]}),(0,l.jsx)(Se.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]})}}}),(0,l.jsx)(be.Z,{name:"buyMode",label:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{children:"购买方式"}),(0,l.jsx)(Fe.Z,{checked:ot,onChange:Vr,className:"ml-4",children:"不含本账号图片"})]}),options:[{value:1,label:"1 随机"},{value:2,label:"2 价格低到高"},{value:3,label:"3 价格高到低"},{value:4,label:"4 时间优先"},{value:5,label:"5 只抢拆分"},{value:6,label:"6 不抢拆分(随机)"},{value:7,label:"7 指定账号(顺序)"},{value:8,label:"8 指定账号(随机)"},{value:9,label:"9 指定序号"}],rules:[{required:!0,whitespace:!0,message:"".concat(j),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,disabled:!(null!==(t=T.current)&&void 0!==t&&t.getFieldValue("projectId"))}}),!!Qe&&(0,l.jsx)(be.Z,{name:"accounts",label:"选择账号",options:$t,fieldProps:{mode:"multiple",disabled:!(null!==(r=T.current)&&void 0!==r&&r.getFieldValue("projectId"))},placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(j),pattern:/^.+$/}]}),!!rt&&(0,l.jsx)(be.Z,{name:"nftIds",label:"选择序号",options:Wt,fieldProps:{mode:"multiple",disabled:!(null!==(a=T.current)&&void 0!==a&&a.getFieldValue("projectId"))},placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(j),pattern:/^.+$/}]}),(0,l.jsx)(ke.Z,{name:"buyCount",label:(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{children:"购买数量 "}),(0,l.jsx)("span",{className:"hover:cursor-pointer",style:{color:"#1677ff"},onClick:function(){var e,t;null===(e=T.current)||void 0===e||e.setFieldValue("buyCount",Xt),null===(t=T.current)||void 0===t||t.validateFields(["buyCount"])},children:Xt?"(".concat(Xt,")"):""})]}),placeholder:"",min:1,max:Xt,rules:[{required:!0,message:"".concat(j),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",disabled:!(null!==(c=T.current)&&void 0!==c&&c.getFieldValue("projectId"))}}),(0,l.jsx)(ke.Z,{name:"startNumber",label:(0,l.jsxs)("div",{children:["开始序号#",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"从具体某个序号开始进行购买",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"",min:1,rules:[{required:!0,message:"".concat(j),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",disabled:!(null!==(i=T.current)&&void 0!==i&&i.getFieldValue("projectId"))}}),(0,l.jsx)(ke.Z,{name:"endNumber",label:(0,l.jsxs)("div",{children:["结束序号#",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"只购买当前序号之前的NFT",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"可选，默认是当前序号的最大值",min:1,rules:[{required:!1,message:"".concat(j),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",disabled:!(null!==(u=T.current)&&void 0!==u&&u.getFieldValue("projectId"))}}),(0,l.jsx)(be.Z,{name:"feeMode",label:"GAS费用输入方式",options:[{value:1,label:"利润百分比-Jito"},{value:2,label:"实时费用-Jito"},{value:3,label:"手动输入-Jito"},{value:4,label:"利润百分比-优先费"},{value:5,label:"实时费用-优先费"},{value:6,label:"手动输入-优先费"}],rules:[{required:!0,whitespace:!0,message:"".concat(j),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,disabled:!(null!==(o=T.current)&&void 0!==o&&o.getFieldValue("projectId"))}}),Ar(),(0,l.jsx)(be.Z,{name:"payMode",label:"工具费用",options:[{value:1,label:"免费"},{value:2,label:"0.3%"}],rules:[{required:!0,whitespace:!0,message:"".concat(j),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,disabled:!(null!==(d=T.current)&&void 0!==d&&d.getFieldValue("projectId"))}}),(0,l.jsx)(ke.Z,{name:"splitCount",label:(0,l.jsxs)("div",{children:["拆分文件数量",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"将所有交易分配在多个文件进行保存，可方便在多个设备上进行发送",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"",min:1,rules:[{required:!0,message:"".concat(j),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1}}),(0,l.jsx)(ye.Z,{name:"totalAmountCreate",label:(0,l.jsxs)("div",{children:["交易总金额",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"此次全部交易所需要的总金额，包含手续费。",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0,disabled:!(null!==(f=T.current)&&void 0!==f&&f.getFieldValue("projectId"))}}),(0,l.jsx)(ye.Z,{name:"totalTxCount",label:"交易总笔数",placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0,disabled:!(null!==(h=T.current)&&void 0!==h&&h.getFieldValue("projectId"))}})]}),M]})},Te=(0,n.memo)(Oe),Ie=r(91604),Ve=r(52688),_e=r(66309),Ae=r(9669),Ze=r.n(Ae),Ee=[],De=function(){var e=(0,y.useIntl)().formatMessage({id:"common.intlInputException"}),t=S.ZP.useMessage(),r=s()(t,2),a=r[0],c=r[1],i=(0,n.useRef)(),u=(0,n.useRef)(),o=(0,n.useState)([]),f=s()(o,2),h=f[0],m=f[1],x=(0,n.useState)(),b=s()(x,2),k=b[0],j=b[1],g=(0,n.useState)(0),w=s()(g,2),C=w[0],L=w[1],N=(0,n.useState)(0),O=s()(N,2),T=O[0],I=O[1],V=(0,n.useState)(0),_=s()(V,2),Z=_[0],E=_[1],D=(0,n.useState)(0),z=s()(D,2),q=z[0],Y=z[1],H=(0,n.useState)(0),$=s()(H,2),B=$[0],U=$[1],K=(0,n.useState)(0),W=s()(K,2),G=W[0],J=W[1],Q=(0,n.useState)(!1),X=s()(Q,2),ee=X[0],te=X[1],re=(0,y.useSelector)((function(e){return e.wallet.jitoRpcs})),ne=(0,n.useRef)(!0),ce=(0,n.useRef)({}),ie=(0,n.useState)({}),ue=s()(ie,2),le=ue[0],oe=ue[1],fe=(0,n.useMemo)((function(){return k?"(".concat(k.tokenSymbol," ").concat(k.projectId.slice(0,4),"...").concat(k.projectId.slice(-4),")"):""}),[k]),pe=(0,n.useMemo)((function(){return k?"".concat(null==k?void 0:k.currentProjectDataSource.nextRoundLocalFormat):""}),[k]),he=(0,n.useCallback)((function(e){var t,r,n=null===(t=i.current)||void 0===t?void 0:t.getFieldsValue(),a=Object.keys(n).filter((function(e){return"transactionFile"!==e}));if(null===(r=i.current)||void 0===r||r.resetFields(a),e){var s,c,u=e.currentProjectDataSource.lastRoundLocalValue,l=e.currentProjectDataSource.secPerRound,o=e.totalAmount,d=e.tipFee;L(u+1e3*l),j(e),null===(s=i.current)||void 0===s||s.setFieldValue("totalAmountSend",o),null===(c=i.current)||void 0===c||c.setFieldValue("tipFeeSend",d);var f={};e.nftIds.forEach((function(e){ce.current[e]="default",f[e]="default"})),oe(f)}else{var p,h;L(0),j(void 0),null===(p=i.current)||void 0===p||p.setFieldValue("totalAmountSend",""),null===(h=i.current)||void 0===h||h.setFieldValue("tipFeeSend",""),ce.current={},oe({})}I(0),E(0),Y(0),U(0),J(0)}),[]),ve=(0,n.useCallback)((function(){var e,t,r;null===(e=i.current)||void 0===e||e.resetFields(),m([]),L(0),j(void 0),null===(t=i.current)||void 0===t||t.setFieldValue("totalAmountSend",""),null===(r=i.current)||void 0===r||r.setFieldValue("tipFeeSend",""),ce.current={},oe({}),I(0),E(0),Y(0),U(0),J(0)}),[]),me=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t){var r;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"removed"!==t.file.status){e.next=5;break}return m(t.fileList),he(void 0),e.abrupt("return");case 5:(r=new FileReader).readAsText(t.fileList[t.fileList.length-1].originFileObj),r.onload=function(){var e=JSON.parse(r.result);e?e.hasOwnProperty("instruction")&&"buy"===e.instruction?(m(t.fileList),he(e),a.success("上传成功")):a.error("指令类型错误"):a.error("上传失败")},e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,R.Tv)(e.t0,a,"handleUpload");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),[]),be=(0,n.useCallback)((function(){var e=0,t=0,r=0,n=0;for(var a in ce.current)"success"===ce.current[a]?t+=1:"error"===ce.current[a]?r+=1:"processing"===ce.current[a]?n+=1:"default"===ce.current[a]&&(e+=1);I(t),E(r),Y(n),U(e)}),[]),je=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r,n){var s;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=0;case 1:if(!(s<n)){e.next=16;break}Object.keys(ce.current).forEach((function(e){ce.current[e]="processing"})),be();case 4:return t.transactions.forEach(function(){var e=v()(p()().mark((function e(t,r){var n,a,s,c,i,u,l;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.transactionBase64,a=t.nft.nftId,"success"!==(s=ce.current[a])&&"error"!==s){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,c=r%re.length,i=re[c]+"/api/v1/transactions?bundleOnly=true",e.next=10,Ze().post(i,{jsonrpc:"2.0",id:"1",method:"sendTransaction",params:[n,{encoding:"base64",maxTry:0}]},{timeout:5e3});case 10:200===(u=e.sent).status?ce.current[a]="success":(ce.current[a]="error",Ee.push({data:F()().format("YYYY-MM-DDTHH:mm:ss.SSS"),nftId:a,error:JSON.stringify(u),pos:"try"})),e.next=20;break;case 14:if(e.prev=14,e.t0=e.catch(5),429!==(null===(l=e.t0.response)||void 0===l?void 0:l.status)){e.next=18;break}return e.abrupt("return");case 18:ce.current[a]="error",Ee.push({data:F()().format("YYYY-MM-DDTHH:mm:ss.SSS"),nftId:a,error:JSON.stringify(e.t0),pos:"catch"});case 20:be();case 21:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t,r){return e.apply(this,arguments)}}()),e.next=8,new Promise((function(e){setTimeout(e,r)}));case 8:if(0!==Object.values(ce.current).filter((function(e){return"processing"===e})).length){e.next=11;break}return e.abrupt("break",13);case 11:e.next=4;break;case 13:++s,e.next=1;break;case 16:a.success("发送完成");case 17:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),[a]),Se=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t){var r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=3;break}return a.error("请先上传交易文件"),e.abrupt("return",!1);case 3:return r=t.disorderSend,n=t.intervalSend,r&&k.transactions.sort((function(){return Math.random()-.5})),je(k,n,1),e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[k]),ge=(0,n.useCallback)((function(){var e;if(!k)return a.error("请先上传交易文件"),!1;var t=(null===(e=i.current)||void 0===e?void 0:e.getFieldsValue()).intervalSend;je(k,t,1)}),[k]),Pe=(0,n.useCallback)(v()(p()().mark((function e(){var t,r,n,a,s;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null===(t=i.current)||void 0===t?void 0:t.getFieldsValue(),n=r.disorderSend,a=r.repeatSend,s=r.intervalSend,r.autoSend&&k){e.next=3;break}return e.abrupt("return");case 3:return n&&k.transactions.sort((function(){return Math.random()-.5})),je(k,s,a),e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)}))),[k]),we=(0,n.useCallback)((function(e){var t,r,n=null===(t=i.current)||void 0===t?void 0:t.getFieldValue("leadTimeSend");n&&e<n&&ne.current&&(ne.current=!1,null===(r=i.current)||void 0===r||r.submit())}),[]),Ce=(0,n.useCallback)(v()(p()().mark((function e(){var t,r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=3;break}return a.info("无待校验数据"),e.abrupt("return",!0);case 3:return e.prev=4,te(!0),t={},e.next=9,(0,A.tt)({mintPubkey:k.projectId});case 9:r=e.sent,n=0,k.nftIds.forEach((function(e){var a=k.from,s=r.find((function(t){return t.nft_id===e}));s&&s.owner_pubkey===a?(t[e]="success",n+=1):t[e]="default"})),J(n),oe(t),te(!1),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),te(!1),(0,R.Tv)(e.t0,a,"handleCheckOwnCount");case 21:case"end":return e.stop()}}),e,null,[[4,17]])}))),[a,k]),Fe=(0,n.useCallback)((function(){if(k&&Ee.length){var e=F()().format("YYYY-MM-DDTHH:mm:ss"),t=JSON.stringify(Ee,null,2),r="data:,".concat(t),n=document.createElement("a"),s=k.tokenSymbol,c=k.projectId;n.href=r,n.download="Log_".concat(s,"_").concat(c.slice(0,4),"_").concat(c.slice(-4),"_").concat(e,".json"),n.click()}else a.info("无日志信息")}),[k]);return(0,l.jsxs)(de.Z,{title:(0,l.jsx)("div",{className:"font-semibold text-lg hardline",children:"发送交易"}),style:{width:"400px"},children:[(0,l.jsxs)(xe.A,{formRef:i,onFinish:Se,onReset:ve,layout:"vertical",initialValues:{disorderSend:!0,autoSend:!0,repeatSend:3,intervalSend:500,leadTimeSend:0,fixedTimeSend:!1},submitter:{searchConfig:{submitText:"发送"},render:function(e,t){return[t[1],(0,l.jsx)(P.ZP,{onClick:ge,children:"预检"},"preflight"),(0,l.jsx)(P.ZP,{loading:ee,onClick:Ce,children:"校对"},"check"),(0,l.jsx)(P.ZP,{onClick:Fe,children:"日志"},"log"),t[0]]}},children:[(0,l.jsx)(Ie.Z,{label:"交易文件",name:"transactionFile",action:"upload.do",fieldProps:{accept:".json",onChange:me,beforeUpload:function(){return!1},listType:"picture",maxCount:1,onPreview:function(e){return u.current.handleOpen(e)},fileList:h},rules:[{required:!0,whitespace:!0,message:"".concat(e),pattern:/.*/}]}),(0,l.jsx)(ke.Z,{label:(0,l.jsxs)("div",{children:["整体重复发送次数",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复次数。重复发送失败了，不会影响金额",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"repeatSend",placeholder:"",min:1,rules:[{required:!0,message:"".concat(e),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:3,disabled:!k}}),(0,l.jsx)(ke.Z,{label:(0,l.jsxs)("div",{children:["重复发送间隔(毫秒)",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"超过接口发送次数后，延时多长时间进行重新发送",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"intervalSend",placeholder:"",min:300,rules:[{required:!0,message:"".concat(e),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1e3,disabled:!k}}),(0,l.jsx)(ke.Z,{label:(0,l.jsxs)("div",{children:["提前发送时间(毫秒)",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"在下一轮开始前多少毫秒发送交易",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"leadTimeSend",placeholder:"",max:3e3,min:0,rules:[{required:!0,message:"".concat(e),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:0,disabled:!k}}),(0,l.jsx)(Ve.Z,{name:"disorderSend",label:(0,l.jsxs)("div",{children:["是否乱序",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"是否以乱序的方式来发送交易",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(e),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0,disabled:!k}}),(0,l.jsx)(Ve.Z,{name:"autoSend",label:(0,l.jsxs)("div",{children:["是否自动发送",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"倒计时结束后，是否自动发送交易。开启与否，不影响手动操作来发",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(e),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0,disabled:!k}}),(0,l.jsx)(ye.Z,{name:"tipFeeSend",label:"每张图GAS费用",placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0,disabled:!k}}),(0,l.jsx)(ye.Z,{name:"totalAmountSend",label:(0,l.jsxs)("div",{children:["总金额",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"此次全部交易所需要的总金额，包含手续费",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0,disabled:!k}}),(0,l.jsx)(xe.A.Item,{label:(0,l.jsxs)("div",{className:"font-semibold text-lg ",children:[(0,l.jsx)("span",{className:"hardline",children:"倒计时 "}),fe]}),children:(0,l.jsxs)("div",{className:"flex items-center gap-x-5",children:[(0,l.jsx)(d,{className:"text-2xl",value:C,onFinish:Pe,onChange:we}),(0,l.jsx)("div",{className:"text-2xl",children:pe})]})}),(0,l.jsxs)(xe.A.Item,{label:(0,l.jsxs)("div",{className:" font-semibold text-lg hardline",children:[(0,l.jsx)("span",{children:"结果 "}),k?"(".concat(k.totalTxCount,")"):""]}),children:[(0,l.jsx)("div",{children:"完成：".concat(T,"，失败：").concat(Z,"，处理中：").concat(q,"，待处理：").concat(B)}),!!k&&(0,l.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(ce.current).map((function(e,t){return(0,l.jsx)(_e.Z,{color:ce.current[e],children:"#".concat(e)},t)}))})]}),(0,l.jsxs)(xe.A.Item,{label:(0,l.jsx)("div",{className:" font-semibold text-lg hardline",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{children:"校对 "}),k?"(".concat(k.totalTxCount,")"):"",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"交易结束后，可点击校对按钮，判断交易结果是否跟链上数据匹配",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]})}),children:[(0,l.jsx)("div",{children:"拥有：".concat(G)}),!!k&&(0,l.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(le).map((function(e,t){return(0,l.jsx)(_e.Z,{color:le[e],children:"#".concat(e)},t)}))})]})]}),(0,l.jsx)(M.VY,{ref:u}),c]})},ze=(0,n.memo)(De),qe=r(99611),Ye=r(90420),He=window,$e=B()(B()({},He.electronApi),{},{handleValuesChange:He.electronApi?(0,R.Ds)(window.electronApi.handleValuesChange,1e3):null}),Be=[],Ue=(0,n.forwardRef)((function(e,t){var r=(0,y.useIntl)().formatMessage({id:"common.intlInputException"}),a=S.ZP.useMessage(),c=s()(a,2),i=c[0],u=c[1],o=(0,n.useRef)(),f=(0,n.useRef)(),h=(0,n.useState)([]),m=s()(h,2),x=m[0],b=m[1],k=(0,n.useState)(),j=s()(k,2),g=j[0],w=j[1],C=(0,n.useState)(0),L=s()(C,2),N=L[0],O=L[1],T=(0,n.useState)(0),I=s()(T,2),V=I[0],_=I[1],Z=(0,n.useState)(0),E=s()(Z,2),D=E[0],z=E[1],q=(0,n.useState)(0),Y=s()(q,2),H=Y[0],$=Y[1],B=(0,n.useState)(0),U=s()(B,2),K=U[0],W=U[1],G=(0,n.useState)(0),J=s()(G,2),Q=J[0],X=J[1],ee=(0,n.useState)(0),te=s()(ee,2),re=te[0],ne=te[1],ce=(0,n.useState)(!1),ie=s()(ce,2),ue=ie[0],le=ie[1],oe=(0,y.useSelector)((function(e){return e.wallet.jitoRpcs})),fe=(0,n.useRef)(0),pe=(0,y.useSelector)((function(e){return e.wallet.rpcPool})),he=(0,n.useRef)(!0),ve=(0,n.useRef)({}),me=(0,n.useState)({}),be=s()(me,2),je=be[0],Se=be[1],ge=(0,n.useState)(!1),Pe=s()(ge,2),we=Pe[0],Ce=Pe[1],Fe=(0,n.useState)(!1),Le=s()(Fe,2),Ne=Le[0],Me=Le[1],Re=(0,n.useState)(2),Oe=s()(Re,2),Te=Oe[0],Ae=Oe[1],Ee=(0,n.useRef)(!1),De=(0,n.useMemo)((function(){return g?"(".concat(g.tokenSymbol," ").concat(g.projectId.slice(0,4),"...").concat(g.projectId.slice(-4),")"):""}),[g]),ze=(0,n.useMemo)((function(){return g?"".concat(null==g?void 0:g.currentProjectDataSource.nextRoundLocalFormat):""}),[g]),He=(0,n.useCallback)((function(e){var t=(0,R.d)();return(4===e||5===e||6===e)&&!t}),[]),Ue=(0,n.useCallback)((function(e){var t=(0,R.d)();return(4===e||5===e||6===e)&&t}),[]),Ke=(0,n.useCallback)((function(e){var t,r,n=null===(t=o.current)||void 0===t?void 0:t.getFieldsValue(),a=Object.keys(n).filter((function(e){return"transactionFile"!==e}));if(null===(r=o.current)||void 0===r||r.resetFields(a),e){var s,c,u,l=e.currentProjectDataSource.nextRoundLocalValue,d=e.totalAmount,f=e.tipFee,p=e.priorityFee,h=e.feeMode;if(He(h))return i.error("优先费模式只支持在桌面程序中运行"),!1;O(l),w(e),null===(s=o.current)||void 0===s||s.setFieldValue("totalAmountSend",d),null===(c=o.current)||void 0===c||c.setFieldValue("tipFeeSend",f),null===(u=o.current)||void 0===u||u.setFieldValue("priorityFeeSend",p);var v={};if(ve.current={},e.nftIds.forEach((function(e){ve.current[e]="default",v[e]="default"})),Se(v),Ae(h),Ue(h)){var m={repeatSend:n.repeatSend,intervalSend:n.intervalSend,leadTimeSend:n.leadTimeSend,reverseOrder:n.reverseOrder,autoSend:n.autoSend};$e.handleTransactionFileContent(e,pe,m)}}else{var x,b,k;O(0),w(void 0),null===(x=o.current)||void 0===x||x.setFieldValue("totalAmountSend",""),null===(b=o.current)||void 0===b||b.setFieldValue("tipFeeSend",""),null===(k=o.current)||void 0===k||k.setFieldValue("priorityFeeSend",""),ve.current={},Se({}),Ae(2),(0,R.d)()&&$e.handleReset()}return _(0),z(0),$(0),W(0),X(0),ne(0),!0}),[]),We=(0,n.useCallback)((function(){var e,t,r,n;null===(e=o.current)||void 0===e||e.resetFields(),b([]),Ee.current=!1,O(0),w(void 0),null===(t=o.current)||void 0===t||t.setFieldValue("totalAmountSend",""),null===(r=o.current)||void 0===r||r.setFieldValue("tipFeeSend",""),null===(n=o.current)||void 0===n||n.setFieldValue("priorityFeeSend",""),ve.current={},Se({}),Ae(2),_(0),z(0),$(0),W(0),X(0),ne(0),Ue(Te)&&$e.handleReset()}),[Te]);(0,n.useImperativeHandle)(t,(function(){return{handleTransactionFileContent:Ke,handleReset:We}}));var Ge=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t){var r;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"removed"!==t.file.status){e.next=5;break}return b(t.fileList),Ke(void 0),e.abrupt("return");case 5:(r=new FileReader).readAsText(t.fileList[t.fileList.length-1].originFileObj),r.onload=function(){var e=JSON.parse(r.result);e?e.hasOwnProperty("instruction")&&"buy"===e.instruction?Ke(e)&&(b(t.fileList),i.success("上传成功")):i.error("指令类型错误"):i.error("上传失败")},e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,R.Tv)(e.t0,i,"handleUpload");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),[]),Je=(0,n.useCallback)((function(){var e=0,t=0,r=0,n=0,a=0;for(var s in ve.current)"success"===ve.current[s]?t+=1:"error"===ve.current[s]?r+=1:"processing"===ve.current[s]?a+=1:"default"===ve.current[s]?e+=1:"warning"===ve.current[s]&&(n+=1);_(t),z(r),$(n),W(a),X(e)}),[]),Qe=(0,n.useCallback)((function(e){e.forEach(function(){var e=v()(p()().mark((function e(t){var r,n,a,s,c,i,u;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.transactionBase64,n=t.nft.nftId,"success"!==(a=ve.current[n])&&"error"!==a&&"warning"!==a){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,s=fe.current++%oe.length,c=oe[s]+"/api/v1/transactions?bundleOnly=true",e.next=10,Ze().post(c,{jsonrpc:"2.0",id:"1",method:"sendTransaction",params:[r,{encoding:"base64"}]},{timeout:3e3});case 10:200===(i=e.sent).status?i.data.error?(ve.current[n]="error",Be.push({data:F()().format("YYYY-MM-DDTHH:mm:ss.SSS"),nftId:n,error:JSON.stringify(i),pos:"try"})):ve.current[n]="success":(ve.current[n]="error",Be.push({data:F()().format("YYYY-MM-DDTHH:mm:ss.SSS"),nftId:n,error:JSON.stringify(i),pos:"try"})),e.next=21;break;case 14:if(e.prev=14,e.t0=e.catch(5),429!==(null===(u=e.t0.response)||void 0===u?void 0:u.status)){e.next=19;break}return ve.current[n]="default",e.abrupt("return");case 19:ve.current[n]="error",Be.push({data:F()().format("YYYY-MM-DDTHH:mm:ss.SSS"),nftId:n,error:JSON.stringify(e.t0),pos:"catch"});case 21:Je();case 22:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t){return e.apply(this,arguments)}}())}),[]),Xe=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r){var n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){setTimeout(e,r)}));case 2:if(n=0,t.forEach((function(e){var t=e.nft.nftId,r=ve.current[t];"processing"===r?(n+=1,ve.current[t]="warning"):"default"===r?ve.current[t]="processing":n+=1})),n!==t.length){e.next=8;break}return e.abrupt("return",!0);case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[]),et=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t,r,n){var a,s,c,u,l,o,d;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fe.current=0,a=0;case 2:if(!(a<n)){e.next=25;break}Object.keys(ve.current).forEach((function(e){ve.current[e]="processing"})),Je(),s=t.totalNonceCount,c=t.totalTxCount,u=Math.ceil(c/s),l=0;case 9:if(!(l<u)){e.next=22;break}o=t.transactions.slice(0,(l+1)*s);case 11:return Qe(o),e.next=15,Xe(o,r);case 15:if(!e.sent){e.next=17;break}return e.abrupt("break",19);case 17:e.next=11;break;case 19:++l,e.next=9;break;case 22:++a,e.next=2;break;case 25:return d=t.transactions,Qe(d),e.next=29,Xe(d,r);case 29:Ee.current=!1,i.success("发送完成");case 31:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),[i]),tt=(0,n.useCallback)(function(){var e=v()(p()().mark((function e(t){var r,n,a,s,c,u,l,o;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee.current){e.next=4;break}return e.abrupt("return");case 4:Ee.current=!0;case 5:if(g){e.next=8;break}return i.error("请先上传交易文件"),e.abrupt("return",!1);case 8:if(!Ue(Te)){e.next=15;break}return r=t.repeatSend,n=t.intervalSend,a=t.leadTimeSend,s=t.reverseOrder,c=t.autoSend,u={repeatSend:r,intervalSend:n,leadTimeSend:a,reverseOrder:s,autoSend:c},e.next=13,$e.handleFinish(g,u);case 13:return Ee.current=!1,e.abrupt("return",!0);case 15:return l=t.reverseOrder,o=t.intervalSend,l&&(g.transactions=g.transactions.toReversed()),et(g,o,1),e.abrupt("return",!0);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[g,Te]),rt=(0,n.useCallback)(v()(p()().mark((function e(){var t,r,n,a,s,c,u,l,d;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee.current){e.next=4;break}return e.abrupt("return");case 4:Ee.current=!0;case 5:if(g){e.next=8;break}return i.error("请先上传交易文件"),e.abrupt("return",!1);case 8:if(r=null===(t=o.current)||void 0===t?void 0:t.getFieldsValue(),!Ue(Te)){e.next=16;break}return n=r.repeatSend,a=r.intervalSend,s=r.leadTimeSend,c=r.reverseOrder,u=r.autoSend,l={repeatSend:n,intervalSend:a,leadTimeSend:s,reverseOrder:c,autoSend:u},e.next=14,$e.handlePreflight(g,l);case 14:return Ee.current=!1,e.abrupt("return");case 16:d=r.intervalSend,et(g,d,1);case 18:case"end":return e.stop()}}),e)}))),[g,Te]),nt=(0,n.useCallback)(v()(p()().mark((function e(){var t,r,n,a,s;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee.current){e.next=4;break}return e.abrupt("return");case 4:Ee.current=!0;case 5:if(r=null===(t=o.current)||void 0===t?void 0:t.getFieldsValue(),n=r.reverseOrder,a=r.repeatSend,s=r.intervalSend,r.autoSend&&g&&!Ue(Te)){e.next=8;break}return e.abrupt("return");case 8:return n&&(g.transactions=g.transactions.toReversed()),et(g,s,a),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)}))),[g,Te]),at=(0,n.useCallback)((function(e){var t,r=null===(t=o.current)||void 0===t?void 0:t.getFieldValue("leadTimeSend");r&&e<r&&he.current&&(he.current=!1,nt())}),[nt]),st=(0,n.useCallback)(v()(p()().mark((function e(){var t,r,n;return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g){e.next=3;break}return i.info("无待校验数据"),e.abrupt("return",!0);case 3:return e.prev=4,le(!0),t={},e.next=9,(0,A.II)({mintPubkey:g.projectId});case 9:r=e.sent,n=0,g.nftIds.forEach((function(e){var a=g.from,s=r.find((function(t){return t.nft_id===e}));s&&s.owner_pubkey===a?(t[e]="success",n+=1):t[e]="default"})),ne(n),Se(t),le(!1),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),le(!1),(0,R.Tv)(e.t0,i,"handleCheckOwnCount");case 21:case"end":return e.stop()}}),e,null,[[4,17]])}))),[i,g]),ct=(0,n.useCallback)((function(e){if((e.repeatSend||e.intervalSend||e.leadTimeSend)&&Ue(Te)){var t,r=null===(t=o.current)||void 0===t?void 0:t.getFieldsValue(),n={repeatSend:r.repeatSend,intervalSend:r.intervalSend,leadTimeSend:r.leadTimeSend,reverseOrder:r.reverseOrder,autoSend:r.autoSend};$e.handleValuesChange(n)}}),[Te]),it=(0,n.useCallback)((function(){if(Ue(Te)){var e,t=null===(e=o.current)||void 0===e?void 0:e.getFieldsValue(),r={repeatSend:t.repeatSend,intervalSend:t.intervalSend,leadTimeSend:t.leadTimeSend,reverseOrder:t.reverseOrder,autoSend:t.autoSend};$e.handleValuesChange(r)}}),[Te]),ut=(0,n.useCallback)((function(){if(g&&Be.length){var e=F()().format("YYYY-MM-DDTHH:mm:ss"),t=JSON.stringify(Be,null,2),r="data:,".concat(t),n=document.createElement("a"),a=g.tokenSymbol,s=g.projectId;n.href=r,n.download="Log_".concat(a,"_").concat(s.slice(0,4),"_").concat(s.slice(-4),"_").concat(e,".json"),n.click()}else i.info("无日志信息")}),[g]);return(0,n.useEffect)((function(){if(Ue(Te))return $e.onNftIdsSendStatus((function(e){ve.current=e,Je()})),$e.onLog((function(e){Be=e})),function(){$e.offNftIdsSendStatus((function(e){ve.current=e,Je()})),$e.offLog((function(e){Be=e}))}}),[Te]),(0,l.jsxs)(de.Z,{title:(0,l.jsx)("div",{className:"font-semibold text-lg hardline",children:"发送交易"}),style:{width:"400px"},children:[(0,l.jsxs)(xe.A,{formRef:o,onFinish:tt,onValuesChange:ct,onReset:We,layout:"vertical",initialValues:{reverseOrder:!1,autoSend:!0,repeatSend:2,intervalSend:500,leadTimeSend:0,fixedTimeSend:!1},submitter:{searchConfig:{submitText:"发送"},render:function(e,t){return[t[1],(0,l.jsx)(P.ZP,{loading:ue,onClick:st,children:"校对"},"check"),(0,l.jsx)(P.ZP,{onClick:rt,children:"预检"},"preflight"),(0,l.jsx)(P.ZP,{onClick:ut,children:"日志"},"log"),t[0]]}},children:[(0,l.jsx)(Ie.Z,{label:"交易文件",name:"transactionFile",action:"upload.do",fieldProps:{accept:".json",onChange:Ge,beforeUpload:function(){return!1},listType:"picture",maxCount:1,onPreview:function(e){return f.current.handleOpen(e)},fileList:x},rules:[{whitespace:!0,message:"".concat(r),pattern:/.*/}]}),(0,l.jsx)(ke.Z,{label:(0,l.jsxs)("div",{children:["整体重复发送次数",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复次数。重复发送失败了，不会影响金额",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"repeatSend",placeholder:"",min:1,rules:[{required:!0,message:"".concat(r),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:3,disabled:!g}}),(0,l.jsx)(ke.Z,{label:(0,l.jsxs)("div",{children:["重复发送间隔(毫秒)",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"超过接口发送次数后，延时多长时间进行重新发送",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"intervalSend",placeholder:"",min:100,rules:[{required:!0,message:"".concat(r),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1e3,disabled:!g}}),(0,l.jsx)(ke.Z,{label:(0,l.jsxs)("div",{children:["提前发送时间(毫秒)",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"在下一轮开始前多少毫秒发送交易",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"leadTimeSend",placeholder:"",max:3e3,min:0,rules:[{required:!0,message:"".concat(r),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:0,disabled:!g}}),(0,l.jsx)(Ve.Z,{name:"reverseOrder",label:(0,l.jsxs)("div",{children:["是否倒序",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"是否以倒序的方式来发送交易",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(r),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0,onChange:it,disabled:!g}}),(0,l.jsx)(Ve.Z,{name:"autoSend",label:(0,l.jsxs)("div",{children:["是否自动发送",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"倒计时结束后，是否自动发送交易。开启与否，不影响手动操作来发",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(r),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0,onChange:it,disabled:!g}}),1===Te||2===Te||3===Te?(0,l.jsx)(ye.Z,{name:"tipFeeSend",label:"每张图GAS费用（Jito）",placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0,disabled:!g}}):(0,l.jsx)(ye.Z,{name:"priorityFeeSend",label:"每张图GAS费用（优先费）",placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0,disabled:!g}}),(0,l.jsx)(ye.Z,{name:"totalAmountSend",label:(0,l.jsxs)("div",{children:["总金额",(0,l.jsx)(ae.Z,{placement:"topLeft",title:"此次全部交易所需要的总金额，包含手续费",children:(0,l.jsx)(se.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0,disabled:!g}}),(0,l.jsx)(xe.A.Item,{label:(0,l.jsxs)("div",{className:"font-semibold text-lg ",children:[(0,l.jsx)("span",{className:"hardline",children:"倒计时 "}),De]}),children:(0,l.jsxs)("div",{className:"flex items-center gap-x-5",children:[(0,l.jsx)(d,{className:"text-2xl",value:N,onFinish:nt,onChange:at}),(0,l.jsx)("div",{className:"text-2xl",children:ze})]})}),(0,l.jsxs)(xe.A.Item,{label:(0,l.jsxs)("div",{className:" font-semibold text-lg hardline",children:[(0,l.jsx)("span",{children:"结果 "}),g?"(".concat(g.totalTxCount,")"):"",(0,l.jsx)("span",{className:"ml-2",style:{color:"#1677ff"},onClick:function(){return Ce((function(e){return!e}))},children:we?(0,l.jsx)(qe.Z,{}):(0,l.jsx)(Ye.Z,{})})]}),children:[(0,l.jsx)("div",{children:"完成：".concat(V,"，失败：").concat(D,"，超时：").concat(H,"，处理中：").concat(K,"，待处理：").concat(Q)}),!(!g||!we)&&(0,l.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(ve.current).map((function(e,t){return(0,l.jsx)(_e.Z,{color:ve.current[e],children:"#".concat(e)},t)}))})]}),(0,l.jsxs)(xe.A.Item,{label:(0,l.jsx)("div",{className:" font-semibold text-lg hardline",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{children:"校对 "}),g?"(".concat(g.totalTxCount,")"):"",(0,l.jsx)("span",{className:"ml-2",style:{color:"#1677ff"},onClick:function(){return Me((function(e){return!e}))},children:Ne?(0,l.jsx)(qe.Z,{}):(0,l.jsx)(Ye.Z,{})})]})}),children:[(0,l.jsx)("div",{children:"拥有：".concat(re)}),!(!g||!Ne)&&(0,l.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(je).map((function(e,t){return(0,l.jsx)(_e.Z,{color:je[e],children:"#".concat(e)},t)}))})]})]}),(0,l.jsx)(M.VY,{ref:f}),u]})})),Ke=(0,n.memo)(Ue),We=function(e){var t=e.roundDataSource,r=e.loading,a=e.formData,s=e.profitRate,c=e.minuteChecked,i=(0,n.useMemo)((function(){if(a){var e=t[0].roundLocalValue,r=t[t.length-1].roundLocalValue,n=(r-e)/1e3/60/60/24,s=(r-e)/1e3/60/60;return c?"(".concat((0,R.uf)(s,1),"小时/").concat(a.timePerRound,"分钟)"):"(".concat(n.toFixed(1),"天/").concat(a.timePerRound,"小时)")}return""}),[a,t]),u=(0,n.useMemo)((function(){return a?"(".concat(a.maxNftSupply,")"):""}),[a]),o=(0,n.useMemo)((function(){return a?"(".concat(a.creatorFeeRate,"%) / 累计"):""}),[a]),d=(0,n.useMemo)((function(){return a?"(".concat(a.inviterFeeRate,"%) / 累计"):""}),[a]),f=(0,n.useMemo)((function(){return a?"(".concat(a.platformFeeRate,"%) / 累计"):""}),[a]),p=(0,n.useMemo)((function(){return a?"(".concat((0,R.uf)(a.nftTradeFeeRate-a.creatorFeeRate-a.inviterFeeRate,2),"%) / 累计"):""}),[a]),h=(0,n.useMemo)((function(){return s?"(".concat((0,R.uf)(100*s,2),"%) / 累计"):""}),[s]),v=(0,n.useMemo)((function(){return t.length?"(".concat(t.length-1,")"):""}),[t]),m=(0,n.useMemo)((function(){return[{title:"轮次".concat(v),dataIndex:"key",key:"key",render:function(e,t){return 0===t.key?"mint":(0,l.jsx)("span",{children:t.key})}},{title:"轮次时间".concat(i),dataIndex:"roundLocalFormat",key:"roundLocalFormat",sorter:function(e,t){return t.roundLocalValue-e.roundLocalValue},render:function(e,t){return(0,l.jsx)("div",{children:t.roundLocalFormat})}},{title:"NFT数量",dataIndex:"nftCount",key:"nftCount",render:function(e,t){return(0,l.jsx)("div",{children:t.nftCount})}},{title:"NFT价格",dataIndex:"nftPrice",key:"nftPrice",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.nftPrice)})}},{title:"投入成本",dataIndex:"invest",key:"invest",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.invest,2)})}},{title:"抢图利润".concat(h),dataIndex:"profitUser",key:"profitUser",render:function(e,t){return(0,l.jsxs)("div",{children:[(0,R.uf)(t.profitUser)," / ",(0,R.uf)(t.profitUserSum)]})}},{title:"创建者利润".concat(o),dataIndex:"profitCreator",key:"profitCreator",render:function(e,t){return(0,l.jsxs)("div",{children:[(0,R.uf)(t.profitCreator)," / ",(0,R.uf)(t.profitCreatorSum)]})}},{title:"邀请人利润".concat(d),dataIndex:"profitInviter",key:"profitInviter",render:function(e,t){return(0,l.jsxs)("div",{children:[(0,R.uf)(t.profitInviter)," / ",(0,R.uf)(t.profitInviterSum)]})}},{title:"平台利润".concat(f),dataIndex:"profitPlatform",key:"profitPlatform",render:function(e,t){return(0,l.jsxs)("div",{children:[(0,R.uf)(t.profitPlatform)," / ",(0,R.uf)(t.profitPlatformSum)]})}},{title:"资金池".concat(p),dataIndex:"vaultSol",key:"vaultSol",render:function(e,t){return(0,l.jsxs)("div",{children:[(0,R.uf)(t.vaultSol)," / ",(0,R.uf)(t.vaultSolSum)]})}}]}),[i,u,o,d,f,p]);return(0,l.jsx)("div",{className:"ppp-tab-round",children:(0,l.jsx)(j.Z,{loading:{spinning:r,size:"large"},scroll:{x:!0},size:"small",columns:m,dataSource:t,defaultData:[],options:!1,search:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1})})},Ge=(0,n.memo)(We),Je=r(78045),Qe=function(e){var t=e.sellDataSource,r=e.loading,a=e.formData,c=(0,n.useState)("last"),i=s()(c,2),u=i[0],o=i[1],d=(0,n.useMemo)((function(){if(t.length){var e="";if("last"===u){var r=t.length-1,n=t[0].solPoolLast;e=(t[r].solPoolLast/n*100).toFixed(1)}else{var a=t.length-1,s=t[0].solPoolPenultimate;e=(t[a].solPoolPenultimate/s*100).toFixed(1)}return"(锁死".concat(e,"%)")}return""}),[t,u]),f=(0,n.useMemo)((function(){return[{title:"卖出次序",dataIndex:"key",key:"key",sorter:function(e,t){return t.key-e.key},render:function(e,t){return 0===t.key?"未开始":(0,l.jsx)("div",{children:t.key})}},{title:"NFT成本",dataIndex:"nftPriceLast",key:"nftPriceLast",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.nftPriceLast)})}},{title:"Token数量",dataIndex:"tokenPerNft",key:"tokenPerNft",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.tokenPerNft)})}},{title:"卖出获得SOL",dataIndex:"solOutputLast",key:"solOutputLast",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.solOutputLast)})}},{title:"利润",dataIndex:"profitLast",key:"profitLast",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profitLast)})}},{title:"池子余额SOL ".concat(d),dataIndex:"solPoolLast",key:"solPoolLast",sorter:function(e,t){return e.solPoolLast-t.solPoolLast},render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.solPoolLast)})}},{title:"池子余额Token",dataIndex:"tokenPoolLast",key:"tokenPoolLast",sorter:function(e,t){return e.tokenPoolLast-t.tokenPoolLast},render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.tokenPoolLast)})}}]}),[d]),p=(0,n.useMemo)((function(){return[{title:"卖出次序",dataIndex:"key",key:"key",sorter:function(e,t){return t.key-e.key},render:function(e,t){return 0===t.key?"未开始":(0,l.jsx)("div",{children:t.key})}},{title:"NFT平均成本",dataIndex:"nftPricePenultimate",key:"nftPricePenultimate",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.nftPricePenultimate)})}},{title:"Token数量",dataIndex:"tokenPerNft",key:"tokenPerNft",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.tokenPerNft)})}},{title:"卖出获得SOL",dataIndex:"solOutputPenultimate",key:"solOutputPenultimate",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.solOutputPenultimate)})}},{title:"利润",dataIndex:"profitPenultimate",key:"profitPenultimate",render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.profitPenultimate)})}},{title:"池子余额SOL ".concat(d),dataIndex:"solPoolPenultimate",key:"solPoolPenultimate",sorter:function(e,t){return e.solPoolPenultimate-t.solPoolPenultimate},render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.solPoolPenultimate)})}},{title:"池子余额Token",dataIndex:"tokenPoolPenultimate",key:"tokenPoolPenultimate",sorter:function(e,t){return e.tokenPoolPenultimate-t.tokenPoolPenultimate},render:function(e,t){return(0,l.jsx)("div",{children:(0,R.uf)(t.tokenPoolPenultimate)})}}]}),[d]);return(0,l.jsxs)("div",{className:"ppp-tab-sell",children:[(0,l.jsxs)("div",{className:"my-4 flex gap-4",children:[(0,l.jsx)(Je.ZP.Group,{value:u,onChange:function(e){return o(e.target.value)},options:[{value:"last",label:"最后一轮"},{value:"penultimate",label:"倒数第二轮"}]}),a?(0,l.jsxs)("div",{className:"mr-2",children:["Token池子占比：",null==a?void 0:a.lpTokenRate,"%"]}):null,a?(0,l.jsxs)("div",{children:["SOL池子占比：",100-(null==a?void 0:a.lpTokenRate),"%"]}):null]}),(0,l.jsx)(j.Z,{loading:{spinning:r,size:"large"},scroll:{x:!0},size:"small",columns:"last"===u?f:p,dataSource:t,defaultData:[],options:!1,search:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1})]})},Xe=(0,n.memo)(Qe)}}]);