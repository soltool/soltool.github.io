"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9430],{64225:function(e,t,r){r.r(t);var n=r(64599),s=r.n(n),a=r(15009),c=r.n(a),u=r(99289),o=r.n(u),l=r(5574),i=r.n(l),f=r(40956),p=r(64119),d=r(39380),m=r(38345),j=r(74273),h=r(88026),x=r(2453),N=r(7134),v=r(34041),b=r(74330),P=r(38703),y=r(71230),k=r(15746),C=r(27484),S=r.n(C),g=r(70178),V=r.n(g),w=r(67294),R=(r(8849),r(28704)),D=r(39678),Z=r(25104),L=r(44718),O=r(29363),T=r(71874),E=r(85893);S().extend(V());t.default=function(){var e=(0,h.useDispatch)(),t=x.ZP.useMessage(),r=i()(t,2),n=r[0],a=r[1],u=(0,w.useState)(!0),l=i()(u,2),C=l[0],g=l[1],V=(0,L.R)().connection,Y=(0,h.useSelector)((function(e){return e.ppp.projectsDataSourceV2})),I=(0,h.useSelector)((function(e){return e.ppp.currentProjectNftsStatusV2})),M=(0,h.useSelector)((function(e){return e.ppp.currentProjectDataSourceV2})),F=(0,h.useSelector)((function(e){return e.ppp.projectsOptionV2})),z=(0,h.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV2})),H=(0,w.useState)(0),U=i()(H,2),B=U[0],A=U[1],K=(0,w.useRef)(0),G=(0,w.useCallback)(function(){var t=o()(c()().mark((function t(r){var s;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{s=[],r.forEach((function(e){var t=e.nftImageUrl,r=e.tokenSymbol,n=e.projectName,a=e.mintPubkey;s.push({value:a,label:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)(N.C,{className:"mr-2",size:"default",src:t}),(0,E.jsx)("div",{children:"".concat(r," - ").concat(n)})]}),(0,E.jsx)(D.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]}),nftImageUrl:t,projectName:n,tokenSymbol:r,mintPubkey:a})})),e(f.N.setProjectsOptionV2(s))}catch(e){(0,p.Tv)(e,n,"handleProjectsOption")}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),W=(0,w.useCallback)((function(e){if(e<0)K.current=100,A(100);else{var t=1e3*M.secPerRound,r=(t-e)/t*100,n=Math.ceil(r);n!==K.current&&(K.current=n,A(r))}}),[M]),_=(0,w.useCallback)((function(t,r){var n,a=0,c=0,u=0,o=0,l=t.nftSupply,i=t.secToBurnNft,p=t.secPerRound,d=t.splitNftPrice,m=t.lastRoundLocalValue,j=s()(r);try{for(j.s();!(n=j.n()).done;){var h=n.value,x=S()().valueOf(),N=h.lastTradeLocalValue,v=1e3*i,b=1e3*p;h.price>=d&&(o+=1),x-N>v&&(a+=1),m>N||x-m>b?c+=1:u+=1}}catch(e){j.e(e)}finally{j.f()}e(f.N.setCurrentProjectNftsStatusV2({burnNumber:a,buyNumber:c,sellNumber:u,splitNumber:o,nftNumber:l}))}),[]),q=(0,w.useCallback)(function(){var t=o()(c()().mark((function t(r,s,a){var u,o,l,i,d,m;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,u={},s.forEach((function(e){var t=e.ownerPubkey,r=e.profit,n=e.invest;u.hasOwnProperty(t)||(u[t]={number:0,invest:0,profit:0}),u[t].profit+=r,u[t].number+=1,u[t].invest+=n})),o=[],l=0,i=Object.keys(u).map((function(e){return new O.PublicKey(e)})),t.next=8,(0,T.ep)(r,i);case 8:d=t.sent,Object.keys(u).forEach((function(e,t){var r=u[e].number,n=u[e].invest,s=u[e].profit,c=d[t]?d[t].lamports:0,i=a.accountsDurable[e];l+=r,o.push({key:t,owner:e,number:r,percent:0,invest:n,profit:s,balance:c,durable:i})})),o.forEach((function(e){e.percent=e.number/l*100})),m=o.sort((function(e,t){return t.number-e.number})),e(f.N.setCurrentProjectNftsRankDataSourceV2(m)),e(f.N.setCurrentProjectNftsRankDataSourceResetV2(m)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),(0,p.Tv)(t.t0,n,"handleCurrentProjectNftsRank");case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,r,n){return t.apply(this,arguments)}}(),[]),J=(0,w.useCallback)((function(t,r){var n=t.secPerRound,s=t.lastRoundLocalValue,a=t.initNftPrice,c=t.splitNftPrice,u=t.increasePerRound/1e4,o=t.maxNftSupply,l=t.nftIssueCount,i=t.nftBurnCount,p=t.initNftSupply,d=t.profitRate/100,m=t.profitRateCreator/100,j=t.profitRateInviter/100,h=t.profitRatePlatform/100,x=t.tradeFeeRate/1e4,N=[],v=[],b=1,P=S()(s).add(n*b,"seconds"),y=P.valueOf(),k=P.format("YYYY-MM-DDTHH:mm:ss");l<p?v=new Array(p).fill(a*(1+u)):r.forEach((function(e){return v.push(e.price)}));for(var C=function(){for(var e=v.length,t=0;t<e;++t){var r=v[t];if(r>=c&&(v[t]=r/2,v.push(r/2),v.length>=o))break}var s=0;if(v.forEach((function(e){s+=e})),N.push({key:b++,roundLocalValue:y,roundLocalFormat:k,invest:s,profitUser:s*d,profitCreator:s*m,profitInviter:s*j,profitPlatform:s*h,vaultSol:s*x,nftCount:v.length}),v.length>=o)return 1;var a=S()(y).add(n,"seconds");y=a.valueOf(),k=a.format("YYYY-MM-DDTHH:mm:ss"),v.forEach((function(e,t){v[t]=e*(u+1)}))};v.length<o&&!i&&!C(););e(f.N.setCurrentProjectNftsGrowV2(N))}),[]),Q=(0,w.useCallback)(function(){var t=o()(c()().mark((function t(r){var s,a,u,o,l;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(f.N.setCurrentProjectNftsLoadingV2(!0)),s=Y.find((function(e){return e.mintPubkey===r})),t.next=5,(0,R.D3)(r,s);case 5:return a=t.sent,u=a.currentProjectNftsDataSource,o=a.currentProjectNfts,t.next=10,(0,R.Fy)(s);case 10:l=t.sent,_(s,u),J(s,u),q(V,u,l),e(f.N.setCurrentProjectNftsBuyDurableV2(l)),e(f.N.setCurrentProjectNftsV2(o)),e(f.N.setCurrentProjectNftsDataSourceV2(u)),e(f.N.setCurrentProjectNftsDataSourceResetV2(u)),e(f.N.setCurrentProjectDataSourceV2(s)),e(f.N.setCurrentProjectNftsLoadingV2(!1)),K.current=0,A(0),t.next=28;break;case 24:t.prev=24,t.t0=t.catch(0),e(f.N.setCurrentProjectNftsLoadingV2(!1)),(0,p.Tv)(t.t0,n,"handleCurrentProjectNfts");case 28:case"end":return t.stop()}}),t,null,[[0,24]])})));return function(e){return t.apply(this,arguments)}}(),[Y,V]),X=(0,w.useCallback)(o()(c()().mark((function t(){var r,s,a;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,g(!0),t.next=4,(0,R.yC)();case 4:return r=t.sent,s=r.projects,a=r.projectsDataSource,t.next=9,G(a);case 9:e(f.N.setProjectsV2(s)),e(f.N.setProjectsDataSourceV2(a)),g(!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),g(!1),(0,p.Tv)(t.t0,n,"handleProjects");case 18:case"end":return t.stop()}}),t,null,[[0,14]])}))),[]);return(0,w.useEffect)((function(){X()}),[]),(0,E.jsxs)(d._z,{className:"projects",ghost:!0,children:[(0,E.jsx)(v.Z,{loading:C,size:"large",style:{width:"100%"},className:"mb-3",defaultValue:M.mintPubkey?M.mintPubkey:void 0,onChange:function(e){Q(e)},placeholder:"请选择项目",showSearch:!0,filterOption:function(e,t){return(t.projectName+t.tokenSymbol).toLowerCase().includes(e.toLowerCase())},options:F,optionRender:function(e){var t=e.data,r=t.projectName,n=t.tokenSymbol,s=t.nftImageUrl,a=t.mintPubkey;return(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)(N.C,{className:"mr-2",size:"default",src:s}),(0,E.jsx)("div",{children:"".concat(n," - ").concat(r)})]}),(0,E.jsx)(D.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]})}}),(0,E.jsxs)(b.Z,{size:"large",spinning:z,children:[(0,E.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,E.jsx)("div",{children:"下一轮倒计时："}),(0,E.jsx)(Z.Wo,{className:"mr-2 font-medium text-base",value:M.nextRoundLocalValue,onChange:W}),(0,E.jsx)("div",{className:" text-base",children:M.nextRoundLocalFormat})]}),(0,E.jsx)(P.Z,{percent:B,showInfo:!1}),(0,E.jsx)(m.Z,{headerBordered:!0,headStyle:{justifyContent:"center"},className:"mb-3",children:(0,E.jsxs)(y.Z,{gutter:10,children:[(0,E.jsx)(k.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"总量"}),value:I.nftNumber}})}),(0,E.jsx)(k.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可买 / 已售"}),value:"".concat(I.buyNumber," / ").concat(I.sellNumber)}})}),(0,E.jsx)(k.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可拆分"}),value:I.splitNumber}})}),(0,E.jsx)(k.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可销毁"}),value:I.burnNumber}})})]})})]}),(0,E.jsx)(m.Z,{tabs:{items:[{key:"nft",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"NFT市场"}),children:(0,E.jsx)(Z.Af,{handleCurrentProjectNfts:Q})},{key:"rank",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"NFT排名"}),children:(0,E.jsx)(Z.Hm,{handleCurrentProjectNfts:Q})},{key:"grow",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"轮次数据"}),children:(0,E.jsx)(Z.UM,{})}],defaultActiveKey:"nft"}}),a]})}},8849:function(){}}]);