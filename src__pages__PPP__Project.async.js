"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9430],{64225:function(e,t,r){r.r(t);var n=r(64599),s=r.n(n),a=r(15009),c=r.n(a),o=r(99289),u=r.n(o),i=r(5574),l=r.n(i),f=r(40956),p=r(64119),d=r(39380),m=r(38345),h=r(74273),j=r(88026),x=r(2453),N=r(7134),v=r(34041),b=r(74330),P=r(38703),k=r(71230),y=r(15746),C=r(27484),S=r.n(C),g=r(70178),w=r.n(g),V=r(67294),R=(r(8849),r(28704)),D=r(39678),Z=r(25104),L=r(44718),O=r(29363),T=r(71874),E=r(85893);S().extend(w());t.default=function(){var e=(0,j.useDispatch)(),t=x.ZP.useMessage(),r=l()(t,2),n=r[0],a=r[1],o=(0,V.useState)(!0),i=l()(o,2),C=i[0],g=i[1],w=(0,L.R)().connection,Y=(0,j.useSelector)((function(e){return e.ppp.projectsDataSourceV2})),I=(0,j.useSelector)((function(e){return e.ppp.currentProjectNftsStatusV2})),M=(0,j.useSelector)((function(e){return e.ppp.currentProjectDataSourceV2})),z=(0,j.useSelector)((function(e){return e.ppp.projectsOptionV2})),F=(0,j.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV2})),H=(0,V.useState)(0),U=l()(H,2),A=U[0],B=U[1],K=(0,V.useRef)(0),G=(0,V.useCallback)(function(){var t=u()(c()().mark((function t(r){var s;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{s=[],r.forEach((function(e){var t=e.nftImageUrl,r=e.tokenSymbol,n=e.projectName,a=e.mintPubkey;s.push({value:a,label:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)(N.C,{className:"mr-2",size:"default",src:t}),(0,E.jsx)("div",{children:"".concat(r," - ").concat(n)})]}),(0,E.jsx)(D.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]}),nftImageUrl:t,projectName:n,tokenSymbol:r,mintPubkey:a})})),e(f.N.setProjectsOptionV2(s))}catch(e){(0,p.Tv)(e,n,"handleProjectsOption")}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),W=(0,V.useCallback)((function(e){if(e<0)K.current=100,B(100);else{var t=1e3*M.secPerRound,r=(t-e)/t*100,n=Math.ceil(r);n!==K.current&&(K.current=n,B(r))}}),[M]),_=(0,V.useCallback)((function(t,r){var n,a=0,c=0,o=0,u=0,i=t.nftSupply,l=t.secToBurnNft,p=t.secPerRound,d=t.splitNftPrice,m=t.lastRoundLocalValue,h=s()(r);try{for(h.s();!(n=h.n()).done;){var j=n.value,x=S()().valueOf(),N=j.lastTradeLocalValue,v=1e3*l,b=1e3*p;j.price>=d&&(u+=1),x-N>v&&(a+=1),m>N||x-m>b?c+=1:o+=1}}catch(e){h.e(e)}finally{h.f()}e(f.N.setCurrentProjectNftsStatusV2({burnNumber:a,buyNumber:c,sellNumber:o,splitNumber:u,nftNumber:i}))}),[]),q=(0,V.useCallback)(function(){var t=u()(c()().mark((function t(r,s){var a,o,u,i,l,d;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={},s.forEach((function(e){var t=e.ownerPubkey,r=e.profit,n=e.invest;a.hasOwnProperty(t)||(a[t]={number:0,invest:0,profit:0}),a[t].profit+=r,a[t].number+=1,a[t].invest+=n})),o=[],u=0,i=Object.keys(a).map((function(e){return new O.PublicKey(e)})),t.next=8,(0,T.ep)(r,i);case 8:l=t.sent,Object.keys(a).forEach((function(e,t){var r=a[e].number,n=a[e].invest,s=a[e].profit,c=l[t]?l[t].lamports:0;u+=r,o.push({key:t,owner:e,number:r,percent:0,invest:n,profit:s,balance:c})})),o.forEach((function(e){e.percent=e.number/u*100})),d=o.sort((function(e,t){return t.number-e.number})),e(f.N.setCurrentProjectNftsRankDataSourceV2(d)),e(f.N.setCurrentProjectNftsRankDataSourceResetV2(d)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),(0,p.Tv)(t.t0,n,"handleCurrentProjectNftsRank");case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,r){return t.apply(this,arguments)}}(),[]),J=(0,V.useCallback)((function(t,r){var n=t.secPerRound,s=t.lastRoundLocalValue,a=t.initNftPrice,c=t.splitNftPrice,o=t.increasePerRound/1e4,u=t.maxNftSupply,i=t.nftIssueCount,l=t.nftBurnCount,p=t.initNftSupply,d=t.profitRate/100,m=t.profitRateCreator/100,h=t.profitRateInviter/100,j=t.profitRatePlatform/100,x=t.tradeFeeRate/1e4,N=[],v=[],b=1,P=S()(s).add(n*b,"seconds"),k=P.valueOf(),y=P.format("YYYY-MM-DDTHH:mm:ss");i<p?v=new Array(p).fill(a*(1+o)):r.forEach((function(e){return v.push(e.price)}));for(var C=function(){for(var e=v.length,t=0;t<e;++t){var r=v[t];if(r>=c&&(v[t]=r/2,v.push(r/2),v.length>=u))break}var s=0;if(v.forEach((function(e){s+=e})),N.push({key:b++,roundLocalValue:k,roundLocalFormat:y,invest:s,profitUser:s*d,profitCreator:s*m,profitInviter:s*h,profitPlatform:s*j,vaultSol:s*x,nftCount:v.length}),v.length>=u)return 1;var a=S()(k).add(n,"seconds");k=a.valueOf(),y=a.format("YYYY-MM-DDTHH:mm:ss"),v.forEach((function(e,t){v[t]=e*(o+1)}))};v.length<u&&!l&&!C(););e(f.N.setCurrentProjectNftsGrowV2(N))}),[]),Q=(0,V.useCallback)(function(){var t=u()(c()().mark((function t(r){var s,a,o,u;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(f.N.setCurrentProjectNftsLoadingV2(!0)),s=Y.find((function(e){return e.mintPubkey===r})),t.next=5,(0,R.D3)(r,s);case 5:a=t.sent,o=a.currentProjectNftsDataSource,u=a.currentProjectNfts,_(s,o),J(s,o),q(w,o),e(f.N.setCurrentProjectNftsV2(u)),e(f.N.setCurrentProjectNftsDataSourceV2(o)),e(f.N.setCurrentProjectNftsDataSourceResetV2(o)),e(f.N.setCurrentProjectDataSourceV2(s)),e(f.N.setCurrentProjectNftsLoadingV2(!1)),K.current=0,B(0),t.next=24;break;case 20:t.prev=20,t.t0=t.catch(0),e(f.N.setCurrentProjectNftsLoadingV2(!1)),(0,p.Tv)(t.t0,n,"handleCurrentProjectNfts");case 24:case"end":return t.stop()}}),t,null,[[0,20]])})));return function(e){return t.apply(this,arguments)}}(),[Y,w]),X=(0,V.useCallback)(u()(c()().mark((function t(){var r,s,a;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,g(!0),t.next=4,(0,R.yC)();case 4:return r=t.sent,s=r.projects,a=r.projectsDataSource,t.next=9,G(a);case 9:e(f.N.setProjectsV2(s)),e(f.N.setProjectsDataSourceV2(a)),g(!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),g(!1),(0,p.Tv)(t.t0,n,"handleProjects");case 18:case"end":return t.stop()}}),t,null,[[0,14]])}))),[]);return(0,V.useEffect)((function(){X()}),[]),(0,E.jsxs)(d._z,{className:"projects",ghost:!0,children:[(0,E.jsx)(v.Z,{loading:C,size:"large",style:{width:"100%"},className:"mb-3",defaultValue:M.mintPubkey?M.mintPubkey:void 0,onChange:function(e){Q(e)},placeholder:"请选择项目",showSearch:!0,filterOption:function(e,t){return(t.projectName+t.tokenSymbol).toLowerCase().includes(e.toLowerCase())},options:z,optionRender:function(e){var t=e.data,r=t.projectName,n=t.tokenSymbol,s=t.nftImageUrl,a=t.mintPubkey;return(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)(N.C,{className:"mr-2",size:"default",src:s}),(0,E.jsx)("div",{children:"".concat(n," - ").concat(r)})]}),(0,E.jsx)(D.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]})}}),(0,E.jsxs)(b.Z,{size:"large",spinning:F,children:[(0,E.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,E.jsx)("div",{children:"下一轮倒计时："}),(0,E.jsx)(Z.Wo,{className:"mr-2 font-medium text-base",value:M.nextRoundLocalValue,onChange:W}),(0,E.jsx)("div",{className:" text-base",children:M.nextRoundLocalFormat})]}),(0,E.jsx)(P.Z,{percent:A,showInfo:!1}),(0,E.jsx)(m.Z,{headerBordered:!0,headStyle:{justifyContent:"center"},className:"mb-3",children:(0,E.jsxs)(k.Z,{gutter:10,children:[(0,E.jsx)(y.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(h.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"总量"}),value:I.nftNumber}})}),(0,E.jsx)(y.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(h.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可买 / 已售"}),value:"".concat(I.buyNumber," / ").concat(I.sellNumber)}})}),(0,E.jsx)(y.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(h.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可拆分"}),value:I.splitNumber}})}),(0,E.jsx)(y.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(h.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可销毁"}),value:I.burnNumber}})})]})})]}),(0,E.jsx)(m.Z,{tabs:{items:[{key:"nft",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"NFT市场"}),children:(0,E.jsx)(Z.Af,{handleCurrentProjectNfts:Q})},{key:"rank",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"NFT排名"}),children:(0,E.jsx)(Z.Hm,{handleCurrentProjectNfts:Q})},{key:"grow",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"轮次数据"}),children:(0,E.jsx)(Z.UM,{})}],defaultActiveKey:"nft"}}),a]})}},8849:function(){}}]);