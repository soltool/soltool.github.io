"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[109],{3567:function(e,t,n){n.d(t,{Wo:function(){return f},tw:function(){return _},SX:function(){return O}});var r=n(67294),o=n(5574),u=n.n(o),a=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function c(e,t){var n=t.format,r=void 0===n?"":n,o=new Date(e).getTime(),c=Date.now();return function(e,t){var n=e,r=/\[[^\]]*]/g,o=(t.match(r)||[]).map((function(e){return e.slice(1,-1)})),c=t.replace(r,"[]"),i=a.reduce((function(e,t){var r=u()(t,2),o=r[0],a=r[1];if(e.includes(o)){var c=Math.floor(n/a);return n-=c*a,e.replace(new RegExp("".concat(o,"+"),"g"),(function(e){var t=e.length;return c.toString().padStart(t,"0")}))}return e}),c),s=0;return i.replace(r,(function(){var e=o[s];return s+=1,e}))}(Math.max(o-c,0),r)}var i=n(40165),s=n(85893);var l=function(e){var t,n=e.value,o=e.format,a=void 0===o?"HH:mm:ss":o,l=e.onChange,f=e.onFinish,p=e.className,d=(t=(0,r.useReducer)((function(e){return e+1}),0),u()(t,2)[1]),h=r.useRef(null),m=function(){var e=function(e){return new Date(e).getTime()}(n);e>=Date.now()&&(h.current=(0,i.Zi)((function(){d(),null==l||l(e-Date.now()),e<Date.now()&&(null==f||f(),h.current&&((0,i.cv)(h.current),h.current=null))}),33.333333333333336))};return r.useEffect((function(){return m(),function(){h.current&&((0,i.cv)(h.current),h.current=null)}}),[n]),(0,s.jsx)("div",{className:p,children:c(n,{format:a})})},f=r.memo(l),p=n(15009),d=n.n(p),h=n(99289),m=n.n(h),y=n(64599),b=n.n(y),P=n(40956),v=n(49591),x=n(30441),k=n(88026),S=n(2453),w=n(83622),g=n(85137),j=n(27484),C=n.n(j),T=n(70178),L=n.n(T),M=n(70609),R=n(64119),K=n(93233);C().extend(L());var N=function(e){var t=e.handleCurrentProjectNfts,n=(0,k.useDispatch)(),o=S.ZP.useMessage(),a=u()(o,2),c=a[0],i=a[1],l=(0,k.useSelector)((function(e){return e.wallet.chain})),p=(0,k.useSelector)((function(e){return e.ppp.currentProjectNftsDataSource})),h=(0,k.useSelector)((function(e){return e.ppp.currentProjectNftsDataSourceReset})),y=(0,k.useSelector)((function(e){return e.ppp.currentProjectDataSource})),j=(0,r.useMemo)((function(){var e=new Set;p.forEach((function(t){e.add(t.ownerPubkey)}));var t,n=[],r=b()(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push({text:o,value:o})}}catch(e){r.e(e)}finally{r.f()}return n}),[p]),C=(0,k.useSelector)((function(e){return e.ppp.currentProjectNftsLoading})),T=(0,r.useMemo)((function(){var e=new Set;return p.forEach((function(t){e.add(t.ownerPubkey)})),e.size}),[p]),L=(0,r.useMemo)((function(){var e=0;return p.forEach((function(t){e+=t.invest})),e/K.LAMPORTS_PER_SOL}),[p]),N=(0,r.useMemo)((function(){var e=0;return p.forEach((function(t){e+=t.price})),e/K.LAMPORTS_PER_SOL}),[p]),_=(0,r.useState)([]),E=u()(_,2),O=E[0],D=E[1],A=(0,r.useCallback)((function(e){var t=e.ownerPubkey,r=p.filter((function(e){return e.ownerPubkey===t}));n(P.N.setCurrentProjectNftsDataSource(r))}),[p]),B=(0,r.useCallback)((function(){n(P.N.setCurrentProjectNftsDataSource(h))}),[h]),F=(0,r.useCallback)(m()(d()().mark((function e(){return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.info("敬请期待");case 1:case"end":return e.stop()}}),e)}))),[]),I=(0,r.useCallback)(m()(d()().mark((function e(){return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.info("敬请期待");case 1:case"end":return e.stop()}}),e)}))),[]),H=(0,r.useCallback)(m()(d()().mark((function e(){return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.info("敬请期待");case 1:case"end":return e.stop()}}),e)}))),[]),V=(0,r.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",search:!1,render:function(e,t,n){return(0,s.jsx)("span",{children:n+1})}},{title:"ID",dataIndex:"nftId",key:"nftId",search:!1,render:function(e,t){return(0,s.jsxs)("div",{children:["#",t.nftId]})}},{title:"状态",dataIndex:"status",key:"status",filters:[{text:"可买",value:"buy"},{text:"已售",value:"sell"},{text:"可拆分",value:"split"},{text:"可销毁",value:"burn"}],onFilter:function(e,t){return"buy"===e?t.status.includes("可买"):"sell"===e?"已售"===t.status:"split"===e?"可拆分"===t.status:"burn"!==e||t.status.includes("可销毁")},sorter:function(e,t){return e.status.localeCompare(t.status)},search:!1,render:function(e,t){return(0,s.jsx)("div",{children:t.status})}},{title:"持有者(".concat(T,")"),dataIndex:"ownerPubkey",key:"ownerPubkey",filters:j,onFilter:function(e,t){return e===t.ownerPubkey},sorter:function(e,t){return e.ownerPubkey.localeCompare(t.ownerPubkey)},render:function(e,t){return(0,s.jsx)(M.VU,{ellipsis:!0,content:t.ownerPubkey,copyable:{tooltips:!1,text:t.ownerPubkey},chain:l})}},{title:"投入成本(".concat(L.toFixed(0),")"),dataIndex:"invest",key:"invest",sorter:function(e,t){return e.invest-t.invest},search:!1,render:function(e,t){return(0,s.jsx)("div",{children:(0,R.uf)(t.invest/K.LAMPORTS_PER_SOL,6)})}},{title:"当前价格(".concat(N.toFixed(0),")"),dataIndex:"price",key:"price",sorter:function(e,t){return e.price-t.price},search:!1,render:function(e,t){return(0,s.jsx)("div",{children:(0,R.uf)(t.price/K.LAMPORTS_PER_SOL,6)})}},{title:"卖出利润(".concat(y.profitRate.toFixed(2),"%)"),dataIndex:"profit",key:"profit",sorter:function(e,t){return e.profit-t.profit},search:!1,render:function(e,t){return(0,s.jsx)("div",{children:(0,R.uf)(t.profit/K.LAMPORTS_PER_SOL,6)})}},{title:"购买时间",dataIndex:"lastTrade",key:"lastTrade",sorter:function(e,t){return t.lastTradeLocalValue-e.lastTradeLocalValue},search:!1,render:function(e,t){return(0,s.jsx)("div",{children:t.lastTradeLocalFormat})}},{title:"销毁时间",dataIndex:"lastTrade",key:"lastTrade",sorter:function(e,t){return t.burnTimeLocalValue-e.burnTimeLocalValue},search:!1,render:function(e,t){return(0,s.jsx)("div",{children:t.burnTimeLocalFormat})}},{title:"销毁倒计时",dataIndex:"lastTrade",key:"lastTrade",search:!1,render:function(e,t){return(0,s.jsx)(f,{value:t.burnTimeLocalValue})}}]}),[L,j,T,N,y]);return(0,s.jsxs)("div",{className:"ppp-tab-nft",children:[(0,s.jsx)(x.Z,{loading:{spinning:C,size:"large"},scroll:{x:!0},size:"small",columns:V,dataSource:p,defaultData:[],search:{defaultCollapsed:!1,layout:"horizontal",labelWidth:"auto",collapseRender:!1,className:"p-[0px]",optionRender:function(e,n,r){return[r[1],(0,s.jsx)(w.ZP,{type:"primary",onClick:function(){t(y.mintPubkey),D([])},children:"更新"},"update"),r[0]]}},rowSelection:{type:"checkbox",selectedRowKeys:O,onChange:function(e){D(e)}},onSubmit:A,onReset:B,options:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1}),!!O.length&&(0,s.jsxs)(g.Z.Group,{trigger:"click",type:"primary",style:{insetInlineEnd:50},icon:(0,s.jsx)(v.Z,{}),children:[(0,s.jsx)(g.Z,{type:"primary",description:"购买",onClick:F},"1"),(0,s.jsx)(g.Z,{type:"primary",description:"拆分",onClick:I},"2"),(0,s.jsx)(g.Z,{type:"primary",description:"销毁",onClick:H},"3")]}),i]})},_=(0,r.memo)(N);C().extend(L());var E=function(e){var t=(0,k.useDispatch)(),n=(0,k.useSelector)((function(e){return e.wallet.chain})),o=(0,k.useSelector)((function(e){return e.ppp.currentProjectNftsRankDataSourceReset})),u=(0,k.useSelector)((function(e){return e.ppp.currentProjectNftsRankDataSource})),a=(0,k.useSelector)((function(e){return e.ppp.currentProjectNftsStatus})),c=(0,k.useSelector)((function(e){return e.ppp.currentProjectDataSource})),i=(0,k.useSelector)((function(e){return e.ppp.currentProjectNftsLoading})),l=(0,r.useMemo)((function(){var e=new Set;u.forEach((function(t){e.add(t.owner)}));var t,n=[],r=b()(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push({text:o,value:o})}}catch(e){r.e(e)}finally{r.f()}return n}),[u]),f=(0,r.useMemo)((function(){var e=new Set;return u.forEach((function(t){e.add(t.owner)})),e.size}),[u]),p=(0,r.useMemo)((function(){var e=0;return u.forEach((function(t){e+=t.invest})),e/K.LAMPORTS_PER_SOL}),[u]),d=(0,r.useMemo)((function(){var e=0;return u.forEach((function(t){e+=t.profit})),e/K.LAMPORTS_PER_SOL}),[u]),h=(0,r.useMemo)((function(){var e=0;return u.forEach((function(t){e+=t.balance})),e/K.LAMPORTS_PER_SOL}),[u]),m=(0,r.useCallback)((function(e){var n=e.owner,r=u.filter((function(e){return e.owner===n}));t(P.N.setCurrentProjectNftsRankDataSource(r))}),[u]),y=(0,r.useCallback)((function(){t(P.N.setCurrentProjectNftsRankDataSource(o))}),[o]),v=(0,r.useCallback)((function(t,n,r){return[r[1],(0,s.jsx)(w.ZP,{type:"primary",onClick:function(){e.handleCurrentProjectNfts(c.mintPubkey)},children:"更新"},"update"),r[0]]}),[e,c]),S=(0,r.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",search:!1,render:function(e,t,n){return(0,s.jsx)("span",{children:n+1})}},{title:"持有者(".concat(f,")"),dataIndex:"owner",key:"owner",filters:l,onFilter:function(e,t){return e===t.owner},sorter:function(e,t){return e.owner.localeCompare(t.owner)},render:function(e,t){return(0,s.jsx)(M.VU,{ellipsis:!0,content:t.owner,copyable:{tooltips:!1,text:t.owner},chain:n})}},{title:"持有数量(".concat(a.nftNumber,")"),dataIndex:"number",key:"number",sorter:function(e,t){return e.number-t.number},search:!1,render:function(e,t){return(0,s.jsx)("div",{children:t.number})}},{title:"持有占比",dataIndex:"percent",key:"percent",search:!1,render:function(e,t){return(0,s.jsxs)("div",{children:[t.percent.toFixed(2),"%"]})}},{title:"账号余额(".concat(h.toFixed(4),")"),dataIndex:"balance",key:"balance",search:!1,render:function(e,t){return(0,s.jsx)("div",{children:(0,R.uf)(t.balance/K.LAMPORTS_PER_SOL,6)})}},{title:"投入成本(".concat(p.toFixed(4),")"),dataIndex:"invest",key:"invest",sorter:function(e,t){return e.invest-t.invest},search:!1,render:function(e,t){return(0,s.jsx)("div",{children:(0,R.uf)(t.invest/K.LAMPORTS_PER_SOL,6)})}},{title:"卖出利润(".concat(d.toFixed(4),")"),dataIndex:"profit",key:"profit",sorter:function(e,t){return e.profit-t.profit},search:!1,render:function(e,t){return(0,s.jsx)("div",{children:(0,R.uf)(t.profit/K.LAMPORTS_PER_SOL,6)})}}]}),[l,f,d,f,a,h,n]);return(0,s.jsxs)("div",{className:"ppp-tab-rank mt-3",children:[(0,s.jsx)("div",{className:"font-semibold text-base hardline ml-2",children:"持有者排名"}),(0,s.jsx)(x.Z,{loading:{spinning:i,size:"large"},scroll:{x:!0},size:"small",columns:S,dataSource:u,defaultData:[],search:{defaultCollapsed:!1,layout:"horizontal",labelWidth:"auto",collapseRender:!1,className:"p-[0px]",optionRender:v},onSubmit:m,onReset:y,options:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1})]})},O=(0,r.memo)(E)},69988:function(e,t,n){n.d(t,{EA:function(){return w},VY:function(){return b},mW:function(){return m}});var r=n(15009),o=n.n(r),u=n(5574),a=n.n(u),c=n(99289),i=n.n(c),s=n(9669),l=n.n(s),f=n(93233),p=n(58467),d=n(45423),h=n(48764).Buffer;function m(e){return y.apply(this,arguments)}function y(){return(y=i()(o()().mark((function e(t){var n,r,u,a,c,i,s,f,p;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=100,r=1,u="",a="",c=[],t&&(n=t.limit?t.limit:100,r=t.page?t.page:1,u=t.keyword?t.keyword:"",a=t.sort?t.sort:"");case 7:return e.next=10,l().get("https://api.ppp.fun/projects?limit=".concat(n,"&page=").concat(r,"&keyword=").concat(u,"&sort=").concat(a));case 10:if(200===(i=e.sent).status&&i.data.success){e.next=13;break}throw Error("获取projects数据失败");case 13:if(s=i.data,f=s.data,p=s.meta,f.forEach((function(e){return c.push(e)})),!p.has_more){e.next=18;break}return r+=1,e.abrupt("continue",7);case 18:return e.abrupt("break",21);case 21:return e.abrupt("return",c);case 24:throw e.prev=24,e.t0=e.catch(0),Error("获取SOL价格失败");case 27:case"end":return e.stop()}}),e,null,[[0,24]])})))).apply(this,arguments)}function b(e){return P.apply(this,arguments)}function P(){return(P=i()(o()().mark((function e(t){var n,r,u,a,c,i,s,f,p,d,h,m;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n="",r=200,u=1,a="",c="",i="",s="",f=[],t&&(r=t.limit?t.limit:200,u=t.page?t.page:1,a=t.keyword?t.keyword:"",c=t.sort?t.sort:"",i=t.nft_id?t.nft_id:"",s=t.owner_pubkey?t.owner_pubkey:"",n=t.mintPubkey);case 10:return e.next=13,l().get("https://api.ppp.fun/project/".concat(n,"/nfts?limit=").concat(r,"&page=").concat(u,"&keyword=").concat(a,"&sort=").concat(c,"&nft_id=").concat(i,"&owner_pubkey=").concat(s));case 13:if(200===(p=e.sent).status&&p.data.success){e.next=16;break}throw Error("获取projectNfts数据失败");case 16:if(d=p.data,h=d.data,m=d.meta,h.forEach((function(e){return f.push(e)})),!m.has_more){e.next=21;break}return u+=1,e.abrupt("continue",10);case 21:return e.abrupt("break",24);case 24:return e.abrupt("return",f);case 27:throw e.prev=27,e.t0=e.catch(0),Error("获取projectNfts数据失败");case 30:case"end":return e.stop()}}),e,null,[[0,27]])})))).apply(this,arguments)}function v(e,t,n){var r=t,o=n,u=[h.from("pool"),new f.PublicKey(e).toBuffer(),new f.PublicKey(r).toBuffer(),new f.PublicKey(o).toBuffer()],c=new f.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),i=f.PublicKey.findProgramAddressSync(u,c);return a()(i,1)[0]}function x(e,t){var n=[h.from("pool_vault"),new f.PublicKey(e).toBuffer(),new f.PublicKey(t).toBuffer()],r=new f.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),o=f.PublicKey.findProgramAddressSync(n,r);return a()(o,1)[0]}function k(){var e=[h.from("vault_and_lp_mint_auth_seed")],t=new f.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),n=f.PublicKey.findProgramAddressSync(e,t);return a()(n,1)[0]}function S(e){var t=[h.from("observation"),new f.PublicKey(e).toBuffer()],n=new f.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),r=f.PublicKey.findProgramAddressSync(t,n);return a()(r,1)[0]}function w(e,t,n,r,o){return g.apply(this,arguments)}function g(){return(g=i()(o()().mark((function e(t,n,r,u,a){var c,i,s,l,h,m,y,b,P,w,g,j,C,T,L,M,R,K,N,_,E,O,D,A,B,F,I,H;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=p.Gd.toString(),s=a.mintPubkey,l=a.authorityPubkey,h=a.projectPubkey,"CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C",m=u.toString(),y=k().toString(),P=v(b="D4FPEruKEHrG5TenZ2mpDGEfu1iUvTiqBxvpU8HLBvC2",i,s).toString(),w=(0,d.MO)(p.Gd,new f.PublicKey(l),!0).toString(),g=(0,d.MO)(new f.PublicKey(s),new f.PublicKey(l),!0).toString(),j=x(P,i).toString(),C=x(P,s).toString(),T=p.H_.toString(),L=p.H_.toString(),M=i,R=s,K=S(P).toString(),N=f.SystemProgram.programId.toString(),_=p.H_.toString(),E=h,O=n,D=r,A=i,B=(0,d.MO)(p.Gd,new f.PublicKey(l),!0).toString(),"DFShmtUPnJaxKSX6wg2zbyWEAVs9HuBeKNeGihg8o2oV",F={cpSwapProgram:"CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C",payer:m,authority:y,ammConfig:b,poolState:P,inputTokenAccount:w,outputTokenAccount:g,inputVault:j,outputVault:C,inputTokenProgram:T,outputTokenProgram:L,inputTokenMint:M,outputTokenMint:R,observationState:K,systemProgram:N,tokenProgram:_,project:E,nft:O,currentOwner:D,wsolMint:A,poolWsolVault:B,poolAuth:l,protocolFee:"DFShmtUPnJaxKSX6wg2zbyWEAVs9HuBeKNeGihg8o2oV"},I=[],e.next=31,(c=t.methods).buy.apply(c,I).accounts(F).instruction();case 31:return H=e.sent,e.abrupt("return",H);case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);