"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[829],{11369:function(e,t,r){r.r(t);var n=r(64599),s=r.n(n),a=r(15009),c=r.n(a),u=r(99289),l=r.n(u),o=r(5574),i=r.n(o),p=r(40956),d=r(64119),f=r(39380),m=r(38345),x=r(74273),j=r(88026),N=r(2453),b=r(7134),h=r(34041),v=r(74330),y=r(38703),k=r(71230),P=r(15746),S=r(27484),g=r.n(S),C=r(70178),w=r.n(C),R=r(67294),L=(r(8849),r(28704)),V=r(39678),Z=r(65267),U=r(54306),D=r(85893);g().extend(w());t.default=function(){var e=(0,j.useDispatch)(),t=N.ZP.useMessage(),r=i()(t,2),n=r[0],a=r[1],u=(0,R.useState)(!0),o=i()(u,2),S=o[0],C=o[1],w=(0,U.O)().publicKey,T=(0,j.useSelector)((function(e){return e.ppp.projectsDataSourceV1})),I=(0,j.useSelector)((function(e){return e.ppp.projectsOptionV1})),O=(0,j.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV1})),z=(0,R.useState)({burnNumber:0,buyNumber:0,sellNumber:0,splitNumber:0,nftNumber:0}),B=i()(z,2),F=B[0],M=B[1],E=(0,R.useState)([]),A=i()(E,2),H=A[0],K=A[1],W=(0,R.useState)({projectPubkey:"",bump:0,creatorPubkey:"",mintPubkey:"",authorityPubkey:"",projectName:"",projectDesc:"",tokenSymbol:"",tokenUri:"",initTokenSupply:0,maxTokenSupply:0,initNftSupply:0,maxNftSupply:0,tokenPerNft:0,initNftPrice:0,increasePerRound:0,tradeFeeRate:0,secPerRound:0,secToBurnNft:0,nftId:0,aid:0,nftIssueCount:0,nftBurnCount:0,round:0,lastRound:0,createTime:"",unixTs:0,imageUrl:"",nftName:"",nftImageUrl:"",bgmUrl:"",website:"",twitter:"",telegram:"",discord:"",marketCap:0,fdv:0,circulationSupply:0,updatedAt:"",projectMint:"",volume24h:0,tx24h:0,key:0,nftSupply:0,splitNftPrice:0,profitRate:0,profitRateYear:0,profitRateMonth:0,profitRateDay:0,nextRoundLocalValue:0,nextRoundLocalFormat:"",lastRoundLocalFormat:"",lastRoundLocalValue:0,createTimeLocalFormat:"",createTimeLocalValue:0}),Y=i()(W,2),_=Y[0],q=Y[1],G=(0,R.useState)(0),J=i()(G,2),Q=J[0],X=J[1],$=(0,R.useRef)(0),ee=(0,R.useCallback)(function(){var t=l()(c()().mark((function t(r){var s;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{s=[],r.forEach((function(e){var t=e.nftImageUrl,r=e.tokenSymbol,n=e.projectName,a=e.mintPubkey;s.push({value:a,label:(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)(b.C,{className:"mr-2",size:"default",src:t}),(0,D.jsx)("div",{children:"".concat(r," - ").concat(n)})]}),(0,D.jsx)(V.k,{ellipsis:!0,tooltip:!1,address:a})]}),nftImageUrl:t,projectName:n,tokenSymbol:r,mintPubkey:a})})),e(p.N.setProjectsOptionV1(s))}catch(e){(0,d.Tv)(e,n,"handleProjectsOption")}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),te=(0,R.useCallback)((function(e){if(e<0)$.current=100,X(100);else{var t=1e3*_.secPerRound,r=(t-e)/t*100,n=Math.ceil(r);n!==$.current&&($.current=n,X(r))}}),[_]),re=(0,R.useCallback)((function(e,t){var r,n=0,a=0,c=0,u=0,l=e.length,o=t.secToBurnNft,i=t.secPerRound,p=t.splitNftPrice,d=t.lastRoundLocalValue,f=[],m=[],x=s()(e);try{for(x.s();!(r=x.n()).done;){var j=r.value,N=g()().valueOf(),b=j.lastTradeLocalValue,h=1e3*o,v=1e3*i;j.price>=p&&(u+=1,f.push(j)),N-b>h&&(n+=1,m.push(j)),d>b||N-d>v?a+=1:c+=1}}catch(e){x.e(e)}finally{x.f()}return M({burnNumber:n,buyNumber:a,sellNumber:c,splitNumber:u,nftNumber:l}),{currentProjectUserSplitNftsDataSource:f,currentProjectUserBurnNftsSplitDataSource:m}}),[]),ne=(0,R.useCallback)(function(){var t=l()(c()().mark((function t(r,s){var a,u,l,o,i,f;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e(p.N.setCurrentProjectNftsLoadingV1(!0)),a=T.find((function(e){return e.mintPubkey===r})),t.next=7,(0,L.LE)(r,a);case 7:u=t.sent,l=u.currentProjectNftsDataSource,o=l.filter((function(e){return e.ownerPubkey===s})),i=re(o,a),f=i.currentProjectUserSplitNftsDataSource,K(f),q(a),e(p.N.setCurrentProjectNftsLoadingV1(!1)),$.current=0,X(0),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(2),e(p.N.setCurrentProjectNftsLoadingV1(!1)),(0,d.Tv)(t.t0,n,"handleCurrentProjectUserNfts");case 22:case"end":return t.stop()}}),t,null,[[2,18]])})));return function(e,r){return t.apply(this,arguments)}}(),[T]),se=(0,R.useCallback)(l()(c()().mark((function t(){var r,s,a;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,C(!0),t.next=4,(0,L.p5)();case 4:return r=t.sent,s=r.projects,a=r.projectsDataSource,t.next=9,ee(a);case 9:e(p.N.setProjectsV1(s)),e(p.N.setProjectsDataSourceV1(a)),C(!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),C(!1),(0,d.Tv)(t.t0,n,"handleProjects");case 18:case"end":return t.stop()}}),t,null,[[0,14]])}))),[]);return(0,R.useEffect)((function(){se()}),[]),(0,D.jsxs)(f._z,{className:"projects",ghost:!0,children:[(0,D.jsx)(h.Z,{loading:S,size:"large",style:{width:"100%"},className:"mb-3",defaultValue:null!=_&&_.mintPubkey?_.mintPubkey:void 0,onChange:function(e){ne(e,null==w?void 0:w.toString())},placeholder:"请选择项目",showSearch:!0,filterOption:function(e,t){return(t.projectName+t.tokenSymbol).toLowerCase().includes(e.toLowerCase())},options:I,optionRender:function(e){var t=e.data,r=t.projectName,n=t.tokenSymbol,s=t.nftImageUrl,a=t.mintPubkey;return(0,D.jsxs)("div",{className:"flex items-center justify-between",children:[(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)(b.C,{className:"mr-2",size:"default",src:s}),(0,D.jsx)("div",{children:"".concat(n," - ").concat(r)})]}),(0,D.jsx)(V.k,{ellipsis:!0,tooltip:!1,address:a})]})}}),(0,D.jsxs)(v.Z,{size:"large",spinning:O,children:[(0,D.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,D.jsx)("div",{children:"下一轮倒计时："}),(0,D.jsx)(Z.Wo,{className:"mr-2 font-medium text-base",value:_?_.nextRoundLocalValue:0,onChange:te}),(0,D.jsx)("div",{className:" text-base",children:_?_.nextRoundLocalFormat:""})]}),(0,D.jsx)(y.Z,{percent:Q,showInfo:!1}),(0,D.jsx)(m.Z,{headerBordered:!0,headStyle:{justifyContent:"center"},className:"mb-3",children:(0,D.jsxs)(k.Z,{gutter:10,children:[(0,D.jsx)(P.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,D.jsx)(x.Z,{layout:"center",statistic:{title:(0,D.jsx)("div",{className:"text-center",children:"持有量"}),value:F.nftNumber}})}),(0,D.jsx)(P.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,D.jsx)(x.Z,{layout:"center",statistic:{title:(0,D.jsx)("div",{className:"text-center",children:"可买 / 已售"}),value:"".concat(F.buyNumber," / ").concat(F.sellNumber)}})}),(0,D.jsx)(P.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,D.jsx)(x.Z,{layout:"center",statistic:{title:(0,D.jsx)("div",{className:"text-center",children:"可拆分"}),value:F.splitNumber}})}),(0,D.jsx)(P.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,D.jsx)(x.Z,{layout:"center",statistic:{title:(0,D.jsx)("div",{className:"text-center",children:"可销毁"}),value:F.burnNumber}})})]})})]}),(0,D.jsx)(m.Z,{children:(0,D.jsx)(Z.ZH,{handleCurrentProjectUserNfts:ne,currentProjectUserNftsDataSource:H,currentProjectDataSource:_,kind:"split"})}),a]})}},8849:function(){}}]);