(self.webpackChunk=self.webpackChunk||[]).push([[430],{17958:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return ht}});var r=n(15009),a=n.n(r),o=n(99289),s=n.n(o),c=n(5574),i=n.n(c),l=n(40956),u=n(64119),d=n(90930),f=n(38345),p=n(4942),m=n(1413),h=n(91),x=n(21532),v=n(93967),b=n.n(v),g=n(67294),y=n(63330),N=n(44962),S=n(64847),j=function(t){return(0,p.Z)({},t.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:t.marginLG,marginInline:0,color:t.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};var w=n(85893),k=function(t){var e=t.className,n=t.style,r=void 0===n?{}:n,a=t.children,o=(0,(0,g.useContext)(x.ZP.ConfigContext).getPrefixCls)("pro-card-operation"),s=function(t){return(0,S.Xj)("ProCardOperation",(function(e){var n=(0,m.Z)((0,m.Z)({},e),{},{componentCls:".".concat(t)});return[j(n)]}))}(o),c=s.wrapSSR,i=s.hashId,l=b()(o,e,i);return c((0,w.jsx)("div",{className:l,style:r,children:a}))},C=n(25035),_=n(83062),P=n(40411),O=n(57838),R=n(96159),D=n(64217),Z=n(53124),$=n(48054);var E=t=>{const{value:e,formatter:n,precision:r,decimalSeparator:a,groupSeparator:o="",prefixCls:s}=t;let c;if("function"==typeof n)c=n(e);else{const t=String(e),n=t.match(/^(-?)(\d*)(\.(\d+))?$/);if(n&&"-"!==t){const t=n[1];let e=n[2]||"0",i=n[4]||"";e=e.replace(/\B(?=(\d{3})+(?!\d))/g,o),"number"==typeof r&&(i=i.padEnd(r,"0").slice(0,r>0?r:0)),i&&(i=`${a}${i}`),c=[g.createElement("span",{key:"int",className:`${s}-content-value-int`},t,e),i&&g.createElement("span",{key:"decimal",className:`${s}-content-value-decimal`},i)]}else c=t}return g.createElement("span",{className:`${s}-content-value`},c)},T=n(14747),F=n(83559),M=n(83262);const U=t=>{const{componentCls:e,marginXXS:n,padding:r,colorTextDescription:a,titleFontSize:o,colorTextHeading:s,contentFontSize:c,fontFamily:i}=t;return{[e]:Object.assign(Object.assign({},(0,T.Wf)(t)),{[`${e}-title`]:{marginBottom:n,color:a,fontSize:o},[`${e}-skeleton`]:{paddingTop:r},[`${e}-content`]:{color:s,fontSize:c,fontFamily:i,[`${e}-content-value`]:{display:"inline-block",direction:"ltr"},[`${e}-content-prefix, ${e}-content-suffix`]:{display:"inline-block"},[`${e}-content-prefix`]:{marginInlineEnd:n},[`${e}-content-suffix`]:{marginInlineStart:n}}})}};var I=(0,F.I$)("Statistic",(t=>{const e=(0,M.IX)(t,{});return[U(e)]}),(t=>{const{fontSizeHeading3:e,fontSize:n}=t;return{titleFontSize:n,contentFontSize:e}})),Y=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]])}return n};var z=t=>{const{prefixCls:e,className:n,rootClassName:r,style:a,valueStyle:o,value:s=0,title:c,valueRender:i,prefix:l,suffix:u,loading:d=!1,formatter:f,precision:p,decimalSeparator:m=".",groupSeparator:h=",",onMouseEnter:x,onMouseLeave:v}=t,y=Y(t,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:N,direction:S,statistic:j}=g.useContext(Z.E_),w=N("statistic",e),[k,C,_]=I(w),P=g.createElement(E,{decimalSeparator:m,groupSeparator:h,prefixCls:w,formatter:f,precision:p,value:s}),O=b()(w,{[`${w}-rtl`]:"rtl"===S},null==j?void 0:j.className,n,r,C,_),R=(0,D.Z)(y,{aria:!0,data:!0});return k(g.createElement("div",Object.assign({},R,{className:O,style:Object.assign(Object.assign({},null==j?void 0:j.style),a),onMouseEnter:x,onMouseLeave:v}),c&&g.createElement("div",{className:`${w}-title`},c),g.createElement($.Z,{paragraph:!1,loading:d,className:`${w}-skeleton`},g.createElement("div",{style:o,className:`${w}-content`},l&&g.createElement("span",{className:`${w}-content-prefix`},l),i?i(P):P,u&&g.createElement("span",{className:`${w}-content-suffix`},u)))))};const H=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function B(t,e){const{format:n=""}=e,r=new Date(t).getTime(),a=Date.now();return function(t,e){let n=t;const r=/\[[^\]]*]/g,a=(e.match(r)||[]).map((t=>t.slice(1,-1))),o=e.replace(r,"[]"),s=H.reduce(((t,e)=>{let[r,a]=e;if(t.includes(r)){const e=Math.floor(n/a);return n-=e*a,t.replace(new RegExp(`${r}+`,"g"),(t=>{const n=t.length;return e.toString().padStart(n,"0")}))}return t}),o);let c=0;return s.replace(r,(()=>{const t=a[c];return c+=1,t}))}(Math.max(r-a,0),n)}var V=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]])}return n};const L=t=>{const{value:e,format:n="HH:mm:ss",onChange:r,onFinish:a}=t,o=V(t,["value","format","onChange","onFinish"]),s=(0,O.Z)(),c=g.useRef(null),i=()=>{const t=function(t){return new Date(t).getTime()}(e);t>=Date.now()&&(c.current=setInterval((()=>{s(),null==r||r(t-Date.now()),t<Date.now()&&(null==a||a(),c.current&&(clearInterval(c.current),c.current=null))}),33.333333333333336))};g.useEffect((()=>(i(),()=>{c.current&&(clearInterval(c.current),c.current=null)})),[e]);return g.createElement(z,Object.assign({},o,{value:e,valueRender:t=>(0,R.Tm)(t,{title:void 0}),formatter:(t,e)=>B(t,Object.assign(Object.assign({},e),{format:n}))}))};var A=g.memo(L);z.Countdown=A;var X=z,G=function(t){return(0,p.Z)({},t.componentCls,(0,p.Z)((0,p.Z)((0,p.Z)((0,p.Z)((0,p.Z)({display:"flex",fontSize:t.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,p.Z)({display:"flex",width:"100%"},"".concat(t.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":(0,p.Z)({width:"100%"},"".concat(t.antCls,"-statistic-content"),{"&-value-int":{fontSize:t.fontSizeHeading3}}),"&-description":{width:"100%"}},"".concat(t.antCls,"-statistic-title"),{color:t.colorText}),"&-trend-up",(0,p.Z)({},"".concat(t.antCls,"-statistic-content"),(0,p.Z)({color:"#f5222d"},"".concat(t.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),"&-trend-down",(0,p.Z)({},"".concat(t.antCls,"-statistic-content"),(0,p.Z)({color:"#389e0d"},"".concat(t.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),"& &-layout-horizontal",(0,p.Z)((0,p.Z)((0,p.Z)({display:"flex",justifyContent:"space-between"},"".concat(t.antCls,"-statistic-title"),{marginBlockEnd:0}),"".concat(t.antCls,"-statistic-content-value"),{fontWeight:500}),"".concat(t.antCls,"-statistic-title,").concat(t.antCls,"-statistic-content,").concat(t.antCls,"-statistic-content-suffix,").concat(t.antCls,"-statistic-content-prefix,").concat(t.antCls,"-statistic-content-value-decimal"),{fontSize:t.fontSize})),"& &-layout-inline",(0,p.Z)((0,p.Z)((0,p.Z)({display:"inline-flex",color:t.colorTextSecondary},"".concat(t.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),"".concat(t.antCls,"-statistic-content"),{color:t.colorTextSecondary}),"".concat(t.antCls,"-statistic-title,").concat(t.antCls,"-statistic-content,").concat(t.antCls,"-statistic-content-suffix,").concat(t.antCls,"-statistic-content-prefix,").concat(t.antCls,"-statistic-content-value-decimal"),{fontSize:t.fontSizeSM})))};var W=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],K=function(t){var e=t.className,n=t.layout,r=void 0===n?"inline":n,a=t.style,o=t.description,s=(t.children,t.title),c=t.tip,i=t.status,l=t.trend,u=t.prefix,d=t.icon,f=(0,h.Z)(t,W),v=(0,(0,g.useContext)(x.ZP.ConfigContext).getPrefixCls)("pro-card-statistic"),y=function(t){return(0,S.Xj)("Statistic",(function(e){var n=(0,m.Z)((0,m.Z)({},e),{},{componentCls:".".concat(t)});return[G(n)]}))}(v),N=y.wrapSSR,j=y.hashId,k=b()(v,e,j),O=b()("".concat(v,"-status"),j),R=b()("".concat(v,"-icon"),j),D=b()("".concat(v,"-wrapper"),j),Z=b()("".concat(v,"-content"),j),$=b()(j,(0,p.Z)((0,p.Z)({},"".concat(v,"-layout-").concat(r),r),"".concat(v,"-trend-").concat(l),l)),E=c&&(0,w.jsx)(_.Z,{title:c,children:(0,w.jsx)(C.Z,{className:"".concat(v,"-tip ").concat(j).trim()})}),T=b()("".concat(v,"-trend-icon"),j,(0,p.Z)({},"".concat(v,"-trend-icon-").concat(l),l)),F=l&&(0,w.jsx)("div",{className:T}),M=i&&(0,w.jsx)("div",{className:O,children:(0,w.jsx)(P.Z,{status:i,text:null})}),U=d&&(0,w.jsx)("div",{className:R,children:d});return N((0,w.jsxs)("div",{className:k,style:a,children:[U,(0,w.jsxs)("div",{className:D,children:[M,(0,w.jsxs)("div",{className:Z,children:[(0,w.jsx)(X,(0,m.Z)({title:(s||E)&&(0,w.jsxs)(w.Fragment,{children:[s,E]}),prefix:(F||u)&&(0,w.jsxs)(w.Fragment,{children:[F,u]}),className:$},f)),o&&(0,w.jsx)("div",{className:"".concat(v,"-description ").concat(j).trim(),children:o})]})]})]}))},q=function(t){return(0,p.Z)({},t.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,p.Z)({flexDirection:"row"},"".concat(t.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(t.colorBorder)}})};var J=["children","statistic","className","chart","chartPlacement","footer"],Q=function(t){var e=t.children,n=t.statistic,r=t.className,a=t.chart,o=t.chartPlacement,s=t.footer,c=(0,h.Z)(t,J),i=(0,(0,g.useContext)(x.ZP.ConfigContext).getPrefixCls)("pro-statistic-card"),l=function(t){return(0,S.Xj)("StatisticCard",(function(e){var n=(0,m.Z)((0,m.Z)({},e),{},{componentCls:".".concat(t)});return[q(n)]}))}(i),u=l.wrapSSR,d=l.hashId,f=b()(i,r,d),v=n&&(0,w.jsx)(K,(0,m.Z)({layout:"vertical"},n)),N=b()("".concat(i,"-chart"),d,(0,p.Z)((0,p.Z)({},"".concat(i,"-chart-left"),"left"===o&&a&&n),"".concat(i,"-chart-right"),"right"===o&&a&&n)),j=a&&(0,w.jsx)("div",{className:N,children:a}),k=b()("".concat(i,"-content "),d,(0,p.Z)({},"".concat(i,"-content-horizontal"),"left"===o||"right"===o)),C=(j||v)&&("left"===o?(0,w.jsxs)("div",{className:k,children:[j,v]}):(0,w.jsxs)("div",{className:k,children:[v,j]})),_=s&&(0,w.jsx)("div",{className:"".concat(i,"-footer ").concat(d).trim(),children:s});return u((0,w.jsxs)(y.Z,(0,m.Z)((0,m.Z)({className:f},c),{},{children:[C,e,_]})))};Q.Statistic=K,Q.Divider=N.Z,Q.Operation=k,Q.isProCard=!0,Q.Group=function(t){return(0,w.jsx)(Q,(0,m.Z)({bodyStyle:{padding:0}},t))};var tt=Q,et=n(88026),nt=n(2453),rt=n(7134),at=n(34041),ot=n(74330),st=n(38703),ct=n(71230),it=n(15746),lt=n(9669),ut=n.n(lt),dt=n(27484),ft=n.n(dt),pt=n(70178),mt=n.n(pt);n(8849);ft().extend(mt());var ht=function(){var t=(0,et.useDispatch)(),e=nt.ZP.useMessage(),n=i()(e,2),r=n[0],o=n[1],c=(0,et.useSelector)((function(t){return t.ppp.projectOptions})),p=(0,et.useSelector)((function(t){return t.ppp.projectId})),m=(0,et.useSelector)((function(t){return t.ppp.projectNftSupply})),h=(0,et.useSelector)((function(t){return t.ppp.projectBuyNumber})),x=(0,et.useSelector)((function(t){return t.ppp.projectSellNumber})),v=(0,et.useSelector)((function(t){return t.ppp.projectBurnNumber})),b=(0,et.useSelector)((function(t){return t.ppp.projectSplitNumber})),y=(0,et.useSelector)((function(t){return t.ppp.projectSecPerRound})),N=(0,et.useSelector)((function(t){return t.ppp.projectNextRound})),S=(0,et.useSelector)((function(t){return t.ppp.projectNftLoading})),j=(0,et.useSelector)((function(t){return t.ppp.projectNftGrowCount})),k=(0,g.useState)(!1),C=i()(k,2),_=C[0],P=C[1],O=(0,g.useState)(0),R=i()(O,2),D=R[0],Z=R[1],$=(0,g.useRef)(0),E=((0,g.useCallback)(function(){var e=s()(a()().mark((function e(n){var o,s,c,i,d,f,p,m,h,x;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.load("dfs3protocol");case 3:return o=e.sent,s=o.table("projects"),c=o.table("stat"),e.next=8,s.all({scope:"dfs3protocol"});case 8:return i=e.sent,e.next=11,c.all({scope:"dfs3protocol"});case 11:return d=e.sent,e.next=14,ut().get("https://api.dfs.land/dfschain/pppvolume2");case 14:200!==(f=e.sent).status&&r.error("获取pppvolume2数据失败"),p=f.data,m=[],i.forEach((function(t){p.hasOwnProperty(t.id.toString())&&m.push(t)})),m.sort((function(t,e){var n=t.id.toString(),r=e.id.toString();return p[r].volume_24h-p[n].volume_24h})),h={},x=[],m.forEach((function(t){var e=t.nft_img,n=t.token_url,r=t.token_per_nft.symbol.name,a=t.id.toString(),o=t.project_name,s=t.creator.toString();h[r]=n,x.push({value:a,label:(0,w.jsxs)("div",{className:"flex items-center",children:[(0,w.jsx)("div",{className:"mr-2",children:a.padStart(3,"0")}),(0,w.jsx)(rt.C,{className:"mr-2",size:"default",src:e}),(0,w.jsxs)("div",{children:[o," @",s]})]}),desc:"".concat(a,"-").concat(o,"-").concat(s,"-").concat(e)})})),t(l.N.setProjectOptions(x)),t(l.N.setStats(d)),t(l.N.setProjects(i)),t(l.N.setPPPTokenLogos(h)),P(!1),e.next=34;break;case 30:e.prev=30,e.t0=e.catch(0),P(!1),(0,u.Tv)(e.t0,r,"handleProjectOptions");case 34:case"end":return e.stop()}}),e,null,[[0,30]])})));return function(t){return e.apply(this,arguments)}}(),[]),(0,g.useCallback)((function(t){if(t<0)$.current=100,Z(100);else{var e=1e3*y,n=(e-t)/e*100,r=Math.ceil(n);r!==$.current&&($.current=r,Z(n))}}),[y]),(0,g.useCallback)((function(e,n,r,a,o){var s=[],c=n.init_nft_price.symbol,i=0,u=0,d=0,f=0,p=0;Object.keys(e).forEach((function(t,n){var r=e[t].number,o=e[t].invest,l=e[t].profit,m=a.filter((function(e){return e.account===t}))[0].balance.split(" ")[0],h=e[t].burnRewardUsdtValue,x=e[t].burnRewardDfsValue;i+=r,u+=o,d+=l,f+=1,p+=Number(m),s.push({key:n,owner:t,number:r,percent:0,invest:o,profit:l,investAsset:Asset.from(o,c).toString(),profitAsset:Asset.from(l,c).toString(),burnRewardUsdt:0,burnRewardUsdtValue:h,burnRewardDfs:0,burnRewardDfsValue:x,balance:m})})),s.forEach((function(t){t.percent=t.number/i*100})),s.sort((function(t,e){return e.number-t.number}));var m=0,h=0;if(r.forEach((function(t){m+=t.usdtValue,h+=t.dfsValue})),1===o)1===s.length?(s[0].burnRewardDfs=h/2,s[0].burnRewardUsdt=m/2):2===s.length?(s[0].burnRewardDfs=h/2,s[1].burnRewardDfs=h/10*3,s[0].burnRewardUsdt=m/2,s[1].burnRewardUsdt=m/10*3):s.length>=3&&(s[0].burnRewardDfs=h/2,s[1].burnRewardDfs=h/10*3,s[2].burnRewardDfs=h/5,s[0].burnRewardUsdt=m/2,s[1].burnRewardUsdt=m/10*3,s[2].burnRewardUsdt=m/5);else if(2===o)for(var x=0;x<s.length;++x)s[x].burnRewardDfs=s[x].burnRewardDfsValue,s[x].burnRewardUsdt=s[x].burnRewardUsdtValue;t(l.N.setProjectNftRank(s)),t(l.N.setProjectNftRankReset(s)),t(l.N.setProjectTotalHolder(f)),t(l.N.setProjectTotalInvest(u)),t(l.N.setProjectTotalProfit(d)),t(l.N.setProjectTotalBalance(p))}),[])),T=(0,g.useCallback)((function(e,n,r){var a,o,s=n.sec_per_round.toNumber(),c=ft().utc(n.last_round.toString()),i=n.init_nft_price.value,d=2*i,f=n.init_nft_price.symbol,p=n.increase_per_round.toNumber()/100,m=i*p,h=n.trade_fee_ratio.toNumber()/1e4,x=.005;n.id.toNumber();a=h/2,o=h/2;var v=[],b=[],g=0;e.forEach((function(t){var e=Number(t.current_price.split(" ")[0]);e>=d?(b.push(m),b.push(m),g+=2*m):(b.push(e),g+=e)})),v.push({key:0,time:c.local().format("YYYY-MM-DDTHH:mm:ss"),count:b.length,asset:(0,u.CE)(g.toFixed(0))+" "+f.name,tradeFee:(0,u.CE)((g*a).toFixed(0))+" "+f.name,protocolFee:(0,u.CE)((g*x).toFixed(0))+" "+f.name,rewordPool:(0,u.CE)((g*o).toFixed(0))+" "+f.name});for(var y=1;y<=j;++y){for(var N=0,S=b.length,w=0;w<S;++w){var k=b[w]*p;k>=d?(b.push(m),b[w]=m,N+=2*m):(b[w]=k,N+=k)}var C=c.add(s*y,"seconds").local().format("YYYY-MM-DDTHH:mm:ss");if(b.length>=r){v.push({key:y,time:C,count:r,asset:(0,u.CE)(N.toFixed(0))+" "+f.name,tradeFee:(0,u.CE)((N*a).toFixed(0))+" "+f.name,protocolFee:(0,u.CE)((N*x).toFixed(0))+" "+f.name,rewordPool:(0,u.CE)((N*o).toFixed(0))+" "+f.name});break}v.push({key:y,time:C,count:b.length,asset:(0,u.CE)(N.toFixed(0))+" "+f.name,tradeFee:(0,u.CE)((N*a).toFixed(0))+" "+f.name,protocolFee:(0,u.CE)((N*x).toFixed(0))+" "+f.name,rewordPool:(0,u.CE)((N*o).toFixed(0))+" "+f.name})}t(l.N.setProjectNftGrow(v))}),[j]),F=(0,g.useCallback)(function(){var e=s()(a()().mark((function e(n,o){var s,c,i,d,f,p,m,h,x;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,contractKit.load("swapswapswap");case 3:return s=e.sent,c=s.table("markets"),e.next=7,c.all();case 7:return i=e.sent,d=[],f={},o.forEach((function(t){var e=t.max_token_supply.symbol.name;f[e]=t.token_url})),p=[],"usdtusdtusdt-USDT-8",h="eosio.token-DFS-8",x=[],(m={})["usdtusdtusdt-USDT-8"]=1,m[h]=getAssetValue(i[0].reserve0)/getAssetValue(i[0].reserve1),i.forEach((function(t){var e=t.contract0.toString()+"-"+t.sym0.toString().split(",")[1]+"-"+t.sym0.toString().split(",")[0],n=t.contract1.toString()+"-"+t.sym1.toString().split(",")[1]+"-"+t.sym1.toString().split(",")[0];p.includes(e)||p.push(e),p.includes(n)||p.push(n);var r=getAssetValue(t.reserve0),a=getAssetValue(t.reserve1);"eosio.token"===t.contract0.toString()?m.hasOwnProperty(n)||(m[n]=r/a*m[h]):"eosio.token"===t.contract1.toString()?m.hasOwnProperty(e)||(m[e]=a/r*m[h]):"usdtusdtusdt"===t.contract0.toString()?m.hasOwnProperty(n)||(m[n]=r/a):"usdtusdtusdt"===t.contract1.toString()?m.hasOwnProperty(e)||(m[e]=a/r):x.push({key0:e,key1:n,value0:r,value1:a})})),x.forEach((function(t){m.hasOwnProperty(t.key0)&&!m.hasOwnProperty(t.key1)?m[t.key1]=t.value0/t.value1*m[t.key0]:!m.hasOwnProperty(t.key0)&&m.hasOwnProperty(t.key1)?m[t.key0]=t.value1/t.value0*m[t.key1]:m.hasOwnProperty(t.key0)||m.hasOwnProperty(t.key1)||(m[t.key0]=0,m[t.key1]=0)})),Object.keys(m).forEach((function(t){Number.isNaN(m[t])&&(m[t]=0)})),n.forEach((function(t,e){var n=t.cnt.toString(),r=t.balance.symbol.name,a=t.balance.symbol.precision,o=t.balance.value,s=n+"-"+r,c=m[s+"-"+a]*o,i=c/m[h],l="dfsppptokens"===n?f[r]:"https://dfs.land/assets/tokens/".concat(s,".png");d.push({key:e,sym:r,logo:l,balance:t.balance.toString(),contract:n,usdtValue:c,dfsValue:i})})),t(l.N.setProjectRewardPool(d)),t(l.N.setTokenPriceMap(m)),e.abrupt("return",d);case 27:return e.prev=27,e.t0=e.catch(0),(0,u.Tv)(e.t0,r,"handleProjectRewardPool"),e.abrupt("return",[]);case 31:case"end":return e.stop()}}),e,null,[[0,27]])})));return function(t,n){return e.apply(this,arguments)}}(),[]),M=(0,g.useCallback)((function(e,n,r){var a=0,o=0;if(!n){for(var s=0;s<e.length;++s){var c=ft().utc(e[s].last_trade).valueOf();if(c>=r){o=c;break}}for(var i=e.length-1;i>=0;--i)if(!e[i].split){a=ft().utc(e[i].last_trade).valueOf()-o+1;break}}t(l.N.setProjectEndTime(a))}),[]),U=(0,g.useCallback)(function(){var t=s()(a()().mark((function t(e){var n,o,s,c,l,d,f,p,m,h,x;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],o=2e3,s="",c="",l="","DFS"!==e){t.next=9;break}l="eosio.token",t.next=19;break;case 9:if("USDT"!==e){t.next=13;break}l="usdtusdtusdt",t.next=19;break;case 13:if("ORDI"!==e){t.next=17;break}l="ordiordiordi",t.next=19;break;case 17:return r.error("不支持当前项目"),t.abrupt("return",[]);case 19:return t.next=22,(0,u.zI)(ut().post("".concat(host,"/v2/chain/get_scope_rows"),{code:l,table:"accounts",lower_bound:s,primary_lower_bound:c,limit:o,index_position:"primary",key_type:"name"}));case 22:if(d=t.sent,f=i()(d,2),p=f[0],m=f[1],p||200!==m.status){t.next=37;break}for(h=m.data.rows,x=0;x<h.length;++x)h[x].data.balance.split(" ")[1]===e&&n.push({account:h[x].scope,balance:h[x].data.balance});if(!m.data.more){t.next=34;break}s=m.data.next_key,c=m.data.next_primary_key,t.next=35;break;case 34:return t.abrupt("break",41);case 35:t.next=39;break;case 37:return r.error(p),t.abrupt("break",41);case 39:t.next=19;break;case 41:return t.abrupt("return",n);case 42:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[r]),I=(0,g.useCallback)(function(){var e=s()(a()().mark((function e(n){var o,s,c,i,d,f,p,m,h,x,v,b,g,y,N,S,j,w,k,C,_,P,O,R,D,I,Y,z,H,B,V,L,A,X,G,W,K,q,J,Q,tt,et,nt,rt,at,ot,st,ct,it,lt,ut,dt,pt,mt,ht,xt,vt,bt,gt,yt,Nt,St,jt,wt,kt,Ct,_t,Pt,Ot,Rt;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(l.N.setProjectNftLoading(!0)),e.next=4,session.client.v1.chain.get_table_rows({code:"dfs3protocol",table:"registry",scope:"dfs3protocol",key_type:"i64",index_position:"secondary",lower_bound:UInt64.from(n),upper_bound:UInt64.from(n),limit:5e3});case 4:return o=e.sent,e.next=7,contractKit.load("dfs3protocol");case 7:return s=e.sent,e.next=10,contractKit.load("dfspppreward");case 10:return c=e.sent,i=s.table("projects"),d=s.table("stat"),f=c.table("rewardpools"),p=s.table("pooltypes"),e.next=17,i.all({scope:"dfs3protocol"});case 17:return m=e.sent,e.next=20,d.all({scope:"dfs3protocol",from:n,to:n});case 20:return h=e.sent,e.next=23,f.all({scope:n});case 23:return x=e.sent,e.next=26,p.all({scope:"dfs3protocol",from:n,to:n});case 26:for(v=e.sent,b=m.filter((function(t){return t.id.toNumber()===n}))[0],g=b.id.toNumber(),y=b.mid.toNumber(),N=b.project_name,S=b.nft_name,j=b.nft_img,w=b.desc,k=b.twitter,C=b.telegram,_=b.website,P=b.token_url,O=b.creator.toString(),R=h[0].supply.toNumber(),D=h[0].max_supply.toNumber(),I=b.init_nft_price.toString(),Y=b.init_nft_price.value,z=b.init_nft_price.symbol,B=(H=2*Y)+" "+z.name,V=b.init_nft_number.toNumber(),L=b.sec_per_round.toNumber(),A=b.sec_to_burn_nft.toNumber(),X=ft().utc(b.create_time.toString()).local().format("YYYY-MM-DDTHH:mm:ss"),G=ft().utc(b.last_round.toString()).valueOf(),W=G,K=ft().utc(b.last_round.toString()).local().format("YYYY-MM-DDTHH:mm:ss"),q=ft().utc(b.last_round.toString()).add(L,"seconds").local(),J=q.valueOf(),Q=q.format("YYYY-MM-DDTHH:mm:ss"),tt=b.init_nft_price.symbol.precision,et=b.token_per_nft.toString(),nt=b.token_per_nft.symbol.name,rt={contract:"dfsppptokens",symbol:nt,mid:y,pair:"".concat(z.name,"/").concat(nt)},at=b.increase_per_round.toNumber()/100,ot=b.trade_fee_ratio.toNumber()/1e4,0,0,st=ot/2,ct=ot/2,it=100*(at-1-at*(ot+.005)),lt=0,ut=0,dt=0,pt=0,mt=[],ht=[],xt=[],vt={},bt=Number((Y*at).toFixed(tt)),gt=Y;gt*at<H;)gt*=at;return yt=(2*bt*(1-ot-.005)-gt)/gt*100,Nt=31536e3/L*it,St=v.filter((function(t){return t.pid.toNumber()===g})),jt=2,St.length&&(jt=St[0].type.toNumber()),wt={id:g,mid:y,projectName:N,nftName:S,tokenName:z.name,tokenNameRelease:nt,nftImg:j,desc:w,twitter:k,telegram:C,website:_,tokenUrl:P,creator:O,nftSupply:R,nftMaxSupply:D,initNftPrice:I,initNftNumber:V,splitNftPrice:B,secPerRound:L/3600+" Hours",increasePerRound:(100*at-100).toFixed(2)+" %",tradeFeeRatio:100*ot+" %",tradeFeeRatioValue:ot,tradeFeeRatioWithoutRewardPool:(100*st).toFixed(2)+" %",rewordPoolFeeRatio:(100*ct).toFixed(2)+" %",secToBurnNft:A/3600+" Hours",tokenPerNft:et,createTime:X,profitRate:it.toFixed(2)+" %",profitRateSplit:yt.toFixed(2)+" %",profitRateApr:Nt.toFixed(0)+" %",poolType:jt},kt=0,Ct=0,_t=o.rows.length,e.next=89,F(x,m);case 89:return(Pt=e.sent).forEach((function(t){kt+=t.usdtValue,Ct+=t.dfsValue})),Ot=0,o.rows.sort((function(t,e){return ft()(t.last_trade).valueOf()-ft()(e.last_trade).valueOf()})),o.rows.forEach((function(t,e){var n=ft()().valueOf(),r=ft().utc(t.last_trade).valueOf(),a=1e3*A,o=1e3*L,s=Number(t.current_price.split(" ")[0]),c=t.current_round,i="";Ot+=s,s>=H?(pt+=1,i="可拆分"):(n-r>a&&(lt+=1,i="可销毁"),G>r||n-G>o?(ut+=1,i=i?"可买/"+i:"可买"):(dt+=1,i="已售"));var l=0,d=0,f=!1;s>=H?(d=gt,l=2*bt-gt-2*bt*(ot+.005)):s===bt&&c>1?(f=!0,d=gt/2,l=bt-gt/2-bt*(ot+.005)):(d=s/at,l=s*(1-1/at-ot-.005)),vt.hasOwnProperty(t.owner)||(vt[t.owner]={number:0,invest:0,profit:0,burnRewardDfsValue:0,burnRewardUsdtValue:0}),vt[t.owner].profit+=l,vt[t.owner].number+=1,vt[t.owner].invest+=d,ht.includes(t.owner)||ht.push(t.owner);var p="0 USDT",m=0,h="0 DFS",x=0;1===jt?(p="奖励前三",m=0,h="奖励前三",x=0):2===jt&&(m=2*kt/_t,x=2*Ct/_t,p=(0,u.CE)(m)+" USDT",h=(0,u.CE)(x)+" DFS",kt-=m,Ct-=x,_t-=1),vt[t.owner].burnRewardUsdtValue+=m,vt[t.owner].burnRewardDfsValue+=x,mt.push({key:t.id,id:t.id,cid:t.cid,pid:t.pid,owner:t.owner,current_round:t.current_round,current_price:t.current_price,last_trade:t.last_trade,create_time:t.create_time,profit:Asset.from(l,z).toString(),invest:Asset.from(d,z).toString(),status:i,split:f,burnRewardUsdt:p,burnRewardUsdtValue:m,burnRewardDfs:h,burnRewardDfsValue:x})})),e.next=96,U(z.name);case 96:Rt=e.sent,E(vt,b,Pt,Rt,jt),T(mt,b,h[0].max_supply.toNumber()),ht.sort(),ht.forEach((function(t){xt.push({text:t,value:t})})),M(mt,ut,W),t(l.N.setProjectNextRound({value:J,text:Q})),t(l.N.setProjectLastRound({value:W,text:K})),t(l.N.setProjectSecToBurnNft(A)),t(l.N.setProjectNftSupply(R)),t(l.N.setProjectBurnNumber(lt)),t(l.N.setProjectBuyNumber(ut)),t(l.N.setProjectSellNumber(dt)),t(l.N.setProjectSplitNumber(pt)),t(l.N.setProjectNft(mt)),t(l.N.setProjectNftReset(mt)),t(l.N.setProjectId(n)),t(l.N.setProjectTotalValue(Ot)),t(l.N.setProjectSecPerRound(L)),t(l.N.setProjectAccountFilter(xt)),t(l.N.setProjectNftLoading(!1)),t(l.N.setProjectProfitRate(it)),t(l.N.setProjectProfitRateSplit(yt)),t(l.N.setProject(wt)),t(l.N.setProjectToken(rt)),$.current=0,Z(0),e.next=129;break;case 125:e.prev=125,e.t0=e.catch(0),t(l.N.setProjectNftLoading(!1)),(0,u.Tv)(e.t0,r,"handleGetProjectNft");case 129:case"end":return e.stop()}}),e,null,[[0,125]])})));return function(t){return e.apply(this,arguments)}}(),[E,T,F,U]);return(0,w.jsxs)(d._z,{className:"projects",ghost:!0,children:[(0,w.jsx)(at.Z,{loading:_,size:"large",style:{width:"100%"},className:"mb-3",defaultValue:p?p.toString():void 0,onChange:function(t){I(Number(t))},placeholder:"请选择项目",showSearch:!0,filterOption:function(t,e){var n=e.desc.split("-"),r=i()(n,3),a=r[0],o=r[1],s=r[2];return(a.padStart(3,"0")+o+s).toLowerCase().includes(t.toLowerCase())},options:c,optionRender:function(t){var e=t.data.desc.split("-"),n=i()(e,4),r=n[0],a=n[1],o=n[2],s=n[3];return(0,w.jsxs)("div",{className:"flex items-center",children:[(0,w.jsx)("div",{className:"mr-2",children:r.padStart(3,"0")}),(0,w.jsx)(rt.C,{className:"mr-2",size:"default",src:s}),(0,w.jsxs)("div",{children:[a," @",o]})]})}}),(0,w.jsxs)(ot.Z,{size:"large",spinning:S,children:[(0,w.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,w.jsx)("div",{children:"下一轮倒计时："}),(0,w.jsx)("div",{className:" text-base",children:N.text})]}),(0,w.jsx)(st.Z,{percent:D,showInfo:!1}),(0,w.jsx)(f.Z,{headerBordered:!0,headStyle:{justifyContent:"center"},className:"mb-3",children:(0,w.jsxs)(ct.Z,{gutter:10,children:[(0,w.jsx)(it.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,w.jsx)(tt,{layout:"center",statistic:{title:(0,w.jsx)("div",{className:"text-center",children:"总量"}),value:m}})}),(0,w.jsx)(it.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,w.jsx)(tt,{layout:"center",statistic:{title:(0,w.jsx)("div",{className:"text-center",children:"可买 / 已售"}),value:"".concat(h," / ").concat(x)}})}),(0,w.jsx)(it.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,w.jsx)(tt,{layout:"center",statistic:{title:(0,w.jsx)("div",{className:"text-center",children:"可拆分"}),value:b}})}),(0,w.jsx)(it.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,w.jsx)(tt,{layout:"center",statistic:{title:(0,w.jsx)("div",{className:"text-center",children:"可销毁"}),value:v}})})]})})]}),o]})}},8849:function(){},70178:function(t){t.exports=function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,a,o){var s=a.prototype;o.utc=function(t){return new a({date:t,utc:!0,args:arguments})},s.utc=function(e){var n=o(this.toDate(),{locale:this.$L,utc:!0});return e?n.add(this.utcOffset(),t):n},s.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var c=s.parse;s.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),c.call(this,t)};var i=s.init;s.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else i.call(this)};var l=s.utcOffset;s.utcOffset=function(r,a){var o=this.$utils().u;if(o(r))return this.$u?0:o(this.$offset)?l.call(this):this.$offset;if("string"==typeof r&&(r=function(t){void 0===t&&(t="");var r=t.match(e);if(!r)return null;var a=(""+r[0]).match(n)||["-",0,0],o=a[0],s=60*+a[1]+ +a[2];return 0===s?0:"+"===o?s:-s}(r),null===r))return this;var s=Math.abs(r)<=16?60*r:r,c=this;if(a)return c.$offset=s,c.$u=0===r,c;if(0!==r){var i=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(c=this.local().add(s+i,t)).$offset=s,c.$x.$localOffset=i}else c=this.utc();return c};var u=s.format;s.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,e)},s.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()};var d=s.toDate;s.toDate=function(t){return"s"===t&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var f=s.diff;s.diff=function(t,e,n){if(t&&this.$u===t.$u)return f.call(this,t,e,n);var r=this.local(),a=o(t).local();return f.call(r,a,e,n)}}}()}}]);