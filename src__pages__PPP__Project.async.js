"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[430],{64225:function(e,t,n){n.r(t);var r=n(64599),s=n.n(r),a=n(15009),c=n.n(a),u=n(99289),o=n.n(u),l=n(5574),i=n.n(l),f=n(40956),p=n(64119),d=n(39380),m=n(38345),j=n(74273),x=n(88026),h=n(2453),N=n(7134),b=n(34041),v=n(74330),k=n(38703),y=n(71230),P=n(15746),C=n(9669),S=n.n(C),g=n(27484),w=n.n(g),V=n(70178),Z=n.n(V),R=n(67294),D=(n(8849),n(28704)),O=n(39678),L=n(65267),T=n(44718),E=n(85893);w().extend(Z());t.default=function(){var e=(0,x.useDispatch)(),t=h.ZP.useMessage(),n=i()(t,2),r=n[0],a=n[1],u=(0,R.useState)(!0),l=i()(u,2),C=l[0],g=l[1],V=(0,T.R)().connection,Z=(0,x.useSelector)((function(e){return e.ppp.projectsDataSourceV2})),z=(0,x.useSelector)((function(e){return e.ppp.currentProjectNftsStatusV2})),I=(0,x.useSelector)((function(e){return e.ppp.currentProjectDataSourceV2})),A=(0,x.useSelector)((function(e){return e.ppp.projectsOptionV2})),F=(0,x.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV2})),M=(0,R.useState)(0),U=i()(M,2),B=U[0],_=U[1],H=(0,R.useRef)(0),K=(0,R.useCallback)(function(){var t=o()(c()().mark((function t(n){var s;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{s=[],n.forEach((function(e){var t=e.nftImageUrl,n=e.tokenSymbol,r=e.projectName,a=e.mintPubkey;s.push({value:a,label:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)(N.C,{className:"mr-2",size:"default",src:t}),(0,E.jsx)("div",{children:"".concat(n," - ").concat(r)})]}),(0,E.jsx)(O.k,{ellipsis:!0,tooltip:!1,address:a})]}),nftImageUrl:t,projectName:r,tokenSymbol:n,mintPubkey:a})})),e(f.N.setProjectsOptionV2(s))}catch(e){(0,p.Tv)(e,r,"handleProjectsOption")}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),W=(0,R.useCallback)((function(e){if(e<0)H.current=100,_(100);else{var t=1e3*I.secPerRound,n=(t-e)/t*100,r=Math.ceil(n);r!==H.current&&(H.current=r,_(n))}}),[I]),q=(0,R.useCallback)((function(t,n){var r,a=0,c=0,u=0,o=0,l=n.nftSupply,i=n.secToBurnNft,p=n.secPerRound,d=n.splitNftPrice,m=n.lastRoundLocalValue,j=s()(t);try{for(j.s();!(r=j.n()).done;){var x=r.value,h=w()().valueOf(),N=w().unix(x.last_trade).utcOffset(8).valueOf(),b=1e3*i,v=1e3*p;x.price>=d&&(o+=1),h-N>b&&(a+=1),m>N||h-m>v?c+=1:u+=1}}catch(e){j.e(e)}finally{j.f()}e(f.N.setCurrentProjectNftsStatusV2({burnNumber:a,buyNumber:c,sellNumber:u,splitNumber:o,nftNumber:l}))}),[]),G=(0,R.useCallback)(function(){var t=o()(c()().mark((function t(n,s){var a,u,o,l,i,d,m;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={},s.forEach((function(e){var t=e.ownerPubkey,n=e.profit,r=e.invest;a.hasOwnProperty(t)||(a[t]={number:0,invest:0,profit:0}),a[t].profit+=n,a[t].number+=1,a[t].invest+=r})),u=[],o=0,l=Object.keys(a),t.next=8,S().post(n.rpcEndpoint,{jsonrpc:"2.0",id:1,method:"getMultipleAccounts",params:[l]});case 8:i=t.sent,d=i.data.result.value,Object.keys(a).forEach((function(e,t){var n=a[e].number,r=a[e].invest,s=a[e].profit,c=d[t]?d[t].lamports:0;o+=n,u.push({key:t,owner:e,number:n,percent:0,invest:r,profit:s,balance:c})})),u.forEach((function(e){e.percent=e.number/o*100})),m=u.sort((function(e,t){return t.number-e.number})),e(f.N.setCurrentProjectNftsRankDataSourceV2(m)),e(f.N.setCurrentProjectNftsRankDataSourceResetV2(m)),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),(0,p.Tv)(t.t0,r,"handleCurrentProjectNftsRank");case 20:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,n){return t.apply(this,arguments)}}(),[]),J=(0,R.useCallback)(function(){var t=o()(c()().mark((function t(n){var s,a,u,o;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(f.N.setCurrentProjectNftsLoadingV2(!0)),s=Z.find((function(e){return e.mintPubkey===n})),t.next=5,(0,D.D3)(n,s);case 5:a=t.sent,u=a.currentProjectNftsDataSource,o=a.currentProjectNfts,q(o,s),G(V,u),e(f.N.setCurrentProjectNftsV2(o)),e(f.N.setCurrentProjectNftsDataSourceV2(u)),e(f.N.setCurrentProjectNftsDataSourceResetV2(u)),e(f.N.setCurrentProjectDataSourceV2(s)),e(f.N.setCurrentProjectNftsLoadingV2(!1)),H.current=0,_(0),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(0),e(f.N.setCurrentProjectNftsLoadingV2(!1)),(0,p.Tv)(t.t0,r,"handleCurrentProjectNfts");case 23:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(e){return t.apply(this,arguments)}}(),[Z,V]),Q=(0,R.useCallback)(o()(c()().mark((function t(){var n,s,a;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,g(!0),t.next=4,(0,D.yC)();case 4:return n=t.sent,s=n.projects,a=n.projectsDataSource,t.next=9,K(a);case 9:e(f.N.setProjectsV2(s)),e(f.N.setProjectsDataSourceV2(a)),g(!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),g(!1),(0,p.Tv)(t.t0,r,"handleProjects");case 18:case"end":return t.stop()}}),t,null,[[0,14]])}))),[]);return(0,R.useEffect)((function(){Q()}),[]),(0,E.jsxs)(d._z,{className:"projects",ghost:!0,children:[(0,E.jsx)(b.Z,{loading:C,size:"large",style:{width:"100%"},className:"mb-3",defaultValue:I.mintPubkey?I.mintPubkey:void 0,onChange:function(e){J(e)},placeholder:"请选择项目",showSearch:!0,filterOption:function(e,t){return(t.projectName+t.tokenSymbol).toLowerCase().includes(e.toLowerCase())},options:A,optionRender:function(e){var t=e.data,n=t.projectName,r=t.tokenSymbol,s=t.nftImageUrl,a=t.mintPubkey;return(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)(N.C,{className:"mr-2",size:"default",src:s}),(0,E.jsx)("div",{children:"".concat(r," - ").concat(n)})]}),(0,E.jsx)(O.k,{ellipsis:!0,tooltip:!1,address:a})]})}}),(0,E.jsxs)(v.Z,{size:"large",spinning:F,children:[(0,E.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,E.jsx)("div",{children:"下一轮倒计时："}),(0,E.jsx)(L.Wo,{className:"mr-2 font-medium text-base",value:I.nextRoundLocalValue,onChange:W}),(0,E.jsx)("div",{className:" text-base",children:I.nextRoundLocalFormat})]}),(0,E.jsx)(k.Z,{percent:B,showInfo:!1}),(0,E.jsx)(m.Z,{headerBordered:!0,headStyle:{justifyContent:"center"},className:"mb-3",children:(0,E.jsxs)(y.Z,{gutter:10,children:[(0,E.jsx)(P.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"总量"}),value:z.nftNumber}})}),(0,E.jsx)(P.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可买 / 已售"}),value:"".concat(z.buyNumber," / ").concat(z.sellNumber)}})}),(0,E.jsx)(P.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可拆分"}),value:z.splitNumber}})}),(0,E.jsx)(P.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可销毁"}),value:z.burnNumber}})})]})})]}),(0,E.jsx)(m.Z,{tabs:{items:[{key:"nft",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"NFT市场"}),children:(0,E.jsx)(L.Af,{handleCurrentProjectNfts:J})},{key:"rank",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"NFT排名"}),children:(0,E.jsx)(L.Hm,{handleCurrentProjectNfts:J})}],defaultActiveKey:"nft"}}),a]})}},8849:function(){}}]);