"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[538],{94149:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(87462),a=n(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},s=n(84089),o=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:c}))};var l=a.forwardRef(o)},3355:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(87462),a=n(67294),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v68c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-68c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zm-40 376H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"unlock",theme:"outlined"},s=n(84089),o=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:c}))};var l=a.forwardRef(o)},43044:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var r=n(97857),a=n.n(r),c=n(64599),s=n.n(c),o=n(15009),l=n.n(o),i=n(99289),u=n.n(i),d=n(5574),f=n.n(d),p=n(9437),m=n(64119),h=n(39380),x=n(38345),k=n(64435),b=n(2453),g=n(16568),v=n(25593),y=n(83622),w=n(2058),C=n(34041),M=n(67294),j=n(38592),A=n(51941),S=n(88026),P=n(54306),N=n(44718),Z=n(70794),R=n(29363),O=n(70609),K=n(39578),W=n(27484),B=n.n(W),D=n(3355),T=n(94149),V=n(71874),H=n(85893),I=function(){var e=(0,S.useDispatch)(),t=b.ZP.useMessage(),n=f()(t,2),r=n[0],c=n[1],o=g.ZP.useNotification(),i=f()(o,2),d=i[0],W=i[1],I=(0,S.useSelector)((function(e){return e.wallet.dataSource})),z=(0,S.useSelector)((function(e){return e.wallet.wallet})),L=(0,S.useSelector)((function(e){return e.wallet.walletOptions})),U=(0,p.Ab)(),E=U.chain,F=U.modalFeeRef,_=(0,S.useSelector)((function(e){return e.wallet.locks})),Y=(0,S.useSelector)((function(e){return e.wallet.site})),q=(0,P.O)(),J=q.publicKey,$=q.signTransaction,G=q.wallet,Q=(0,N.R)().connection,X=(0,M.useState)(!1),ee=f()(X,2),te=ee[0],ne=ee[1],re=(0,M.useState)([]),ae=f()(re,2),ce=ae[0],se=ae[1],oe=(0,M.useRef)(),le=(0,M.useRef)(),ie=(0,M.useRef)(),ue=(0,M.useRef)(),de=(0,M.useRef)(),fe=(0,M.useRef)(),pe=(0,M.useRef)(),me=(0,M.useRef)(),he=(0,S.useIntl)(),xe=he.formatMessage({id:"common.intlWalletAttention"}),ke=he.formatMessage({id:"common.intlPleaseConnectWallet"}),be=he.formatMessage({id:"common.intlDelFromBackToFront"}),ge=he.formatMessage({id:"common.intlBackupSuccess"}),ve=he.formatMessage({id:"common.intlRestoreSuccess"}),ye=he.formatMessage({id:"common.intlRestoreFail"}),we=he.formatMessage({id:"common.intlSelectWallet"}),Ce=he.formatMessage({id:"common.intlDeleteAccountThenAddress"}),Me=he.formatMessage({id:"common.intlSelectAddress"}),je=he.formatMessage({id:"common.intlDeleteNonceFirst"}),Ae=he.formatMessage({id:"common.intlNoDeleteAccount"}),Se=he.formatMessage({id:"common.intlNoCreateAccount"}),Pe=he.formatMessage({id:"common.intlAddress"}),Ne=he.formatMessage({id:"common.intlBalance"}),Ze=he.formatMessage({id:"common.intlStatus"}),Re=he.formatMessage({id:"common.intlCreated"}),Oe=he.formatMessage({id:"common.intlNotCreated"}),Ke=he.formatMessage({id:"common.intlAccount"}),We=he.formatMessage({id:"common.intlNotes"}),Be=he.formatMessage({id:"common.intlCreateWallet"}),De=he.formatMessage({id:"common.intlImportWallet"}),Te=he.formatMessage({id:"common.intlCreateAddress"}),Ve=he.formatMessage({id:"common.intlDeleteAddress"}),He=he.formatMessage({id:"common.intlCreateAccount"}),Ie=he.formatMessage({id:"common.intlDeleteAccount"}),ze=he.formatMessage({id:"common.intlWalletRename"}),Le=he.formatMessage({id:"common.intlBackupWallet"}),Ue=he.formatMessage({id:"common.intlRestoreWallet"}),Ee=he.formatMessage({id:"common.intlTransferSOL"}),Fe=he.formatMessage({id:"common.intlWallet"}),_e=he.formatMessage({id:"common.intlDeleteAddressFirst"}),Ye=he.formatMessage({id:"common.intlDeleteWallet"}),qe=he.formatMessage({id:"common.intlShowMnemonic"}),Je=he.formatMessage({id:"common.intlShowPrivateKey"}),$e=he.formatMessage({id:"common.intlOperation"}),Ge=(0,M.useCallback)((function(){z?_[z]?ue.current.handleOpen():fe.current.handleOpen(z):r.error(we)}),[z,_]),Qe=(0,M.useCallback)((function(){z?_[z]?pe.current.handleOpen():fe.current.handleOpen(z):r.error(we)}),[z,_]),Xe=(0,M.useCallback)((function(e){_[z]?me.current.handleOpen(e):fe.current.handleOpen(z)}),[z,_]),et=(0,M.useCallback)((function(){z?de.current.handleOpen():r.error(we)}),[z]),tt=(0,M.useCallback)(function(){var t=u()(l()().mark((function t(n){var a,c,s,o,i,u,d,f,p;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=[],c=[],!n){t.next=17;break}return ne(!0),t.next=7,A.db.accounts.where("wallet").equals(n).sortBy("index");case 7:return c=t.sent,s=c.map((function(e){return new R.PublicKey(e.publicKey)})),o=c.map((function(e){return new R.PublicKey(e.nonce)})),t.next=12,Q.getMultipleAccountsInfo(s);case 12:return i=t.sent,t.next=15,Q.getMultipleAccountsInfo(o);case 15:for(u=t.sent,d=0;d<c.length;++d)f=i[d],p=u[d],a.push({key:d,wallet:n,hash:c[d].hash,publicKey:c[d].publicKey,secretKey:c[d].secretKey,notes:c[d].notes,nonce:c[d].nonce,created:!!f,nonceCreated:!!p,lamports:(0,Z.Z)(f?f.lamports:0)});case 17:e(j.Nw.setAccounts(c)),e(j.Nw.setDataSource(a)),ne(!1),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(0),ne(!1),(0,m.Tv)(t.t0,r,"handleUpdateAccounts");case 26:case"end":return t.stop()}}),t,null,[[0,22]])})));return function(e){return t.apply(this,arguments)}}(),[]),nt=(0,M.useCallback)(u()(l()().mark((function e(){var t,n,a,c,s;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z){e.next=3;break}return r.error(we),e.abrupt("return");case 3:if(ce.length){e.next=5;break}return e.abrupt("return",r.error(Me));case 5:e.prev=5,t=ce.toSorted().toReversed(),n=I.toReversed(),a=[],c=n.length-t.length,s=0;case 11:if(!(s<t.length)){e.next=20;break}if(t[s]===n[s].key){e.next=14;break}return e.abrupt("return",r.error("".concat(be)));case 14:if(!n[s].created){e.next=16;break}return e.abrupt("return",r.error(Ce));case 16:a.push(n[s].hash);case 17:++s,e.next=11;break;case 20:return e.next=22,A.db.accounts.bulkDelete(a);case 22:return e.next=24,A.db.wallets.update(z,{count:c});case 24:tt(z),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(5),(0,m.Tv)(e.t0,r,"handleDeleteAddress");case 30:case"end":return e.stop()}}),e,null,[[5,27]])}))),[z,ce,I]),rt=(0,M.useCallback)(u()(l()().mark((function e(){var t,n,a,c,o,i,u,f,p,h,x,k,b,g,v,y,w,C,M,j,A;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J&&$&&G){e.next=2;break}return e.abrupt("return",r.error(ke));case 2:if(ce.length){e.next=4;break}return e.abrupt("return",r.error(Me));case 4:if(_[z]){e.next=7;break}return fe.current.handleOpen(z),e.abrupt("return");case 7:e.prev=7,t=J,n=[],a=[],c=(0,m.ow)(_[z],Y),o=s()(ce),e.prev=13,o.s();case 15:if((i=o.n()).done){e.next=31;break}if(u=i.value,f=I[u].publicKey,p=I[u].created,h=I[u].nonceCreated,x=BigInt(I[u].lamports.toString()),k=(0,m.ow)(I[u].secretKey,c),b=K.Z.decode(k),g=R.Keypair.fromSecretKey(b),!p){e.next=29;break}if(!h){e.next=27;break}return e.abrupt("return",r.error(je));case 27:n.push(R.SystemProgram.transfer({fromPubkey:new R.PublicKey(f),toPubkey:t,lamports:x})),a.push(g);case 29:e.next=15;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(13),o.e(e.t0);case 36:return e.prev=36,o.f(),e.finish(36);case 39:if(n.length){e.next=41;break}return e.abrupt("return",r.info(Ae));case 41:return e.next=43,Q.getLatestBlockhash();case 43:return v=e.sent,y=v.blockhash,w=v.lastValidBlockHeight,e.next=48,(0,V.fC)(Q,G,y,n,$,F);case 48:return C=e.sent,M=C.transaction,j=C.feeMode,M.sign(a),e.next=54,(0,V.pR)(Q,G,M,j);case 54:return A=e.sent,e.next=57,(0,V.fS)(E,Q,{signature:A,blockhash:y,lastValidBlockHeight:w},"confirmed",d,r);case 57:e.sent&&tt(z),e.next=64;break;case 61:e.prev=61,e.t1=e.catch(7),(0,m.Tv)(e.t1,r,"handleCreateAccount");case 64:case"end":return e.stop()}}),e,null,[[7,61],[13,33,36,39]])}))),[ce,J,$,I,Q,E,z,_,Y,G,F]),at=(0,M.useCallback)(u()(l()().mark((function e(){var t,n,a,c,s,o,i,u,f;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J&&$&&G){e.next=2;break}return e.abrupt("return",r.error(ke));case 2:if(ce.length){e.next=4;break}return e.abrupt("return",r.error(Me));case 4:if(e.prev=4,t=J,n=[],ce.forEach((function(e){var r=I[e].publicKey;I[e].created||n.push(R.SystemProgram.transfer({fromPubkey:t,toPubkey:new R.PublicKey(r),lamports:890880}))})),n.length){e.next=10;break}return e.abrupt("return",r.info(Se));case 10:return e.next=12,Q.getLatestBlockhash();case 12:return a=e.sent,c=a.blockhash,s=a.lastValidBlockHeight,e.next=17,(0,V.fC)(Q,G,c,n,$,F);case 17:return o=e.sent,i=o.transaction,u=o.feeMode,e.next=22,(0,V.pR)(Q,G,i,u);case 22:return f=e.sent,e.next=25,(0,V.fS)(E,Q,{signature:f,blockhash:c,lastValidBlockHeight:s},"confirmed",d,r);case 25:e.sent&&tt(z),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(4),(0,m.Tv)(e.t0,r,"handleCreateAccount");case 32:case"end":return e.stop()}}),e,null,[[4,29]])}))),[ce,J,$,I,Q,E,z,G,F]),ct=(0,M.useCallback)(function(){var t=u()(l()().mark((function t(n){var a,c,o,i,u;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=[],t.next=4,A.db.wallets.where("chain").equals(n.network).toArray();case 4:c=t.sent,o=s()(c);try{for(o.s();!(i=o.n()).done;)u=i.value,a.push({label:u.name,value:u.hash})}catch(e){o.e(e)}finally{o.f()}a.sort((function(e,t){return e.label.localeCompare(t.label)})),e(j.Nw.setWallets(c)),e(j.Nw.setWalletOptions(a)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),(0,m.Tv)(t.t0,r,"handleUpdateWallets");case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}(),[]),st=(0,M.useCallback)(u()(l()().mark((function t(){var n,c;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(z){t.next=2;break}return t.abrupt("return",r.error(we));case 2:return t.prev=2,t.next=5,A.db.wallets.get(z);case 5:if(!(n=t.sent)||!n.count){t.next=8;break}return t.abrupt("return",r.error(_e));case 8:return t.next=10,A.db.wallets.delete(z);case 10:delete(c=a()({},_))[z],e(j.Nw.setLocks(c)),e(j.Nw.setWallet("")),ct(E),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),(0,m.Tv)(t.t0,r,"handleDeleteWallet");case 20:case"end":return t.stop()}}),t,null,[[2,17]])}))),[z,E,_]),ot=(0,M.useCallback)((function(t){se([]),e(j.Nw.setWallet(t))}),[]),lt=(0,M.useCallback)(function(){var e=u()(l()().mark((function e(t,n){var a,c;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n.hash,c=n.wallet,e.next=4,A.db.accounts.update(a,{notes:t});case 4:tt(c),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,m.Tv)(e.t0,r,"handleNotes");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),[]),it=(0,M.useCallback)(u()(l()().mark((function e(){var t,n,a,c,s;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.db.wallets.toArray();case 3:return t=e.sent,e.next=6,A.db.accounts.toArray();case 6:n=e.sent,a={wallets:t,accounts:n},c="data:,".concat(JSON.stringify(a,null,2)),(s=document.createElement("a")).href=c,s.download="wallets_".concat(B()().format("YYYY-MM-DD_HH-mm"),".json"),s.click(),r.success(ge),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),(0,m.Tv)(e.t0,r,"handleBackup");case 19:case"end":return e.stop()}}),e,null,[[0,16]])}))),[]),ut=(0,M.useCallback)(function(){var t=u()(l()().mark((function t(n){var a;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=new FileReader).readAsText(n.fileList[0].originFileObj),a.onload=u()(l()().mark((function t(){var n,c,s,o;return l()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=a.result,!(c=JSON.parse(n))){t.next=23;break}if(!c.wallets.length){t.next=11;break}return t.next=7,A.db.wallets.toArray();case 7:return s=t.sent,c.wallets.forEach((function(e){var t=s.find((function(t){return t.hash===e.hash}));t?t.count<e.count&&(t.count=e.count):s.push(e)})),t.next=11,A.db.wallets.bulkPut(s);case 11:if(!c.accounts.length){t.next=18;break}return t.next=14,A.db.accounts.toArray();case 14:return o=t.sent,c.accounts.forEach((function(e){o.find((function(t){return t.hash===e.hash}))||o.push(e)})),t.next=18,A.db.accounts.bulkPut(o);case 18:ct(E),e(j.Nw.setWallet("")),r.success(ve),t.next=24;break;case 23:r.error(ye);case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(0),(0,m.Tv)(t.t0,r,"handleRestore");case 29:case"end":return t.stop()}}),t,null,[[0,26]])})));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[z]),dt=(0,M.useCallback)((function(){if(z)return ce.length?void(_[z]?oe.current.handleOpen(ce):fe.current.handleOpen(z)):r.error(Me);r.error(we)}),[z,ce,_]),ft=(0,M.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",render:function(e,t,n){return(0,H.jsx)("span",{children:n+1})}},{title:"".concat(Pe),dataIndex:"publicKey",key:"publicKey",render:function(e,t){return(0,H.jsx)(O.VU,{content:t.publicKey,ellipsis:!0,chain:E,copyable:{tooltips:!1,text:t.publicKey}})}},{title:"".concat(Ne),dataIndex:"lamports",key:"lamports",render:function(e,t){return(0,H.jsx)("span",{children:t.lamports.dividedBy(R.LAMPORTS_PER_SOL).toString()+" SOL"})}},{title:"".concat(Ze),dataIndex:"created",key:"created",render:function(e,t){return(0,H.jsx)("span",{children:t.created?Re:Oe})}},{title:"Nonce".concat(Ke),dataIndex:"nonceCreated",key:"nonceCreated",render:function(e,t){return(0,H.jsx)("span",{children:t.nonceCreated?(0,H.jsx)(O.VU,{content:t.nonce,ellipsis:!0,chain:E,copyable:{tooltips:!1,text:t.nonce}}):Oe})}},{title:"".concat(We),dataIndex:"notes",key:"notes",render:function(e,t){return(0,H.jsx)(v.Z.Paragraph,{editable:{onChange:function(e){return lt(e,t)}},children:t.notes})}},{title:"".concat($e),dataIndex:"key",key:"key",render:function(e,t){return(0,H.jsx)(y.ZP,{size:"small",onClick:function(){return Xe(t)},children:Je})}}]}),[E,Xe]),pt=(0,M.useCallback)((function(t,n){var r=a()({},t);delete r[n],e(j.Nw.setLocks(r))}),[]),mt=(0,M.useCallback)((function(){return z?_[z]?(0,H.jsx)(D.Z,{className:" text-xl text-green-500 cursor-pointer",onClick:function(){return pt(_,z)}}):(0,H.jsx)(T.Z,{className:" text-xl text-yellow-500 cursor-pointer",onClick:function(){return fe.current.handleOpen(z)}}):null}),[z,_]);return(0,M.useEffect)((function(){ct(E)}),[E]),(0,M.useEffect)((function(){tt(z)}),[z]),(0,H.jsxs)(h._z,{className:"wallet",ghost:!0,children:[(0,H.jsx)(x.Z,{className:"",title:(0,H.jsx)("div",{className:"text-red-600",children:xe}),children:(0,H.jsxs)("div",{className:"grid gap-2",children:[(0,H.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,H.jsx)(y.ZP,{type:"primary",onClick:function(){return le.current.handleOpen()},children:Be}),(0,H.jsx)(y.ZP,{type:"primary",onClick:Ge,children:Te}),(0,H.jsx)(y.ZP,{type:"primary",onClick:at,children:He}),(0,H.jsx)(y.ZP,{type:"primary",onClick:it,children:Le}),(0,H.jsx)(y.ZP,{type:"primary",onClick:function(){return ie.current.handleOpen()},children:De}),(0,H.jsx)(y.ZP,{type:"primary",onClick:et,children:ze}),(0,H.jsx)(y.ZP,{type:"primary",onClick:Qe,children:qe})]}),(0,H.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,H.jsx)(y.ZP,{type:"primary",onClick:st,children:Ye}),(0,H.jsx)(y.ZP,{type:"primary",onClick:nt,children:Ve}),(0,H.jsx)(y.ZP,{type:"primary",onClick:rt,children:Ie}),(0,H.jsx)(w.Z,{accept:".json",maxCount:1,showUploadList:!1,onChange:ut,beforeUpload:function(){return!1},children:(0,H.jsx)(y.ZP,{type:"primary",children:Ue})},"restore")]}),(0,H.jsx)("div",{className:"flex gap-2 flex-wrap",children:(0,H.jsx)(y.ZP,{type:"primary",onClick:dt,children:Ee})}),(0,H.jsxs)("div",{className:"my-2",children:[z?"".concat(Fe,"-").concat(z.slice(0,3),"："):"".concat(Fe,"："),(0,H.jsx)(C.Z,{style:{width:"200px",height:"32px",marginRight:"8px"},showSearch:!0,placeholder:we,optionFilterProp:"label",onChange:ot,value:z,options:L}),mt()]})]})}),(0,H.jsx)(k.Z,{scroll:{x:!0},size:"small",columns:ft,dataSource:I,defaultData:[],loading:{spinning:te,size:"large"},search:!1,options:!1,pagination:!1,tableAlertRender:!1,tableAlertOptionRender:!1,rowSelection:{type:"checkbox",selectedRowKeys:ce,onChange:function(e){se(e)}}}),(0,H.jsx)(p.LV,{ref:le,messageApi:r,handleUpdateWallets:ct}),(0,H.jsx)(p.Tc,{ref:oe,messageApi:r,handleUpdateAccounts:tt,notificationApi:d}),(0,H.jsx)(p.rf,{ref:ie,messageApi:r,handleUpdateWallets:ct}),(0,H.jsx)(p.vA,{ref:ue,messageApi:r,handleUpdateAccounts:tt}),(0,H.jsx)(p.fd,{ref:de,messageApi:r,handleUpdateWallets:ct}),(0,H.jsx)(p.S8,{ref:fe,messageApi:r}),(0,H.jsx)(p.Ny,{ref:pe,messageApi:r}),(0,H.jsx)(p.g$,{ref:me,messageApi:r}),c,W]})}}}]);