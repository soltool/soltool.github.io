"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5856],{53012:function(e,t,r){r.r(t);var n=r(64599),s=r.n(n),a=r(15009),c=r.n(a),u=r(99289),l=r.n(u),o=r(5574),i=r.n(o),p=r(40956),d=r(64119),f=r(39380),m=r(38345),x=r(74273),j=r(88026),N=r(2453),b=r(7134),h=r(34041),v=r(74330),y=r(83622),k=r(38703),P=r(71230),S=r(15746),g=r(27484),C=r.n(g),w=r(70178),R=r.n(w),L=r(67294),Z=(r(8849),r(28704)),V=r(39678),U=r(25104),D=r(54306),T=r(85893);C().extend(R());t.default=function(){var e=(0,j.useDispatch)(),t=N.ZP.useMessage(),r=i()(t,2),n=r[0],a=r[1],u=(0,L.useState)(!0),o=i()(u,2),g=o[0],w=o[1],R=(0,D.O)().publicKey,I=(0,j.useSelector)((function(e){return e.ppp.projectsDataSourceV1})),B=(0,j.useSelector)((function(e){return e.ppp.projectsOptionV1})),O=(0,j.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV1})),z=(0,L.useState)({burnNumber:0,buyNumber:0,sellNumber:0,splitNumber:0,nftNumber:0}),F=i()(z,2),M=F[0],E=F[1],A=(0,L.useState)([]),H=i()(A,2),K=H[0],W=H[1],Y=(0,L.useState)({projectPubkey:"",bump:0,creatorPubkey:"",mintPubkey:"",authorityPubkey:"",projectName:"",projectDesc:"",tokenSymbol:"",tokenUri:"",initTokenSupply:0,maxTokenSupply:0,initNftSupply:0,maxNftSupply:0,tokenPerNft:0,initNftPrice:0,increasePerRound:0,tradeFeeRate:0,secPerRound:0,secToBurnNft:0,nftId:0,aid:0,nftIssueCount:0,nftBurnCount:0,round:0,lastRound:0,createTime:"",unixTs:0,imageUrl:"",nftName:"",nftImageUrl:"",bgmUrl:"",website:"",twitter:"",telegram:"",discord:"",marketCap:0,fdv:0,circulationSupply:0,updatedAt:"",projectMint:"",volume24h:0,tx24h:0,key:0,nftSupply:0,splitNftPrice:0,profitRate:0,profitRateYear:0,profitRateMonth:0,profitRateDay:0,nextRoundLocalValue:0,nextRoundLocalFormat:"",lastRoundLocalFormat:"",lastRoundLocalValue:0,createTimeLocalFormat:"",createTimeLocalValue:0}),_=i()(Y,2),q=_[0],G=_[1],J=(0,L.useState)(0),Q=i()(J,2),X=Q[0],$=Q[1],ee=(0,L.useRef)(0),te=(0,L.useCallback)(function(){var t=l()(c()().mark((function t(r){var s;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{s=[],r.forEach((function(e){var t=e.nftImageUrl,r=e.tokenSymbol,n=e.projectName,a=e.mintPubkey;s.push({value:a,label:(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsxs)("div",{className:"flex items-center",children:[(0,T.jsx)(b.C,{className:"mr-2",size:"default",src:t}),(0,T.jsx)("div",{children:"".concat(r," - ").concat(n)})]}),(0,T.jsx)(V.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]}),nftImageUrl:t,projectName:n,tokenSymbol:r,mintPubkey:a})})),e(p.N.setProjectsOptionV1(s))}catch(e){(0,d.Tv)(e,n,"handleProjectsOption")}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),re=(0,L.useCallback)((function(e){if(e<0)ee.current=100,$(100);else{var t=1e3*q.secPerRound,r=(t-e)/t*100,n=Math.ceil(r);n!==ee.current&&(ee.current=n,$(r))}}),[q]),ne=(0,L.useCallback)((function(e,t){var r,n=0,a=0,c=0,u=0,l=t.length,o=e.secToBurnNft,i=e.secPerRound,p=e.splitNftPrice,d=e.lastRoundLocalValue,f=[],m=[],x=s()(t);try{for(x.s();!(r=x.n()).done;){var j=r.value,N=C()().valueOf(),b=j.lastTradeLocalValue,h=1e3*o,v=1e3*i;j.price>=p&&(u+=1,f.push(j)),N-b>h&&(n+=1,m.push(j)),d>b||N-d>v?a+=1:c+=1}}catch(e){x.e(e)}finally{x.f()}return E({burnNumber:n,buyNumber:a,sellNumber:c,splitNumber:u,nftNumber:l}),{currentProjectUserSplitNftsDataSource:f,currentProjectUserBurnNftsSplitDataSource:m}}),[]),se=(0,L.useCallback)(function(){var t=l()(c()().mark((function t(r,s){var a,u,l,o,i,f;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s&&r){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e(p.N.setCurrentProjectNftsLoadingV1(!0)),a=I.find((function(e){return e.mintPubkey===r})),t.next=7,(0,Z.LE)(r,a);case 7:u=t.sent,l=u.currentProjectNftsDataSource,o=l.filter((function(e){return e.ownerPubkey===s})),i=ne(a,o),f=i.currentProjectUserBurnNftsSplitDataSource,W(f),G(a),e(p.N.setCurrentProjectNftsLoadingV1(!1)),ee.current=0,$(0),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(2),e(p.N.setCurrentProjectNftsLoadingV1(!1)),(0,d.Tv)(t.t0,n,"handleCurrentProjectUserNfts");case 22:case"end":return t.stop()}}),t,null,[[2,18]])})));return function(e,r){return t.apply(this,arguments)}}(),[I]),ae=(0,L.useCallback)(l()(c()().mark((function t(){var r,s,a;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,(0,Z.p5)();case 4:return r=t.sent,s=r.projects,a=r.projectsDataSource,t.next=9,te(a);case 9:e(p.N.setProjectsV1(s)),e(p.N.setProjectsDataSourceV1(a)),w(!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),w(!1),(0,d.Tv)(t.t0,n,"handleProjects");case 18:case"end":return t.stop()}}),t,null,[[0,14]])}))),[]);return(0,L.useEffect)((function(){ae()}),[]),(0,T.jsxs)(f._z,{className:"projects",ghost:!0,children:[(0,T.jsx)(h.Z,{loading:g,size:"large",style:{width:"100%"},className:"mb-3",defaultValue:null!=q&&q.mintPubkey?q.mintPubkey:void 0,onChange:function(e){se(e,null==R?void 0:R.toString())},placeholder:"请选择项目",showSearch:!0,filterOption:function(e,t){return(t.projectName+t.tokenSymbol).toLowerCase().includes(e.toLowerCase())},options:B,optionRender:function(e){var t=e.data,r=t.projectName,n=t.tokenSymbol,s=t.nftImageUrl,a=t.mintPubkey;return(0,T.jsxs)("div",{className:"flex items-center justify-between",children:[(0,T.jsxs)("div",{className:"flex items-center",children:[(0,T.jsx)(b.C,{className:"mr-2",size:"default",src:s}),(0,T.jsx)("div",{children:"".concat(n," - ").concat(r)})]}),(0,T.jsx)(V.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]})}}),(0,T.jsxs)(v.Z,{size:"large",spinning:O,children:[(0,T.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,T.jsx)("div",{children:"下一轮倒计时："}),(0,T.jsx)(U.Wo,{className:"mr-2 font-medium text-base",value:q?q.nextRoundLocalValue:0,onChange:re}),(0,T.jsx)("div",{className:" text-base",children:q?q.nextRoundLocalFormat:""}),(0,T.jsx)("div",{className:"ml-auto",children:(0,T.jsx)(y.ZP,{type:"primary",onClick:function(){return se(q.mintPubkey,null==R?void 0:R.toString())},children:"更新"})})]}),(0,T.jsx)(k.Z,{percent:X,showInfo:!1}),(0,T.jsx)(m.Z,{headerBordered:!0,headStyle:{justifyContent:"center"},className:"mb-3",children:(0,T.jsxs)(P.Z,{gutter:10,children:[(0,T.jsx)(S.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,T.jsx)(x.Z,{layout:"center",statistic:{title:(0,T.jsx)("div",{className:"text-center",children:"持有量"}),value:M.nftNumber}})}),(0,T.jsx)(S.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,T.jsx)(x.Z,{layout:"center",statistic:{title:(0,T.jsx)("div",{className:"text-center",children:"可买 / 已售"}),value:"".concat(M.buyNumber," / ").concat(M.sellNumber)}})}),(0,T.jsx)(S.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,T.jsx)(x.Z,{layout:"center",statistic:{title:(0,T.jsx)("div",{className:"text-center",children:"可拆分"}),value:M.splitNumber}})}),(0,T.jsx)(S.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,T.jsx)(x.Z,{layout:"center",statistic:{title:(0,T.jsx)("div",{className:"text-center",children:"可销毁"}),value:M.burnNumber}})})]})})]}),(0,T.jsx)(m.Z,{children:(0,T.jsx)(U.ZH,{handleCurrentProjectUserNfts:se,currentProjectUserNftsDataSource:K,currentProjectDataSource:q,kind:"burn"})}),a]})}},8849:function(){}}]);