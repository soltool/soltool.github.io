"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3272],{20183:function(e,t,r){r.r(t);var n=r(64599),s=r.n(n),a=r(15009),c=r.n(a),u=r(99289),o=r.n(u),l=r(5574),i=r.n(l),p=r(40956),d=r(64119),f=r(39380),m=r(38345),x=r(74273),j=r(88026),N=r(2453),h=r(7134),b=r(34041),v=r(74330),y=r(83622),k=r(38703),P=r(71230),S=r(15746),g=r(27484),C=r.n(g),R=r(70178),w=r.n(R),L=r(67294),V=(r(8849),r(28704)),Z=r(39678),D=r(25104),T=r(54306),U=r(85893);C().extend(w());t.default=function(){var e=(0,j.useDispatch)(),t=N.ZP.useMessage(),r=i()(t,2),n=r[0],a=r[1],u=(0,L.useState)(!0),l=i()(u,2),g=l[0],R=l[1],w=(0,T.O)().publicKey,I=(0,j.useSelector)((function(e){return e.ppp.projectsDataSourceV2})),O=(0,j.useSelector)((function(e){return e.ppp.projectsOptionV2})),z=(0,j.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV2})),B=(0,L.useState)({burnNumber:0,buyNumber:0,sellNumber:0,splitNumber:0,nftNumber:0}),F=i()(B,2),M=F[0],E=F[1],A=(0,L.useState)([]),K=i()(A,2),W=K[0],Y=K[1],_=(0,L.useState)({projectPubkey:"",bump:0,creatorPubkey:"",mintPubkey:"",authorityPubkey:"",projectName:"",projectDesc:"",tokenSymbol:"",tokenUri:"",initTokenSupply:0,maxTokenSupply:0,initNftSupply:0,maxNftSupply:0,tokenPerNft:0,initNftPrice:0,increasePerRound:0,tradeFeeRate:0,secPerRound:0,secToBurnNft:0,nftId:0,aid:0,nftIssueCount:0,nftBurnCount:0,round:0,poolTokenPct:0,nftTokenPct:0,lastRound:0,createTime:"",unixTs:0,imageUrl:"",nftName:"",nftImageUrl:"",bgmUrl:"",website:"",twitter:"",telegram:"",discord:"",marketCap:0,fdv:0,circulationSupply:0,updatedAt:"",projectMint:"",volume24h:0,tx24h:0,key:0,nftSupply:0,splitNftPrice:0,profitRateCreator:0,profitRateInviter:0,profitRatePlatform:0,profitRate:0,profitRateYear:0,profitRateMonth:0,profitRateDay:0,nextRoundLocalValue:0,nextRoundLocalFormat:"",lastRoundLocalFormat:"",lastRoundLocalValue:0,createTimeLocalFormat:"",createTimeLocalValue:0}),q=i()(_,2),G=q[0],H=q[1],J=(0,L.useState)(0),Q=i()(J,2),X=Q[0],$=Q[1],ee=(0,L.useRef)(0),te=(0,L.useCallback)(function(){var t=o()(c()().mark((function t(r){var s;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{s=[],r.forEach((function(e){var t=e.nftImageUrl,r=e.tokenSymbol,n=e.projectName,a=e.mintPubkey;s.push({value:a,label:(0,U.jsxs)("div",{className:"flex items-center justify-between",children:[(0,U.jsxs)("div",{className:"flex items-center",children:[(0,U.jsx)(h.C,{className:"mr-2",size:"default",src:t}),(0,U.jsx)("div",{children:"".concat(r," - ").concat(n)})]}),(0,U.jsx)(Z.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]}),nftImageUrl:t,projectName:n,tokenSymbol:r,mintPubkey:a})})),e(p.N.setProjectsOptionV2(s))}catch(e){(0,d.Tv)(e,n,"handleProjectsOption")}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),re=(0,L.useCallback)((function(e){if(e<0)ee.current=100,$(100);else{var t=1e3*G.secPerRound,r=(t-e)/t*100,n=Math.ceil(r);n!==ee.current&&(ee.current=n,$(r))}}),[G]),ne=(0,L.useCallback)((function(e,t){var r,n=0,a=0,c=0,u=0,o=t.length,l=e.secToBurnNft,i=e.secPerRound,p=e.splitNftPrice,d=e.lastRoundLocalValue,f=[],m=[],x=s()(t);try{for(x.s();!(r=x.n()).done;){var j=r.value,N=C()().valueOf(),h=j.lastTradeLocalValue,b=1e3*l,v=1e3*i;j.price>=p&&(u+=1,f.push(j)),N-h>b&&(n+=1,m.push(j)),d>h||N-d>v?a+=1:c+=1}}catch(e){x.e(e)}finally{x.f()}return E({burnNumber:n,buyNumber:a,sellNumber:c,splitNumber:u,nftNumber:o}),{currentProjectUserSplitNftsDataSource:f,currentProjectUserBurnNftsSplitDataSource:m}}),[]),se=(0,L.useCallback)(function(){var t=o()(c()().mark((function t(r,s){var a,u,o,l,i,f;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s&&r){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e(p.N.setCurrentProjectNftsLoadingV2(!0)),a=I.find((function(e){return e.mintPubkey===r})),t.next=7,(0,V.D3)(r,a);case 7:u=t.sent,o=u.currentProjectNftsDataSource,l=o.filter((function(e){return e.ownerPubkey===s})),i=ne(a,l),f=i.currentProjectUserSplitNftsDataSource,Y(f),H(a),e(p.N.setCurrentProjectNftsLoadingV2(!1)),ee.current=0,$(0),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(2),e(p.N.setCurrentProjectNftsLoadingV2(!1)),(0,d.Tv)(t.t0,n,"handleCurrentProjectUserNfts");case 22:case"end":return t.stop()}}),t,null,[[2,18]])})));return function(e,r){return t.apply(this,arguments)}}(),[I]),ae=(0,L.useCallback)(o()(c()().mark((function t(){var r,s,a;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,R(!0),t.next=4,(0,V.yC)();case 4:return r=t.sent,s=r.projects,a=r.projectsDataSource,t.next=9,te(a);case 9:e(p.N.setProjectsV2(s)),e(p.N.setProjectsDataSourceV2(a)),R(!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),R(!1),(0,d.Tv)(t.t0,n,"handleProjects");case 18:case"end":return t.stop()}}),t,null,[[0,14]])}))),[]);return(0,L.useEffect)((function(){ae()}),[]),(0,U.jsxs)(f._z,{className:"projects",ghost:!0,children:[(0,U.jsx)(b.Z,{loading:g,size:"large",style:{width:"100%"},className:"mb-3",defaultValue:null!=G&&G.mintPubkey?G.mintPubkey:void 0,onChange:function(e){se(e,null==w?void 0:w.toString())},placeholder:"请选择项目",showSearch:!0,filterOption:function(e,t){return(t.projectName+t.tokenSymbol).toLowerCase().includes(e.toLowerCase())},options:O,optionRender:function(e){var t=e.data,r=t.projectName,n=t.tokenSymbol,s=t.nftImageUrl,a=t.mintPubkey;return(0,U.jsxs)("div",{className:"flex items-center justify-between",children:[(0,U.jsxs)("div",{className:"flex items-center",children:[(0,U.jsx)(h.C,{className:"mr-2",size:"default",src:s}),(0,U.jsx)("div",{children:"".concat(n," - ").concat(r)})]}),(0,U.jsx)(Z.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]})}}),(0,U.jsxs)(v.Z,{size:"large",spinning:z,children:[(0,U.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,U.jsx)("div",{children:"下一轮倒计时："}),(0,U.jsx)(D.Wo,{className:"mr-2 font-medium text-base",value:G?G.nextRoundLocalValue:0,onChange:re}),(0,U.jsx)("div",{className:" text-base",children:G?G.nextRoundLocalFormat:""}),(0,U.jsx)("div",{className:"ml-auto",children:(0,U.jsx)(y.ZP,{type:"primary",onClick:function(){return se(G.mintPubkey,null==w?void 0:w.toString())},children:"更新"})})]}),(0,U.jsx)(k.Z,{percent:X,showInfo:!1}),(0,U.jsx)(m.Z,{headerBordered:!0,headStyle:{justifyContent:"center"},className:"mb-3",children:(0,U.jsxs)(P.Z,{gutter:10,children:[(0,U.jsx)(S.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,U.jsx)(x.Z,{layout:"center",statistic:{title:(0,U.jsx)("div",{className:"text-center",children:"持有量"}),value:M.nftNumber}})}),(0,U.jsx)(S.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,U.jsx)(x.Z,{layout:"center",statistic:{title:(0,U.jsx)("div",{className:"text-center",children:"可买 / 已售"}),value:"".concat(M.buyNumber," / ").concat(M.sellNumber)}})}),(0,U.jsx)(S.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,U.jsx)(x.Z,{layout:"center",statistic:{title:(0,U.jsx)("div",{className:"text-center",children:"可拆分"}),value:M.splitNumber}})}),(0,U.jsx)(S.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,U.jsx)(x.Z,{layout:"center",statistic:{title:(0,U.jsx)("div",{className:"text-center",children:"可销毁"}),value:M.burnNumber}})})]})})]}),(0,U.jsx)(m.Z,{children:(0,U.jsx)(D.Dm,{handleCurrentProjectUserNfts:se,currentProjectUserNftsDataSource:W,currentProjectDataSource:G,kind:"split"})}),a]})}},8849:function(){}}]);