"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2195],{27603:function(e,t,n){n.r(t);var r=n(64599),s=n.n(r),a=n(15009),c=n.n(a),u=n(99289),o=n.n(u),i=n(5574),l=n.n(i),f=n(40956),p=n(64119),d=n(39380),m=n(38345),j=n(74273),x=n(88026),N=n(2453),h=n(7134),b=n(34041),v=n(74330),P=n(38703),k=n(71230),y=n(15746),C=n(27484),S=n.n(C),w=n(70178),V=n.n(w),g=n(67294),Z=(n(8849),n(28704)),R=n(39678),D=n(25104),O=n(44718),L=n(29363),T=n(71874),E=n(85893);S().extend(V());t.default=function(){var e=(0,x.useDispatch)(),t=N.ZP.useMessage(),n=l()(t,2),r=n[0],a=n[1],u=(0,g.useState)(!0),i=l()(u,2),C=i[0],w=i[1],V=(0,O.R)().connection,z=(0,x.useSelector)((function(e){return e.ppp.projectsDataSourceV1})),I=(0,x.useSelector)((function(e){return e.ppp.currentProjectNftsStatusV1})),F=(0,x.useSelector)((function(e){return e.ppp.currentProjectDataSourceV1})),U=(0,x.useSelector)((function(e){return e.ppp.projectsOptionV1})),B=(0,x.useSelector)((function(e){return e.ppp.currentProjectNftsLoadingV1})),K=(0,g.useState)(0),M=l()(K,2),_=M[0],A=M[1],H=(0,g.useRef)(0),W=(0,g.useCallback)(function(){var t=o()(c()().mark((function t(n){var s;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{s=[],n.forEach((function(e){var t=e.nftImageUrl,n=e.tokenSymbol,r=e.projectName,a=e.mintPubkey;s.push({value:a,label:(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)(h.C,{className:"mr-2",size:"default",src:t}),(0,E.jsx)("div",{children:"".concat(n," - ").concat(r)})]}),(0,E.jsx)(R.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]}),nftImageUrl:t,projectName:r,tokenSymbol:n,mintPubkey:a})})),e(f.N.setProjectsOptionV1(s))}catch(e){(0,p.Tv)(e,r,"handleProjectsOption")}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),q=(0,g.useCallback)((function(e){if(e<0)H.current=100,A(100);else{var t=1e3*F.secPerRound,n=(t-e)/t*100,r=Math.ceil(n);r!==H.current&&(H.current=r,A(n))}}),[F]),G=(0,g.useCallback)((function(t,n){var r,a=0,c=0,u=0,o=0,i=n.nftSupply,l=n.secToBurnNft,p=n.secPerRound,d=n.splitNftPrice,m=n.lastRoundLocalValue,j=s()(t);try{for(j.s();!(r=j.n()).done;){var x=r.value,N=S()().valueOf(),h=S().unix(x.last_trade).utcOffset(8).valueOf(),b=1e3*l,v=1e3*p;x.price>=d&&(o+=1),N-h>b&&(a+=1),m>h||N-m>v?c+=1:u+=1}}catch(e){j.e(e)}finally{j.f()}e(f.N.setCurrentProjectNftsStatusV1({burnNumber:a,buyNumber:c,sellNumber:u,splitNumber:o,nftNumber:i}))}),[]),J=(0,g.useCallback)(function(){var t=o()(c()().mark((function t(n,s){var a,u,o,i,l,d;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={},s.forEach((function(e){var t=e.ownerPubkey,n=e.profit,r=e.invest;a.hasOwnProperty(t)||(a[t]={number:0,invest:0,profit:0}),a[t].profit+=n,a[t].number+=1,a[t].invest+=r})),u=[],o=0,i=Object.keys(a).map((function(e){return new L.PublicKey(e)})),t.next=8,(0,T.ep)(n,i);case 8:l=t.sent,Object.keys(a).forEach((function(e,t){var n=a[e].number,r=a[e].invest,s=a[e].profit,c=l[t]?l[t].lamports:0;o+=n,u.push({key:t,owner:e,number:n,percent:0,invest:r,profit:s,balance:c})})),u.forEach((function(e){e.percent=e.number/o*100})),d=u.sort((function(e,t){return t.number-e.number})),e(f.N.setCurrentProjectNftsRankDataSourceV1(d)),e(f.N.setCurrentProjectNftsRankDataSourceResetV1(d)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),(0,p.Tv)(t.t0,r,"handleCurrentProjectNftsRank");case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,n){return t.apply(this,arguments)}}(),[]),Q=(0,g.useCallback)(function(){var t=o()(c()().mark((function t(n){var s,a,u,o;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(f.N.setCurrentProjectNftsLoadingV1(!0)),s=z.find((function(e){return e.mintPubkey===n})),t.next=5,(0,Z.LE)(n,s);case 5:a=t.sent,u=a.currentProjectNftsDataSource,o=a.currentProjectNfts,G(o,s),J(V,u),e(f.N.setCurrentProjectNftsV1(o)),e(f.N.setCurrentProjectNftsDataSourceV1(u)),e(f.N.setCurrentProjectNftsDataSourceResetV1(u)),e(f.N.setCurrentProjectDataSourceV1(s)),e(f.N.setCurrentProjectNftsLoadingV1(!1)),H.current=0,A(0),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(0),e(f.N.setCurrentProjectNftsLoadingV1(!1)),(0,p.Tv)(t.t0,r,"handleCurrentProjectNfts");case 23:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(e){return t.apply(this,arguments)}}(),[z,V]),X=(0,g.useCallback)(o()(c()().mark((function t(){var n,s,a;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,w(!0),t.next=4,(0,Z.p5)();case 4:return n=t.sent,s=n.projects,a=n.projectsDataSource,t.next=9,W(a);case 9:e(f.N.setProjectsV1(s)),e(f.N.setProjectsDataSourceV1(a)),w(!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),w(!1),(0,p.Tv)(t.t0,r,"handleProjects");case 18:case"end":return t.stop()}}),t,null,[[0,14]])}))),[]);return(0,g.useEffect)((function(){X()}),[]),(0,E.jsxs)(d._z,{className:"projects",ghost:!0,children:[(0,E.jsx)(b.Z,{loading:C,size:"large",style:{width:"100%"},className:"mb-3",defaultValue:F.mintPubkey?F.mintPubkey:void 0,onChange:function(e){Q(e)},placeholder:"请选择项目",showSearch:!0,filterOption:function(e,t){return(t.projectName+t.tokenSymbol).toLowerCase().includes(e.toLowerCase())},options:U,optionRender:function(e){var t=e.data,n=t.projectName,r=t.tokenSymbol,s=t.nftImageUrl,a=t.mintPubkey;return(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center",children:[(0,E.jsx)(h.C,{className:"mr-2",size:"default",src:s}),(0,E.jsx)("div",{children:"".concat(r," - ").concat(n)})]}),(0,E.jsx)(R.k,{addressPrefix:"",ellipsis:!0,tooltip:!1,address:a})]})}}),(0,E.jsxs)(v.Z,{size:"large",spinning:B,children:[(0,E.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,E.jsx)("div",{children:"下一轮倒计时："}),(0,E.jsx)(D.Wo,{className:"mr-2 font-medium text-base",value:F.nextRoundLocalValue,onChange:q}),(0,E.jsx)("div",{className:" text-base",children:F.nextRoundLocalFormat})]}),(0,E.jsx)(P.Z,{percent:_,showInfo:!1}),(0,E.jsx)(m.Z,{headerBordered:!0,headStyle:{justifyContent:"center"},className:"mb-3",children:(0,E.jsxs)(k.Z,{gutter:10,children:[(0,E.jsx)(y.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"总量"}),value:I.nftNumber}})}),(0,E.jsx)(y.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可买 / 已售"}),value:"".concat(I.buyNumber," / ").concat(I.sellNumber)}})}),(0,E.jsx)(y.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可拆分"}),value:I.splitNumber}})}),(0,E.jsx)(y.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,E.jsx)(j.Z,{layout:"center",statistic:{title:(0,E.jsx)("div",{className:"text-center",children:"可销毁"}),value:I.burnNumber}})})]})})]}),(0,E.jsx)(m.Z,{tabs:{items:[{key:"nft",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"NFT市场"}),children:(0,E.jsx)(D.PO,{handleCurrentProjectNfts:Q})},{key:"rank",label:(0,E.jsx)("span",{className:" text-base font-semibold",children:"NFT排名"}),children:(0,E.jsx)(D.Hp,{handleCurrentProjectNfts:Q})}],defaultActiveKey:"nft"}}),a]})}},8849:function(){}}]);